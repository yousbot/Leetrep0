<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-2394.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-2394.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>2394 - Employees With Deductions</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 2394. Employees With Deductions Description Table: Employees +--------------+------+ | Column Name | Type | +--------------+------+ | employee_id | int | | needed_hours | int | +--------------+------+ employee_id is column with unique values for this table. Each row contains the id of an employee and the...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-2394.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-2394.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-2394.html" rel="stylesheet"/>
   <link href="solution-2394.html" rel="stylesheet"/>
   <link href="solution-2394.html" rel="stylesheet"/>
   <link href="solution-2394.html" rel="stylesheet"/>
   <link href="solution-2394.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="2394 - Employees With Deductions" property="og:title"/>
   <meta content="Leetcode 2394. Employees With Deductions Description Table: Employees +--------------+------+ | Column Name | Type | +--------------+------+ | employee_id | int | | needed_hours | int | +--------------+------+ employee_id is column with unique values for this table. Each row contains the id of an employee and the minimum number of hours needed for them to work to get their salary. &amp;nbsp; Table: Logs +-------------+----------+ | Column Name | Type | +-------------+----------+ | employee_id | int | | in_time | datetime | | out_time | datetime | +-------------+----------+ (employee_id, in_time, out_time) is the primary key (combination of columns with unique values) for this table. Each row of this table shows the time stamps for an employee. in_time is the time the employee started to work, and out_time is the time the employee ended work. All the times are in October 2022. out_time can be one day after in_time which means the employee worked after the midnight. &amp;nbsp; In a company, each employee must work a certain number of hours every month. Employees work in sessions. The number of hours an employee worked can be calculated from the sum of the number of minutes the employee worked in all of their sessions. The number of minutes in each session is rounded up. For example, if the employee worked for 51 minutes and 2 seconds in a session, we consider it 52 minutes. Write a solution to report the IDs of the employees that will be deducted. In other words, report the IDs of the employees that did not work the needed hours. Return the result table in any order. The&amp;nbsp;result format is in the following example. &amp;nbsp; Example 1: Input: Employees table: +-------------+--------------+ | employee_id | needed_hours | +-------------+--------------+ | 1 | 20 | | 2 | 12 | | 3 | 2 | +-------------+--------------+ Logs table: +-------------+---------------------+---------------------+ | employee_id | in_time | out_time | +-------------+---------------------+---------------------+ | 1 | 2022-10-01 09:00:00 | 2022-10-01 17:00:00 | | 1 | 2022-10-06 09:05:04 | 2022-10-06 17:09:03 | | 1 | 2022-10-12 23:00:00 | 2022-10-13 03:00:01 | | 2 | 2022-10-29 12:00:00 | 2022-10-29 23:58:58 | +-------------+---------------------+---------------------+ Output: +-------------+ | employee_id | +-------------+ | 2 | | 3 | +-------------+ Explanation: Employee 1: - Worked for three sessions: - On 2022-10-01, they worked for 8 hours. - On 2022-10-06, they worked for 8 hours and 4 minutes. - On 2022-10-12, they worked for 4 hours and 1 minute. Note that they worked through midnight. - Employee 1 worked a total of 20 hours and 5 minutes across sessions and will not be deducted. Employee 2: - Worked for one session: - On 2022-10-29, they worked for 11 hours and 59 minutes. - Employee 2 did not work their hours and will be deducted. Employee 3: - Did not work any session. - Employee 3 did not work their hours and will be deducted. Solutions SQL # Write your MySQL query statement below WITH T AS ( SELECT employee_id, SUM(ceiling(TIMESTAMPDIFF(second, in_time, out_time) / 60))..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2022-06-20T00:00:00-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2022-06-20-2394-Employees-With-Deductions/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-2394.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="2394 - Employees With Deductions" property="twitter:title"/>
   <meta content="Leetcode 2394. Employees With Deductions Description Table: Employees +--------------+------+ | Column Name | Type | +--------------+------+ | employee_id | int | | needed_hours | int | +--------------+------+ employee_id is column with unique values for this table. Each row contains the id of an employee and the minimum number of hours needed for them to work to get their salary. &amp;nbsp; Table: Logs +-------------+----------+ | Column Name | Type | +-------------+----------+ | employee_id | int | | in_time | datetime | | out_time | datetime | +-------------+----------+ (employee_id, in_time, out_time) is the primary key (combination of columns with unique values) for this table. Each row of this table shows the time stamps for an employee. in_time is the time the employee started to work, and out_time is the time the employee ended work. All the times are in October 2022. out_time can be one day after in_time which means the employee worked after the midnight. &amp;nbsp; In a company, each employee must work a certain number of hours every month. Employees work in sessions. The number of hours an employee worked can be calculated from the sum of the number of minutes the employee worked in all of their sessions. The number of minutes in each session is rounded up. For example, if the employee worked for 51 minutes and 2 seconds in a session, we consider it 52 minutes. Write a solution to report the IDs of the employees that will be deducted. In other words, report the IDs of the employees that did not work the needed hours. Return the result table in any order. The&amp;nbsp;result format is in the following example. &amp;nbsp; Example 1: Input: Employees table: +-------------+--------------+ | employee_id | needed_hours | +-------------+--------------+ | 1 | 20 | | 2 | 12 | | 3 | 2 | +-------------+--------------+ Logs table: +-------------+---------------------+---------------------+ | employee_id | in_time | out_time | +-------------+---------------------+---------------------+ | 1 | 2022-10-01 09:00:00 | 2022-10-01 17:00:00 | | 1 | 2022-10-06 09:05:04 | 2022-10-06 17:09:03 | | 1 | 2022-10-12 23:00:00 | 2022-10-13 03:00:01 | | 2 | 2022-10-29 12:00:00 | 2022-10-29 23:58:58 | +-------------+---------------------+---------------------+ Output: +-------------+ | employee_id | +-------------+ | 2 | | 3 | +-------------+ Explanation: Employee 1: - Worked for three sessions: - On 2022-10-01, they worked for 8 hours. - On 2022-10-06, they worked for 8 hours and 4 minutes. - On 2022-10-12, they worked for 4 hours and 1 minute. Note that they worked through midnight. - Employee 1 worked a total of 20 hours and 5 minutes across sessions and will not be deducted. Employee 2: - Worked for one session: - On 2022-10-29, they worked for 11 hours and 59 minutes. - Employee 2 did not work their hours and will be deducted. Employee 3: - Did not work any session. - Employee 3 did not work their hours and will be deducted. Solutions SQL # Write your MySQL query statement below WITH T AS ( SELECT employee_id, SUM(ceiling(TIMESTAMPDIFF(second, in_time, out_time) / 60))..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    2394 - Employees With Deductions | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="2394 - Employees With Deductions" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-2394.html" rel="canonical">
          <meta content="https://leetcode.ca/2022-06-20-2394-Employees-With-Deductions/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2022-06-20T00:00:00-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"2394 - Employees With Deductions","dateModified":"2022-06-20T00:00:00-07:00","datePublished":"2022-06-20T00:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2022-06-20-2394-Employees-With-Deductions/"},"url":"https://leetcode.ca/2022-06-20-2394-Employees-With-Deductions/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="2394-employees-with-deductions">
       <a href="solution-2394.html">
        2394. Employees With Deductions
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       Table:
       <code>
        Employees
       </code>
      </p>
      <pre>
+--------------+------+
| Column Name  | Type |
+--------------+------+
| employee_id  | int  |
| needed_hours | int  |
+--------------+------+
employee_id is column with unique values for this table.
Each row contains the id of an employee and the minimum number of hours needed for them to work to get their salary.
</pre>
      <p>
      </p>
      <p>
       Table:
       <code>
        Logs
       </code>
      </p>
      <pre>
+-------------+----------+
| Column Name | Type     |
+-------------+----------+
| employee_id | int      |
| in_time     | datetime |
| out_time    | datetime |
+-------------+----------+
(employee_id, in_time, out_time) is the primary key (combination of columns with unique values) for this table.
Each row of this table shows the time stamps for an employee. in_time is the time the employee started to work, and out_time is the time the employee ended work.
All the times are in October 2022. out_time can be one day after in_time which means the employee worked after the midnight.
</pre>
      <p>
      </p>
      <p>
       In a company, each employee must work a certain number of hours every month. Employees work in sessions. The number of hours an employee worked can be calculated from the sum of the number of minutes the employee worked in all of their sessions. The number of minutes in each session is rounded up.
      </p>
      <ul>
       <li>
        For example, if the employee worked for
        <code>
         51
        </code>
        minutes and
        <code>
         2
        </code>
        seconds in a session, we consider it
        <code>
         52
        </code>
        minutes.
       </li>
      </ul>
      <p>
       Write a solution to report the IDs of the employees that will be deducted. In other words, report the IDs of the employees that did not work the needed hours.
      </p>
      <p>
       Return the result table
       <strong>
        in any order
       </strong>
       .
      </p>
      <p>
       The result format is in the following example.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> 
Employees table:
+-------------+--------------+
| employee_id | needed_hours |
+-------------+--------------+
| 1           | 20           |
| 2           | 12           |
| 3           | 2            |
+-------------+--------------+
Logs table:
+-------------+---------------------+---------------------+
| employee_id | in_time             | out_time            |
+-------------+---------------------+---------------------+
| 1           | 2022-10-01 09:00:00 | 2022-10-01 17:00:00 |
| 1           | 2022-10-06 09:05:04 | 2022-10-06 17:09:03 |
| 1           | 2022-10-12 23:00:00 | 2022-10-13 03:00:01 |
| 2           | 2022-10-29 12:00:00 | 2022-10-29 23:58:58 |
+-------------+---------------------+---------------------+
<strong>Output:</strong> 
+-------------+
| employee_id |
+-------------+
| 2           |
| 3           |
+-------------+
<strong>Explanation:</strong> 
Employee 1:
 - Worked for three sessions:
    - On 2022-10-01, they worked for 8 hours.
    - On 2022-10-06, they worked for 8 hours and 4 minutes.
    - On 2022-10-12, they worked for 4 hours and 1 minute. Note that they worked through midnight.
 - Employee 1 worked a total of 20 hours and 5 minutes across sessions and will not be deducted.
Employee 2:
 - Worked for one session:
    - On 2022-10-29, they worked for 11 hours and 59 minutes.
 - Employee 2 did not work their hours and will be deducted.
Employee 3:
 - Did not work any session.
 - Employee 3 did not work their hours and will be deducted.
</pre>
      <h2 id="solutions">
       Solutions
      </h2>
      <ul class="uk-tab" data-uk-switcher="{connect:'#dfea5e0a-a436-4ab1-8b98-574823f4d15c'}">
       <li class="uk-active">
        <a href="solution-2394.html">
         SQL
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="dfea5e0a-a436-4ab1-8b98-574823f4d15c">
       <li>
        <div class="language-sql highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">WITH</span>
    <span class="n">T</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span>
            <span class="n">employee_id</span><span class="p">,</span>
            <span class="k">SUM</span><span class="p">(</span><span class="n">ceiling</span><span class="p">(</span><span class="n">TIMESTAMPDIFF</span><span class="p">(</span><span class="k">second</span><span class="p">,</span> <span class="n">in_time</span><span class="p">,</span> <span class="n">out_time</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span><span class="p">))</span> <span class="o">/</span> <span class="mi">60</span> <span class="k">AS</span> <span class="n">tot</span>
        <span class="k">FROM</span> <span class="n">Logs</span>
        <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">employee_id</span>
    <span class="p">)</span>
<span class="k">SELECT</span> <span class="n">employee_id</span>
<span class="k">FROM</span>
    <span class="n">Employees</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">T</span> <span class="k">USING</span> <span class="p">(</span><span class="n">employee_id</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">IFNULL</span><span class="p">(</span><span class="n">tot</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">needed_hours</span><span class="p">;</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-2394.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
