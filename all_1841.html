<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script src="all_css_run_prettify.js">
  </script>
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
  </script>
  <script>
   window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-K108N8L891');
  </script>
  <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
  </script>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   Leetcode 1841. League Statistics
  </title>
  <meta content="Check Company Tag of Leetcode 1841 for freeãUnlock prime for Leetcode 1841" name="description"/>
  <meta content="Leetcode 1841, 1841. League Statistics, leetcode, company tag, company problem list" name="keywords"/>
  <meta content="width=device-width, initial-scale=1" name="viewport">
   <!-- Bootstrap Core CSS -->
   <link href="all_css_bootstrap.min.css" rel="stylesheet"/>
   <link href="all_css_markdown.css" rel="stylesheet"/>
   <!-- Custom CSS -->
   <style>
    .div-width{
        	width: 70%;
        	margin: auto;
        }
        @media screen and (min-width: 0px) and (max-width: 560px) {
			.div-width{
	        	width: 95%;
	        	margin: auto;
	        }
		}
   </style>
   <script src="https://apis.google.com/js/platform.js">
   </script>
  </meta>
 </head>
 <body>
  
  <div class="div-width" style="padding-top: 30px">
   <div>
    
   </div>
   <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
   </div>
  </div>
  <div class="div-width">
   <h1>
    1841. League Statistics
   </h1>
  </div>
  <div class="markdown-body div-width" style="margin-top: 20px">
   <div class="content__u3I1 question-content__JfgR">
    <div class="sql-schema-wrapper__3VBi">
     <a class="sql-schema-link__3cEg">
      SQL Schema
      <svg class="icon__1Md2" height="1em" viewbox="0 0 24 24" width="1em">
       <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" fill-rule="evenodd">
       </path>
      </svg>
     </a>
    </div>
    <div>
     <p>
      Table:
      <code>
       Teams
      </code>
     </p>
     <pre>+----------------+---------+
| Column Name    | Type    |
+----------------+---------+
| team_id        | int     |
| team_name      | varchar |
+----------------+---------+
team_id is the primary key for this table.
Each row contains information about one team in the league.
</pre>
     <p>
     </p>
     <p>
      Table:
      <code>
       Matches
      </code>
     </p>
     <pre>+-----------------+---------+
| Column Name     | Type    |
+-----------------+---------+
| home_team_id    | int     |
| away_team_id    | int     |
| home_team_goals | int     |
| away_team_goals | int     |
+-----------------+---------+
(home_team_id, away_team_id) is the primary key for this table.
Each row contains information about one match.
home_team_goals is the number of goals scored by the home team.
away_team_goals is the number of goals scored by the away team.
The winner of the match is the team with the higher number of goals.
</pre>
     <p>
     </p>
     <p>
      Write an SQL query to report the statistics of the league. The statistics should be built using the played matches where the
      <strong>
       winning
      </strong>
      team gets
      <strong>
       three points
      </strong>
      and the
      <strong>
       losing
      </strong>
      team gets
      <strong>
       no points
      </strong>
      . If a match ends with a
      <strong>
       draw
      </strong>
      , both teams get
      <strong>
       one point
      </strong>
      .
     </p>
     <p>
      Each row of the result table should contain:
     </p>
     <ul>
      <li>
       <code>
        team_name
       </code>
       - The name of the team in the
       <code>
        Teams
       </code>
       table.
      </li>
      <li>
       <code>
        matches_played
       </code>
       - The number of matches played as either a home or away team.
      </li>
      <li>
       <code>
        points
       </code>
       - The total points the team has so far.
      </li>
      <li>
       <code>
        goal_for
       </code>
       - The total number of goals scored by the team across all matches.
      </li>
      <li>
       <code>
        goal_against
       </code>
       - The total number of goals scored by opponent teams against this team across all matches.
      </li>
      <li>
       <code>
        goal_diff
       </code>
       - The result of
       <code>
        goal_for - goal_against
       </code>
       .
      </li>
     </ul>
     <p>
      Return the result table
      <strong>
       in descending order by
      </strong>
      <code>
       points
      </code>
      . If two or more teams have the same
      <code>
       points
      </code>
      , order them
      <strong>
       in descending order by
      </strong>
      <code>
       goal_diff
      </code>
      . If there is still a tie, order them by
      <code>
       team_name
      </code>
      in
      <strong>
       lexicographical order
      </strong>
      .
     </p>
     <p>
      The query result format is in the following example:
     </p>
     <p>
     </p>
     <pre>Teams table:
+---------+-----------+
| team_id | team_name |
+---------+-----------+
| 1       | Ajax      |
| 4       | Dortmund  |
| 6       | Arsenal   |
+---------+-----------+

Matches table:
+--------------+--------------+-----------------+-----------------+
| home_team_id | away_team_id | home_team_goals | away_team_goals |
+--------------+--------------+-----------------+-----------------+
| 1            | 4            | 0               | 1               |
| 1            | 6            | 3               | 3               |
| 4            | 1            | 5               | 2               |
| 6            | 1            | 0               | 0               |
+--------------+--------------+-----------------+-----------------+


Result table:
+-----------+----------------+--------+----------+--------------+-----------+
| team_name | matches_played | points | goal_for | goal_against | goal_diff |
+-----------+----------------+--------+----------+--------------+-----------+
| Dortmund  | 2              | 6      | 6        | 2            | 4         |
| Arsenal   | 2              | 2      | 3        | 3            | 0         |
| Ajax      | 4              | 2      | 5        | 9            | -4        |
+-----------+----------------+--------+----------+--------------+-----------+

Ajax (team_id=1) played 4 matches: 2 losses and 2 draws. Total points = 0 + 0 + 1 + 1 = 2.
Dortmund (team_id=4) played 2 matches: 2 wins. Total points = 3 + 3 = 6.
Arsenal (team_id=6) played 2 matches: 2 draws. Total points = 1 + 1 = 2.
Dortmund is the first team in the table. Ajax and Arsenal have the same points, but since Arsenal has a higher goal_diff than Ajax, Arsenal comes before Ajax in the table.
</pre>
    </div>
   </div>
   <div>
    <h3>
     Difficulty:
    </h3>
    <span class="label label-warning">
     Medium
    </span>
   </div>
   <div>
    <h3>
     Lock:
    </h3>
    <span class="label label-info">
     Prime
    </span>
   </div>
   
   <div style="height=20px;">
   </div>
   <div>
    <h3>
     Problem Solution
    </h3>
    <a href="index.html" style="font-size:20px;color: #0066cc;margin-bottom:15px;text-decoration:underline">
     Leetcode Solutions Java Python C++
    </a>
   </div>
   
  </div>
 </body>
</html>
