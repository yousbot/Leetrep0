<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-138.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-138.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>138 - Copy List with Random Pointer</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode Question Formatted question description: https://leetcode.ca/all/138.html A linked list of length n is given such that each node contains an additional random pointer, which could point to any node in the list, or null. Construct a deep copy of the list. The deep copy should consist...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-138.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-138.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-138.html" rel="stylesheet"/>
   <link href="solution-138.html" rel="stylesheet"/>
   <link href="solution-138.html" rel="stylesheet"/>
   <link href="solution-138.html" rel="stylesheet"/>
   <link href="solution-138.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="138 - Copy List with Random Pointer" property="og:title"/>
   <meta content="Leetcode Question Formatted question description: https://leetcode.ca/all/138.html A linked list of length n is given such that each node contains an additional random pointer, which could point to any node in the list, or null. Construct a deep copy of the list. The deep copy should consist of exactly n brand new nodes, where each new node has its value set to the value of its corresponding original node. Both the next and random pointer of the new nodes should point to new nodes in the copied list such that the pointers in the original list and copied list represent the same list state. None of the pointers in the new list should point to nodes in the original list. For example, if there are two nodes X and Y in the original list, where X.random --&amp;gt; Y, then for the corresponding two nodes x and y in the copied list, x.random --&amp;gt; y. Return the head of the copied linked list. The linked list is represented in the input/output as a list of n nodes. Each node is represented as a pair of [val, random_index] where: val: an integer representing Node.val random_index: the index of the node (range from 0 to n-1) that the random pointer points to, or null if it does not point to any node. Your code will only be given the head of the original linked list. &amp;nbsp; Example 1: Input: head = [[7,null],[13,0],[11,4],[10,2],[1,0]] Output: [[7,null],[13,0],[11,4],[10,2],[1,0]] Example 2: Input: head = [[1,1],[2,1]] Output: [[1,1],[2,1]] Example 3: Input: head = [[3,null],[3,0],[3,null]] Output: [[3,null],[3,0],[3,null]] &amp;nbsp; Constraints: 0 &amp;lt;= n &amp;lt;= 1000 -104 &amp;lt;= Node.val &amp;lt;= 104 Node.random is null or is pointing to some node in the linked list. Algorithm Three steps, with no extra space: Copy a new node behind each node in the original linked list. Assign values to the random pointers of new nodes in turn, and this assignment is very easy cur-&amp;gt;next-&amp;gt;random = cur-&amp;gt;random-&amp;gt;next. Disconnect the linked list to get a new linked list after deep copy. For example, for example, the original linked list is 1(2) -&amp;gt; 2(3) -&amp;gt; 3(1), and the node pointed to by its random pointer is in parentheses, so this solution is to first traverse the original linked list. Copy a same node after each node, but the random pointer of the copied node is still empty, then the original linked list becomes 1(2) -&amp;gt; 1(null) -&amp;gt; 2(3) -&amp;gt; 2(null ) -&amp;gt; 3(1) -&amp;gt; 3(null). Then the second traversal is to assign the correct value to the random pointer of the copy node, and the original linked list becomes 1(2) -&amp;gt; 1(2) -&amp;gt; 2(3) -&amp;gt; 2(3) -&amp;gt; 3 (1) -&amp;gt; 3(1), note that the assignment statement is: cur-&amp;gt;next-&amp;gt;random = cur-&amp;gt;random-&amp;gt;next; Here cur is the node in the original linked list, cur-&amp;gt;next is the node of the copied linked list, and cur-&amp;gt;next-&amp;gt;random is the random pointer of the copied linked list. cur-&amp;gt;random is the node pointed to by the random pointer of the original linked list..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2016-04-16T22:21:01-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2016-04-16-138-Copy-List-with-Random-Pointer/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-138.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="138 - Copy List with Random Pointer" property="twitter:title"/>
   <meta content="Leetcode Question Formatted question description: https://leetcode.ca/all/138.html A linked list of length n is given such that each node contains an additional random pointer, which could point to any node in the list, or null. Construct a deep copy of the list. The deep copy should consist of exactly n brand new nodes, where each new node has its value set to the value of its corresponding original node. Both the next and random pointer of the new nodes should point to new nodes in the copied list such that the pointers in the original list and copied list represent the same list state. None of the pointers in the new list should point to nodes in the original list. For example, if there are two nodes X and Y in the original list, where X.random --&amp;gt; Y, then for the corresponding two nodes x and y in the copied list, x.random --&amp;gt; y. Return the head of the copied linked list. The linked list is represented in the input/output as a list of n nodes. Each node is represented as a pair of [val, random_index] where: val: an integer representing Node.val random_index: the index of the node (range from 0 to n-1) that the random pointer points to, or null if it does not point to any node. Your code will only be given the head of the original linked list. &amp;nbsp; Example 1: Input: head = [[7,null],[13,0],[11,4],[10,2],[1,0]] Output: [[7,null],[13,0],[11,4],[10,2],[1,0]] Example 2: Input: head = [[1,1],[2,1]] Output: [[1,1],[2,1]] Example 3: Input: head = [[3,null],[3,0],[3,null]] Output: [[3,null],[3,0],[3,null]] &amp;nbsp; Constraints: 0 &amp;lt;= n &amp;lt;= 1000 -104 &amp;lt;= Node.val &amp;lt;= 104 Node.random is null or is pointing to some node in the linked list. Algorithm Three steps, with no extra space: Copy a new node behind each node in the original linked list. Assign values to the random pointers of new nodes in turn, and this assignment is very easy cur-&amp;gt;next-&amp;gt;random = cur-&amp;gt;random-&amp;gt;next. Disconnect the linked list to get a new linked list after deep copy. For example, for example, the original linked list is 1(2) -&amp;gt; 2(3) -&amp;gt; 3(1), and the node pointed to by its random pointer is in parentheses, so this solution is to first traverse the original linked list. Copy a same node after each node, but the random pointer of the copied node is still empty, then the original linked list becomes 1(2) -&amp;gt; 1(null) -&amp;gt; 2(3) -&amp;gt; 2(null ) -&amp;gt; 3(1) -&amp;gt; 3(null). Then the second traversal is to assign the correct value to the random pointer of the copy node, and the original linked list becomes 1(2) -&amp;gt; 1(2) -&amp;gt; 2(3) -&amp;gt; 2(3) -&amp;gt; 3 (1) -&amp;gt; 3(1), note that the assignment statement is: cur-&amp;gt;next-&amp;gt;random = cur-&amp;gt;random-&amp;gt;next; Here cur is the node in the original linked list, cur-&amp;gt;next is the node of the copied linked list, and cur-&amp;gt;next-&amp;gt;random is the random pointer of the copied linked list. cur-&amp;gt;random is the node pointed to by the random pointer of the original linked list..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    138 - Copy List with Random Pointer | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="138 - Copy List with Random Pointer" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-138.html" rel="canonical">
          <meta content="https://leetcode.ca/2016-04-16-138-Copy-List-with-Random-Pointer/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2016-04-16T22:21:01-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"138 - Copy List with Random Pointer","dateModified":"2016-04-16T22:21:01-07:00","datePublished":"2016-04-16T22:21:01-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2016-04-16-138-Copy-List-with-Random-Pointer/"},"url":"https://leetcode.ca/2016-04-16-138-Copy-List-with-Random-Pointer/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="question">
       Question
      </h1>
      <p>
       Formatted question description:
       <a href="solution-138.html">
        https://leetcode.ca/all/138.html
       </a>
      </p>
      <p>
       A linked list of length
       <code>
        n
       </code>
       is given such that each node contains an additional random pointer, which could point to any node in the list, or
       <code>
        null
       </code>
       .
      </p>
      <p>
       Construct a
       <a href="solution-138.html" target="_blank">
        <strong>
         deep copy
        </strong>
       </a>
       of the list. The deep copy should consist of exactly
       <code>
        n
       </code>
       <strong>
        brand new
       </strong>
       nodes, where each new node has its value set to the value of its corresponding original node. Both the
       <code>
        next
       </code>
       and
       <code>
        random
       </code>
       pointer of the new nodes should point to new nodes in the copied list such that the pointers in the original list and copied list represent the same list state.
       <strong>
        None of the pointers in the new list should point to nodes in the original list
       </strong>
       .
      </p>
      <p>
       For example, if there are two nodes
       <code>
        X
       </code>
       and
       <code>
        Y
       </code>
       in the original list, where
       <code>
        X.random --&gt; Y
       </code>
       , then for the corresponding two nodes
       <code>
        x
       </code>
       and
       <code>
        y
       </code>
       in the copied list,
       <code>
        x.random --&gt; y
       </code>
       .
      </p>
      <p>
       Return
       <em>
        the head of the copied linked list
       </em>
       .
      </p>
      <p>
       The linked list is represented in the input/output as a list of
       <code>
        n
       </code>
       nodes. Each node is represented as a pair of
       <code>
        [val, random_index]
       </code>
       where:
      </p>
      <ul>
       <li>
        <code>
         val
        </code>
        : an integer representing
        <code>
         Node.val
        </code>
       </li>
       <li>
        <code>
         random_index
        </code>
        : the index of the node (range from
        <code>
         0
        </code>
        to
        <code>
         n-1
        </code>
        ) that the
        <code>
         random
        </code>
        pointer points to, or
        <code>
         null
        </code>
        if it does not point to any node.
       </li>
      </ul>
      <p>
       Your code will
       <strong>
        only
       </strong>
       be given the
       <code>
        head
       </code>
       of the original linked list.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <p>
       <img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0100-0199/0138.Copy%20List%20with%20Random%20Pointer/images/e1.png" style="width: 700px; height: 142px;"/>
      </p>
      <pre>
<strong>Input:</strong> head = [[7,null],[13,0],[11,4],[10,2],[1,0]]
<strong>Output:</strong> [[7,null],[13,0],[11,4],[10,2],[1,0]]
</pre>
      <p>
       <strong class="example">
        Example 2:
       </strong>
      </p>
      <p>
       <img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0100-0199/0138.Copy%20List%20with%20Random%20Pointer/images/e2.png" style="width: 700px; height: 114px;"/>
      </p>
      <pre>
<strong>Input:</strong> head = [[1,1],[2,1]]
<strong>Output:</strong> [[1,1],[2,1]]
</pre>
      <p>
       <strong class="example">
        Example 3:
       </strong>
      </p>
      <p>
       <strong>
        <img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0100-0199/0138.Copy%20List%20with%20Random%20Pointer/images/e3.png" style="width: 700px; height: 122px;"/>
       </strong>
      </p>
      <pre>
<strong>Input:</strong> head = [[3,null],[3,0],[3,null]]
<strong>Output:</strong> [[3,null],[3,0],[3,null]]
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         0 &lt;= n &lt;= 1000
        </code>
       </li>
       <li>
        <code>
         -10
         <sup>
          4
         </sup>
         &lt;= Node.val &lt;= 10
         <sup>
          4
         </sup>
        </code>
       </li>
       <li>
        <code>
         Node.random
        </code>
        is
        <code>
         null
        </code>
        or is pointing to some node in the linked list.
       </li>
      </ul>
      <h1 id="algorithm">
       Algorithm
      </h1>
      <p>
       Three steps, with no extra space:
      </p>
      <ol>
       <li>
        <p>
         Copy a new node behind each node in the original linked list.
        </p>
       </li>
       <li>
        <p>
         Assign values to the random pointers of new nodes in turn, and this assignment is very easy
         <code class="language-plaintext highlighter-rouge">
          cur-&gt;next-&gt;random = cur-&gt;random-&gt;next
         </code>
         .
        </p>
       </li>
       <li>
        <p>
         Disconnect the linked list to get a new linked list after deep copy.
        </p>
       </li>
      </ol>
      <p>
       For example, for example, the original linked list is
       <code class="language-plaintext highlighter-rouge">
        1(2) -&gt; 2(3) -&gt; 3(1)
       </code>
       , and the node pointed to by its random pointer is in parentheses, so this solution is to first traverse the original linked list. Copy a same node after each node, but the random pointer of the copied node is still empty, then the original linked list becomes
       <code class="language-plaintext highlighter-rouge">
        1(2) -&gt; 1(null) -&gt; 2(3) -&gt; 2(null ) -&gt; 3(1) -&gt; 3(null)
       </code>
       . Then the second traversal is to assign the correct value to the random pointer of the copy node, and the original linked list becomes
       <code class="language-plaintext highlighter-rouge">
        1(2) -&gt; 1(2) -&gt; 2(3) -&gt; 2(3) -&gt; 3 (1) -&gt; 3(1)
       </code>
       , note that the assignment statement is:
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        cur-&gt;next-&gt;random = cur-&gt;random-&gt;next;
       </code>
      </p>
      <p>
       Here cur is the node in the original linked list, cur-&gt;next is the node of the copied linked list, and
       <code class="language-plaintext highlighter-rouge">
        cur-&gt;next-&gt;random
       </code>
       is the random pointer of the copied linked list.
       <code class="language-plaintext highlighter-rouge">
        cur-&gt;random
       </code>
       is the node pointed to by the random pointer of the original linked list node. Because it points to the node of the original linked list, we have to add another next to point to the node of the copied linked list. The last traversal is to disconnect the original linked list from the copy linked list.
      </p>
      <h1 id="code">
       Code
      </h1>
      <ul class="uk-tab" data-uk-switcher="{connect:'#1e661dec-a333-492b-b86a-21a72892f3ad'}">
       <li class="uk-active">
        <a href="solution-138.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-138.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-138.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-138.html">
         Go
        </a>
       </li>
       <li>
        <a href="solution-138.html">
         TypeScript
        </a>
       </li>
       <li>
        <a href="solution-138.html">
         Javascript
        </a>
       </li>
       <li>
        <a href="solution-138.html">
         C#
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="1e661dec-a333-492b-b86a-21a72892f3ad">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Copy_List_with_Random_Pointer</span> <span class="o">{</span>

    <span class="cm">/**
     * Definition for singly-linked list with a random pointer.
     * class RandomListNode {
     *     int label;
     *     RandomListNode next, random;
     *     RandomListNode(int x) { this.label = x; }
     * };
     */</span>

    <span class="cm">/*
        1. å¨åé¾è¡¨çæ¯ä¸ªèç¹åé¢æ·è´åºä¸ä¸ªæ°çèç¹ã
        2. ä¾æ¬¡ç»æ°çèç¹çéæºæéèµå¼ï¼èä¸è¿ä¸ªèµå¼éå¸¸å®¹æ cur-&gt;next-&gt;random = cur-&gt;random-&gt;nextã
        3. æ­å¼é¾è¡¨å¯å¾å°æ·±åº¦æ·è´åçæ°é¾è¡¨ã
     */</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Solution_noExtraMap</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nc">RandomListNode</span> <span class="nf">copyRandomList</span><span class="o">(</span><span class="nc">RandomListNode</span> <span class="n">head</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="c1">// duplicate new node right after</span>
            <span class="nc">RandomListNode</span> <span class="n">current</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">current</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">RandomListNode</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomListNode</span><span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">label</span><span class="o">);</span>
                <span class="n">t</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
                <span class="n">current</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="c1">// random pointer update for duplicate new node</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">current</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">random</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">.</span><span class="na">random</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">random</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="c1">// cut copied list out</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
            <span class="nc">RandomListNode</span> <span class="n">res</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">current</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">RandomListNode</span> <span class="n">t</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
                <span class="n">current</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">next</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">t</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="na">next</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>

        <span class="c1">// map from original node, to its copy node</span>
        <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">RandomListNode</span><span class="o">,</span> <span class="nc">RandomListNode</span><span class="o">&gt;</span> <span class="n">hm</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

        <span class="kd">public</span> <span class="nc">RandomListNode</span> <span class="nf">copyRandomList</span><span class="o">(</span><span class="nc">RandomListNode</span> <span class="n">head</span><span class="o">)</span> <span class="o">{</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="nc">RandomListNode</span> <span class="n">current</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>

            <span class="k">while</span> <span class="o">(</span><span class="n">current</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>

                <span class="nc">RandomListNode</span> <span class="n">currentCopy</span> <span class="o">=</span> <span class="n">getNodeCopy</span><span class="o">(</span><span class="n">current</span><span class="o">);</span>

                <span class="nc">RandomListNode</span> <span class="n">currentNextCopy</span> <span class="o">=</span> <span class="n">getNodeCopy</span><span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">);</span>
                <span class="nc">RandomListNode</span> <span class="n">currentRandomCopy</span> <span class="o">=</span> <span class="n">getNodeCopy</span><span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">random</span><span class="o">);</span>

                <span class="n">currentCopy</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">currentNextCopy</span><span class="o">;</span>
                <span class="n">currentCopy</span><span class="o">.</span><span class="na">random</span> <span class="o">=</span> <span class="n">currentRandomCopy</span><span class="o">;</span>

                <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="k">return</span> <span class="n">hm</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">head</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="nc">RandomListNode</span> <span class="nf">getNodeCopy</span> <span class="o">(</span><span class="nc">RandomListNode</span> <span class="n">originalNode</span><span class="o">)</span> <span class="o">{</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">originalNode</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// @note: missed this check, last node will cause error, whose next is null</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">hm</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">originalNode</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">hm</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">originalNode</span><span class="o">);</span>

            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nc">RandomListNode</span> <span class="n">nodeCopy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomListNode</span><span class="o">(</span><span class="n">originalNode</span><span class="o">.</span><span class="na">label</span><span class="o">);</span>
                <span class="n">hm</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">originalNode</span><span class="o">,</span> <span class="n">nodeCopy</span><span class="o">);</span>

                <span class="k">return</span> <span class="n">nodeCopy</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="err">############</span>

<span class="cm">/*
// Definition for a Node.
class Node {
    int val;
    Node next;
    Node random;

    public Node(int val) {
        this.val = val;
        this.next = null;
        this.random = null;
    }
}
*/</span>
<span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Node</span> <span class="nf">copyRandomList</span><span class="o">(</span><span class="nc">Node</span> <span class="n">head</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Node</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span> <span class="n">cur</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;)</span> <span class="o">{</span>
            <span class="nc">Node</span> <span class="n">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">(</span><span class="n">cur</span><span class="o">.</span><span class="na">val</span><span class="o">,</span> <span class="n">cur</span><span class="o">.</span><span class="na">next</span><span class="o">);</span>
            <span class="n">cur</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">node</span><span class="o">;</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Node</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span> <span class="n">cur</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="na">next</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">cur</span><span class="o">.</span><span class="na">random</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">cur</span><span class="o">.</span><span class="na">next</span><span class="o">.</span><span class="na">random</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="na">random</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">Node</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Node</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span> <span class="n">cur</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;)</span> <span class="o">{</span>
            <span class="nc">Node</span> <span class="n">nxt</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">nxt</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">cur</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">nxt</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">nxt</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="c1">// OJ: https://leetcode.com/problems/copy-list-with-random-pointer/</span>
<span class="c1">// Time: O(N)</span>
<span class="c1">// Space: O(1)</span>
<span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">Node</span><span class="o">*</span> <span class="n">copyRandomList</span><span class="p">(</span><span class="n">Node</span><span class="o">*</span> <span class="n">head</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">auto</span> <span class="n">p</span> <span class="o">=</span> <span class="n">head</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
            <span class="k">auto</span> <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">);</span>
            <span class="n">node</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">copy</span><span class="p">;</span>
            <span class="n">copy</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">head</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">random</span><span class="p">)</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span><span class="o">-&gt;</span><span class="n">random</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">random</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">head</span><span class="p">;</span>
        <span class="n">Node</span> <span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="n">tail</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">auto</span> <span class="n">node</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
            <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
            <span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">node</span><span class="p">;</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">node</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">h</span><span class="p">.</span><span class="n">next</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-python highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="c1"># Definition for singly-linked list with a random pointer.
# class RandomListNode(object):
#     def __init__(self, x):
#         self.label = x
#         self.next = None
#         self.random = None
</span>
<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">copyRandomList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="s">"Node"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s">"Node"</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">head</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="n">head</span>
        <span class="k">while</span> <span class="n">cur</span><span class="p">:</span> <span class="c1"># copy nodes
</span>            <span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">cur</span><span class="p">.</span><span class="n">val</span><span class="p">,</span> <span class="n">cur</span><span class="p">.</span><span class="nb">next</span><span class="p">)</span>
            <span class="n">cur</span><span class="p">.</span><span class="nb">next</span> <span class="o">=</span> <span class="n">node</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="nb">next</span>

        <span class="n">cur</span> <span class="o">=</span> <span class="n">head</span>
        <span class="k">while</span> <span class="n">cur</span><span class="p">:</span> <span class="c1"># copy random pointers
</span>            <span class="k">if</span> <span class="n">cur</span><span class="p">.</span><span class="n">random</span><span class="p">:</span>
                <span class="n">cur</span><span class="p">.</span><span class="nb">next</span><span class="p">.</span><span class="n">random</span> <span class="o">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nb">next</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span><span class="p">.</span><span class="nb">next</span><span class="p">.</span><span class="nb">next</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="n">head</span><span class="p">.</span><span class="nb">next</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="n">head</span>
        <span class="k">while</span> <span class="n">cur</span><span class="p">:</span> <span class="c1"># cut into 2 lists
</span>            <span class="n">nxt</span> <span class="o">=</span> <span class="n">cur</span><span class="p">.</span><span class="nb">next</span>
            <span class="k">if</span> <span class="n">nxt</span><span class="p">:</span>
                <span class="n">cur</span><span class="p">.</span><span class="nb">next</span> <span class="o">=</span> <span class="n">nxt</span><span class="p">.</span><span class="nb">next</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">nxt</span>
        <span class="k">return</span> <span class="n">ans</span>


<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span> <span class="c1"># with a map
</span>    <span class="k">def</span> <span class="nf">copyRandomList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="s">'Node'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s">'Node'</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">head</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">node_map</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Create the copy nodes without next and random connections
</span>        <span class="n">current</span> <span class="o">=</span> <span class="n">head</span>
        <span class="k">while</span> <span class="n">current</span><span class="p">:</span>
            <span class="n">node_map</span><span class="p">[</span><span class="n">current</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">val</span><span class="p">)</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="p">.</span><span class="nb">next</span>

        <span class="c1"># Assign next and random connections for the copy nodes
</span>        <span class="n">current</span> <span class="o">=</span> <span class="n">head</span>
        <span class="k">while</span> <span class="n">current</span><span class="p">:</span>
            <span class="n">copy_node</span> <span class="o">=</span> <span class="n">node_map</span><span class="p">[</span><span class="n">current</span><span class="p">]</span>
            <span class="n">copy_node</span><span class="p">.</span><span class="nb">next</span> <span class="o">=</span> <span class="n">node_map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="nb">next</span><span class="p">)</span>
            <span class="n">copy_node</span><span class="p">.</span><span class="n">random</span> <span class="o">=</span> <span class="n">node_map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">random</span><span class="p">)</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="p">.</span><span class="nb">next</span>

        <span class="k">return</span> <span class="n">node_map</span><span class="p">[</span><span class="n">head</span><span class="p">]</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="c">/**
 * Definition for a Node.
 * type Node struct {
 *     Val int
 *     Next *Node
 *     Random *Node
 * }
 */</span>

<span class="k">func</span> <span class="n">copyRandomList</span><span class="p">(</span><span class="n">head</span> <span class="o">*</span><span class="n">Node</span><span class="p">)</span> <span class="o">*</span><span class="n">Node</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">head</span> <span class="o">==</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="k">return</span> <span class="no">nil</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">cur</span> <span class="o">:=</span> <span class="n">head</span><span class="p">;</span> <span class="n">cur</span> <span class="o">!=</span> <span class="no">nil</span><span class="p">;</span> <span class="p">{</span>
		<span class="n">node</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">Node</span><span class="p">{</span><span class="n">cur</span><span class="o">.</span><span class="n">Val</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">Next</span><span class="p">,</span> <span class="no">nil</span><span class="p">}</span>
		<span class="n">cur</span><span class="o">.</span><span class="n">Next</span> <span class="o">=</span> <span class="n">node</span>
		<span class="n">cur</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">Next</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">cur</span> <span class="o">:=</span> <span class="n">head</span><span class="p">;</span> <span class="n">cur</span> <span class="o">!=</span> <span class="no">nil</span><span class="p">;</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">Next</span><span class="o">.</span><span class="n">Next</span> <span class="p">{</span>
		<span class="k">if</span> <span class="n">cur</span><span class="o">.</span><span class="n">Random</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
			<span class="n">cur</span><span class="o">.</span><span class="n">Next</span><span class="o">.</span><span class="n">Random</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">Random</span><span class="o">.</span><span class="n">Next</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">ans</span> <span class="o">:=</span> <span class="n">head</span><span class="o">.</span><span class="n">Next</span>
	<span class="k">for</span> <span class="n">cur</span> <span class="o">:=</span> <span class="n">head</span><span class="p">;</span> <span class="n">cur</span> <span class="o">!=</span> <span class="no">nil</span><span class="p">;</span> <span class="p">{</span>
		<span class="n">nxt</span> <span class="o">:=</span> <span class="n">cur</span><span class="o">.</span><span class="n">Next</span>
		<span class="k">if</span> <span class="n">nxt</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
			<span class="n">cur</span><span class="o">.</span><span class="n">Next</span> <span class="o">=</span> <span class="n">nxt</span><span class="o">.</span><span class="n">Next</span>
		<span class="p">}</span>
		<span class="n">cur</span> <span class="o">=</span> <span class="n">nxt</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ans</span>
<span class="p">}</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-ts highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="cm">/**
 * Definition for Node.
 * class Node {
 *     val: number
 *     next: Node | null
 *     random: Node | null
 *     constructor(val?: number, next?: Node, random?: Node) {
 *         this.val = (val===undefined ? 0 : val)
 *         this.next = (next===undefined ? null : next)
 *         this.random = (random===undefined ? null : random)
 *     }
 * }
 */</span>

<span class="kd">function</span> <span class="nx">copyRandomList</span><span class="p">(</span><span class="nx">head</span><span class="p">:</span> <span class="nx">Node</span> <span class="o">|</span> <span class="kc">null</span><span class="p">):</span> <span class="nx">Node</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="nx">Node</span><span class="p">,</span> <span class="nx">Node</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="kd">let</span> <span class="nx">cur</span> <span class="o">=</span> <span class="nx">head</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">cur</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">map</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">cur</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">(</span><span class="nx">cur</span><span class="p">.</span><span class="nx">val</span><span class="p">));</span>
        <span class="nx">cur</span> <span class="o">=</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">next</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">cur</span> <span class="o">=</span> <span class="nx">head</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">cur</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">map</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">cur</span><span class="p">).</span><span class="nx">next</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">cur</span><span class="p">.</span><span class="nx">next</span><span class="p">)</span> <span class="o">??</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">map</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">cur</span><span class="p">).</span><span class="nx">random</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">cur</span><span class="p">.</span><span class="nx">random</span><span class="p">)</span> <span class="o">??</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">cur</span> <span class="o">=</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">next</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">map</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">head</span><span class="p">);</span>
<span class="p">}</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-js highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="cm">/**
 * // Definition for a Node.
 * function Node(val, next, random) {
 *    this.val = val;
 *    this.next = next;
 *    this.random = random;
 * };
 */</span>

<span class="cm">/**
 * @param {Node} head
 * @return {Node}
 */</span>
<span class="kd">var</span> <span class="nx">copyRandomList</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">head</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">head</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">cur</span> <span class="o">=</span> <span class="nx">head</span><span class="p">;</span> <span class="nx">cur</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">(</span><span class="nx">cur</span><span class="p">.</span><span class="nx">val</span><span class="p">,</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">next</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
        <span class="nx">cur</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
        <span class="nx">cur</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">next</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">cur</span> <span class="o">=</span> <span class="nx">head</span><span class="p">;</span> <span class="nx">cur</span><span class="p">;</span> <span class="nx">cur</span> <span class="o">=</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">next</span><span class="p">.</span><span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">cur</span><span class="p">.</span><span class="nx">random</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cur</span><span class="p">.</span><span class="nx">next</span><span class="p">.</span><span class="nx">random</span> <span class="o">=</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">random</span><span class="p">.</span><span class="nx">next</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">ans</span> <span class="o">=</span> <span class="nx">head</span><span class="p">.</span><span class="nx">next</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">cur</span> <span class="o">=</span> <span class="nx">head</span><span class="p">;</span> <span class="nx">cur</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">nxt</span> <span class="o">=</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">next</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">nxt</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cur</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="nx">nxt</span><span class="p">.</span><span class="nx">next</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">cur</span> <span class="o">=</span> <span class="nx">nxt</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">ans</span><span class="p">;</span>
<span class="p">};</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cs highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="cm">/*
// Definition for a Node.
public class Node {
    public int val;
    public Node next;
    public Node random;

    public Node(int _val) {
        val = _val;
        next = null;
        random = null;
    }
}
*/</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
    <span class="k">public</span> <span class="n">Node</span> <span class="nf">CopyRandomList</span><span class="p">(</span><span class="n">Node</span> <span class="n">head</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">head</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Node</span> <span class="n">cur</span> <span class="p">=</span> <span class="n">head</span><span class="p">;</span> <span class="n">cur</span> <span class="p">!=</span> <span class="k">null</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="n">Node</span> <span class="n">node</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Node</span><span class="p">(</span><span class="n">cur</span><span class="p">.</span><span class="n">val</span><span class="p">,</span> <span class="n">cur</span><span class="p">.</span><span class="n">next</span><span class="p">);</span>
            <span class="n">cur</span><span class="p">.</span><span class="n">next</span> <span class="p">=</span> <span class="n">node</span><span class="p">;</span>
            <span class="n">cur</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="n">next</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Node</span> <span class="n">cur</span> <span class="p">=</span> <span class="n">head</span><span class="p">;</span> <span class="n">cur</span> <span class="p">!=</span> <span class="k">null</span><span class="p">;</span> <span class="n">cur</span> <span class="p">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">next</span><span class="p">.</span><span class="n">next</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cur</span><span class="p">.</span><span class="n">random</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">cur</span><span class="p">.</span><span class="n">next</span><span class="p">.</span><span class="n">random</span> <span class="p">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">next</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">Node</span> <span class="n">ans</span> <span class="p">=</span> <span class="n">head</span><span class="p">.</span><span class="n">next</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Node</span> <span class="n">cur</span> <span class="p">=</span> <span class="n">head</span><span class="p">;</span> <span class="n">cur</span> <span class="p">!=</span> <span class="k">null</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="n">Node</span> <span class="n">nxt</span> <span class="p">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">next</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nxt</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">cur</span><span class="p">.</span><span class="n">next</span> <span class="p">=</span> <span class="n">nxt</span><span class="p">.</span><span class="n">next</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">cur</span> <span class="p">=</span> <span class="n">nxt</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-138.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
