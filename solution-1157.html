<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-1157.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-1157.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>1157 - Online Majority Element In Subarray</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 1157. Online Majority Element In Subarray Description Design a data structure that efficiently finds the majority element of a given subarray. The majority element of a subarray is an element that occurs threshold times or more in the subarray. Implementing the MajorityChecker class: MajorityChecker(int[] arr)...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-1157.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-1157.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-1157.html" rel="stylesheet"/>
   <link href="solution-1157.html" rel="stylesheet"/>
   <link href="solution-1157.html" rel="stylesheet"/>
   <link href="solution-1157.html" rel="stylesheet"/>
   <link href="solution-1157.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="1157 - Online Majority Element In Subarray" property="og:title"/>
   <meta content="Leetcode 1157. Online Majority Element In Subarray Description Design a data structure that efficiently finds the majority element of a given subarray. The majority element of a subarray is an element that occurs threshold times or more in the subarray. Implementing the MajorityChecker class: MajorityChecker(int[] arr) Initializes the instance of the class with the given array arr. int query(int left, int right, int threshold) returns the element in the subarray arr[left...right] that occurs at least threshold times, or -1 if no such element exists. &amp;nbsp; Example 1: Input [&amp;quot;MajorityChecker&amp;quot;, &amp;quot;query&amp;quot;, &amp;quot;query&amp;quot;, &amp;quot;query&amp;quot;] [[[1, 1, 2, 2, 1, 1]], [0, 5, 4], [0, 3, 3], [2, 3, 2]] Output [null, 1, -1, 2] Explanation MajorityChecker majorityChecker = new MajorityChecker([1, 1, 2, 2, 1, 1]); majorityChecker.query(0, 5, 4); // return 1 majorityChecker.query(0, 3, 3); // return -1 majorityChecker.query(2, 3, 2); // return 2 &amp;nbsp; Constraints: 1 &amp;lt;= arr.length &amp;lt;= 2 * 104 1 &amp;lt;= arr[i] &amp;lt;= 2 * 104 0 &amp;lt;= left &amp;lt;= right &amp;lt; arr.length threshold &amp;lt;= right - left + 1 2 * threshold &amp;gt; right - left + 1 At most 104 calls will be made to query. Solutions Solution 1: Segment Tree + Boyer-Moore Voting Algorithm + Binary Search We notice that the problem requires us to find the possible majority element in a specific interval, so we consider using a segment tree to maintain the candidate majority element and its occurrence in each interval. We define each node of the segment tree as Node, each node contains the following attributes: l: The left endpoint of the node, the index starts from $1$. r: The right endpoint of the node, the index starts from $1$. x: The candidate majority element of the node. cnt: The occurrence of the candidate majority element of the node. The segment tree mainly has the following operations: build(u, l, r): Build the segment tree. pushup(u): Use the information of the child nodes to update the information of the parent node. query(u, l, r): Query the interval sum. In the initialization method of the main function, we first create a segment tree, and use a hash table $d$ to record all indexes of each element in the array. In the query(left, right, threshold) method, we directly call the query method of the segment tree to get the candidate majority element $x$. Then use binary search to find the first index $l$ in the array that is greater than or equal to $left$, and the first index $r$ that is greater than $right$. If $r - l \ge threshold$, return $x$, otherwise return $-1$. In terms of time complexity, the time complexity of the initialization method is $O(n)$, and the time complexity of the query method is $O(\log n)$. The space complexity is $O(n)$. Here, $n$ is the length of the array. Java C++ Python Go class Node { int l, r; int x, cnt; } class SegmentTree { private Node[] tr; private int[] nums; public SegmentTree(int[] nums) { int n..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2019-01-30T00:00:00-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2019-01-30-1157-Online-Majority-Element-In-Subarray/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-1157.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="1157 - Online Majority Element In Subarray" property="twitter:title"/>
   <meta content="Leetcode 1157. Online Majority Element In Subarray Description Design a data structure that efficiently finds the majority element of a given subarray. The majority element of a subarray is an element that occurs threshold times or more in the subarray. Implementing the MajorityChecker class: MajorityChecker(int[] arr) Initializes the instance of the class with the given array arr. int query(int left, int right, int threshold) returns the element in the subarray arr[left...right] that occurs at least threshold times, or -1 if no such element exists. &amp;nbsp; Example 1: Input [&amp;quot;MajorityChecker&amp;quot;, &amp;quot;query&amp;quot;, &amp;quot;query&amp;quot;, &amp;quot;query&amp;quot;] [[[1, 1, 2, 2, 1, 1]], [0, 5, 4], [0, 3, 3], [2, 3, 2]] Output [null, 1, -1, 2] Explanation MajorityChecker majorityChecker = new MajorityChecker([1, 1, 2, 2, 1, 1]); majorityChecker.query(0, 5, 4); // return 1 majorityChecker.query(0, 3, 3); // return -1 majorityChecker.query(2, 3, 2); // return 2 &amp;nbsp; Constraints: 1 &amp;lt;= arr.length &amp;lt;= 2 * 104 1 &amp;lt;= arr[i] &amp;lt;= 2 * 104 0 &amp;lt;= left &amp;lt;= right &amp;lt; arr.length threshold &amp;lt;= right - left + 1 2 * threshold &amp;gt; right - left + 1 At most 104 calls will be made to query. Solutions Solution 1: Segment Tree + Boyer-Moore Voting Algorithm + Binary Search We notice that the problem requires us to find the possible majority element in a specific interval, so we consider using a segment tree to maintain the candidate majority element and its occurrence in each interval. We define each node of the segment tree as Node, each node contains the following attributes: l: The left endpoint of the node, the index starts from $1$. r: The right endpoint of the node, the index starts from $1$. x: The candidate majority element of the node. cnt: The occurrence of the candidate majority element of the node. The segment tree mainly has the following operations: build(u, l, r): Build the segment tree. pushup(u): Use the information of the child nodes to update the information of the parent node. query(u, l, r): Query the interval sum. In the initialization method of the main function, we first create a segment tree, and use a hash table $d$ to record all indexes of each element in the array. In the query(left, right, threshold) method, we directly call the query method of the segment tree to get the candidate majority element $x$. Then use binary search to find the first index $l$ in the array that is greater than or equal to $left$, and the first index $r$ that is greater than $right$. If $r - l \ge threshold$, return $x$, otherwise return $-1$. In terms of time complexity, the time complexity of the initialization method is $O(n)$, and the time complexity of the query method is $O(\log n)$. The space complexity is $O(n)$. Here, $n$ is the length of the array. Java C++ Python Go class Node { int l, r; int x, cnt; } class SegmentTree { private Node[] tr; private int[] nums; public SegmentTree(int[] nums) { int n..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    1157 - Online Majority Element In Subarray | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="1157 - Online Majority Element In Subarray" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-1157.html" rel="canonical">
          <meta content="https://leetcode.ca/2019-01-30-1157-Online-Majority-Element-In-Subarray/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2019-01-30T00:00:00-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"1157 - Online Majority Element In Subarray","dateModified":"2019-01-30T00:00:00-08:00","datePublished":"2019-01-30T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2019-01-30-1157-Online-Majority-Element-In-Subarray/"},"url":"https://leetcode.ca/2019-01-30-1157-Online-Majority-Element-In-Subarray/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="1157-online-majority-element-in-subarray">
       <a href="solution-1157.html">
        1157. Online Majority Element In Subarray
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       Design a data structure that efficiently finds the
       <strong>
        majority element
       </strong>
       of a given subarray.
      </p>
      <p>
       The
       <strong>
        majority element
       </strong>
       of a subarray is an element that occurs
       <code>
        threshold
       </code>
       times or more in the subarray.
      </p>
      <p>
       Implementing the
       <code>
        MajorityChecker
       </code>
       class:
      </p>
      <ul>
       <li>
        <code>
         MajorityChecker(int[] arr)
        </code>
        Initializes the instance of the class with the given array
        <code>
         arr
        </code>
        .
       </li>
       <li>
        <code>
         int query(int left, int right, int threshold)
        </code>
        returns the element in the subarray
        <code>
         arr[left...right]
        </code>
        that occurs at least
        <code>
         threshold
        </code>
        times, or
        <code>
         -1
        </code>
        if no such element exists.
       </li>
      </ul>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input</strong>
["MajorityChecker", "query", "query", "query"]
[[[1, 1, 2, 2, 1, 1]], [0, 5, 4], [0, 3, 3], [2, 3, 2]]
<strong>Output</strong>
[null, 1, -1, 2]

<strong>Explanation</strong>
MajorityChecker majorityChecker = new MajorityChecker([1, 1, 2, 2, 1, 1]);
majorityChecker.query(0, 5, 4); // return 1
majorityChecker.query(0, 3, 3); // return -1
majorityChecker.query(2, 3, 2); // return 2
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         1 &lt;= arr.length &lt;= 2 * 10
         <sup>
          4
         </sup>
        </code>
       </li>
       <li>
        <code>
         1 &lt;= arr[i] &lt;= 2 * 10
         <sup>
          4
         </sup>
        </code>
       </li>
       <li>
        <code>
         0 &lt;= left &lt;= right &lt; arr.length
        </code>
       </li>
       <li>
        <code>
         threshold &lt;= right - left + 1
        </code>
       </li>
       <li>
        <code>
         2 * threshold &gt; right - left + 1
        </code>
       </li>
       <li>
        At most
        <code>
         10
         <sup>
          4
         </sup>
        </code>
        calls will be made to
        <code>
         query
        </code>
        .
       </li>
      </ul>
      <h2 id="solutions">
       Solutions
      </h2>
      <p>
       <strong>
        Solution 1: Segment Tree + Boyer-Moore Voting Algorithm + Binary Search
       </strong>
      </p>
      <p>
       We notice that the problem requires us to find the possible majority element in a specific interval, so we consider using a segment tree to maintain the candidate majority element and its occurrence in each interval.
      </p>
      <p>
       We define each node of the segment tree as
       <code class="language-plaintext highlighter-rouge">
        Node
       </code>
       , each node contains the following attributes:
      </p>
      <ul>
       <li>
        <code class="language-plaintext highlighter-rouge">
         l
        </code>
        : The left endpoint of the node, the index starts from $1$.
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         r
        </code>
        : The right endpoint of the node, the index starts from $1$.
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         x
        </code>
        : The candidate majority element of the node.
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         cnt
        </code>
        : The occurrence of the candidate majority element of the node.
       </li>
      </ul>
      <p>
       The segment tree mainly has the following operations:
      </p>
      <ul>
       <li>
        <code class="language-plaintext highlighter-rouge">
         build(u, l, r)
        </code>
        : Build the segment tree.
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         pushup(u)
        </code>
        : Use the information of the child nodes to update the information of the parent node.
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         query(u, l, r)
        </code>
        : Query the interval sum.
       </li>
      </ul>
      <p>
       In the initialization method of the main function, we first create a segment tree, and use a hash table $d$ to record all indexes of each element in the array.
      </p>
      <p>
       In the
       <code class="language-plaintext highlighter-rouge">
        query(left, right, threshold)
       </code>
       method, we directly call the
       <code class="language-plaintext highlighter-rouge">
        query
       </code>
       method of the segment tree to get the candidate majority element $x$. Then use binary search to find the first index $l$ in the array that is greater than or equal to $left$, and the first index $r$ that is greater than $right$. If $r - l \ge threshold$, return $x$, otherwise return $-1$.
      </p>
      <p>
       In terms of time complexity, the time complexity of the initialization method is $O(n)$, and the time complexity of the query method is $O(\log n)$. The space complexity is $O(n)$. Here, $n$ is the length of the array.
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#1aa101d8-6b7e-42f9-b893-25d644c02247'}">
       <li class="uk-active">
        <a href="solution-1157.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-1157.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-1157.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-1157.html">
         Go
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="1aa101d8-6b7e-42f9-b893-25d644c02247">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="n">cnt</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">SegmentTree</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Node</span><span class="o">[]</span> <span class="n">tr</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">nums</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">SegmentTree</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">nums</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">nums</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">nums</span> <span class="o">=</span> <span class="n">nums</span><span class="o">;</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">[</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">tr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">build</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">build</span><span class="o">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">,</span> <span class="kt">int</span> <span class="n">l</span><span class="o">,</span> <span class="kt">int</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">;</span>
        <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">x</span> <span class="o">=</span> <span class="n">nums</span><span class="o">[</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="o">];</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">cnt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="o">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="o">;</span>
        <span class="n">build</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">mid</span><span class="o">);</span>
        <span class="n">build</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">r</span><span class="o">);</span>
        <span class="n">pushup</span><span class="o">(</span><span class="n">u</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">query</span><span class="o">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">,</span> <span class="kt">int</span> <span class="n">l</span><span class="o">,</span> <span class="kt">int</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">r</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">x</span><span class="o">,</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">cnt</span><span class="o">};</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="o">(</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">l</span> <span class="o">+</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">r</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">query</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="n">mid</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">query</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kt">var</span> <span class="n">left</span> <span class="o">=</span> <span class="n">query</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">);</span>
        <span class="kt">var</span> <span class="n">right</span> <span class="o">=</span> <span class="n">query</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">left</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">==</span> <span class="n">right</span><span class="o">[</span><span class="mi">0</span><span class="o">])</span> <span class="o">{</span>
            <span class="n">left</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">+=</span> <span class="n">right</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">left</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">&gt;=</span> <span class="n">right</span><span class="o">[</span><span class="mi">1</span><span class="o">])</span> <span class="o">{</span>
            <span class="n">left</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">-=</span> <span class="n">right</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">right</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">-=</span> <span class="n">left</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">right</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">left</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">pushup</span><span class="o">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">].</span><span class="na">x</span> <span class="o">==</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">].</span><span class="na">x</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">].</span><span class="na">x</span><span class="o">;</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">cnt</span> <span class="o">=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">].</span><span class="na">cnt</span> <span class="o">+</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">].</span><span class="na">cnt</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">].</span><span class="na">cnt</span> <span class="o">&gt;=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">].</span><span class="na">cnt</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">].</span><span class="na">x</span><span class="o">;</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">cnt</span> <span class="o">=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">].</span><span class="na">cnt</span> <span class="o">-</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">].</span><span class="na">cnt</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">].</span><span class="na">x</span><span class="o">;</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">cnt</span> <span class="o">=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">].</span><span class="na">cnt</span> <span class="o">-</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">].</span><span class="na">cnt</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">MajorityChecker</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">SegmentTree</span> <span class="n">tree</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">MajorityChecker</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">arr</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SegmentTree</span><span class="o">(</span><span class="n">arr</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">d</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">k</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;()).</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">query</span><span class="o">(</span><span class="kt">int</span> <span class="n">left</span><span class="o">,</span> <span class="kt">int</span> <span class="n">right</span><span class="o">,</span> <span class="kt">int</span> <span class="n">threshold</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">left</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)[</span><span class="mi">0</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="n">search</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">x</span><span class="o">),</span> <span class="n">left</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">search</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">x</span><span class="o">),</span> <span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">r</span> <span class="o">-</span> <span class="n">l</span> <span class="o">&gt;=</span> <span class="n">threshold</span> <span class="o">?</span> <span class="n">x</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">search</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">arr</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="o">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">arr</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">mid</span><span class="o">)</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">mid</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">left</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 * Your MajorityChecker object will be instantiated and called as such:
 * MajorityChecker obj = new MajorityChecker(arr);
 * int param_1 = obj.query(left,right,threshold);
 */</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Node</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">pii</span> <span class="o">=</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">SegmentTree</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">SegmentTree</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">nums</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">nums</span> <span class="o">=</span> <span class="n">nums</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">nums</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">tr</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">tr</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="n">build</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">pii</span> <span class="n">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">{</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">,</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">l</span> <span class="o">+</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="n">mid</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">auto</span> <span class="n">left</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="k">auto</span> <span class="n">right</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">first</span> <span class="o">==</span> <span class="n">right</span><span class="p">.</span><span class="n">first</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">left</span><span class="p">.</span><span class="n">second</span> <span class="o">+=</span> <span class="n">right</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">second</span> <span class="o">&gt;=</span> <span class="n">right</span><span class="p">.</span><span class="n">second</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">left</span><span class="p">.</span><span class="n">second</span> <span class="o">-=</span> <span class="n">right</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">right</span><span class="p">.</span><span class="n">second</span> <span class="o">-=</span> <span class="n">left</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">right</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">left</span><span class="p">;</span>
    <span class="p">}</span>

<span class="nl">private:</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">*&gt;</span> <span class="n">tr</span><span class="p">;</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">nums</span><span class="p">;</span>

    <span class="kt">void</span> <span class="n">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="p">;</span>
        <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
        <span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="n">pushup</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">pushup</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">==</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">+</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">&gt;=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">-</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span> <span class="o">-</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">cnt</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">MajorityChecker</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">MajorityChecker</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">arr</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SegmentTree</span><span class="p">(</span><span class="n">arr</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">d</span><span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">left</span><span class="p">,</span> <span class="kt">int</span> <span class="n">right</span><span class="p">,</span> <span class="kt">int</span> <span class="n">threshold</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">tree</span><span class="o">-&gt;</span><span class="n">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">left</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="p">).</span><span class="n">first</span><span class="p">;</span>
        <span class="k">auto</span> <span class="n">l</span> <span class="o">=</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span> <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">end</span><span class="p">(),</span> <span class="n">left</span><span class="p">);</span>
        <span class="k">auto</span> <span class="n">r</span> <span class="o">=</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span> <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">end</span><span class="p">(),</span> <span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">r</span> <span class="o">-</span> <span class="n">l</span> <span class="o">&gt;=</span> <span class="n">threshold</span> <span class="o">?</span> <span class="n">x</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

<span class="nl">private:</span>
    <span class="n">unordered_map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">;</span>
    <span class="n">SegmentTree</span><span class="o">*</span> <span class="n">tree</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**
 * Your MajorityChecker object will be instantiated and called as such:
 * MajorityChecker* obj = new MajorityChecker(arr);
 * int param_1 = obj-&gt;query(left,right,threshold);
 */</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s">"l"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="s">"x"</span><span class="p">,</span> <span class="s">"cnt"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">class</span> <span class="nc">SegmentTree</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">nums</span> <span class="o">=</span> <span class="n">nums</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tr</span> <span class="o">=</span> <span class="p">[</span><span class="n">Node</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span> <span class="o">=</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">nums</span><span class="p">[</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">return</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pushup</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">cnt</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">mid</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">cnt1</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">x2</span><span class="p">,</span> <span class="n">cnt2</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">cnt1</span> <span class="o">+</span> <span class="n">cnt2</span>
        <span class="k">if</span> <span class="n">cnt1</span> <span class="o">&gt;=</span> <span class="n">cnt2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">cnt1</span> <span class="o">-</span> <span class="n">cnt2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x2</span><span class="p">,</span> <span class="n">cnt2</span> <span class="o">-</span> <span class="n">cnt1</span>

    <span class="k">def</span> <span class="nf">pushup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">cnt</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">cnt</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">cnt</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">cnt</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">cnt</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">cnt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">cnt</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">cnt</span>


<span class="k">class</span> <span class="nc">MajorityChecker</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">SegmentTree</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">left</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">left</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">right</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span> <span class="k">if</span> <span class="n">r</span> <span class="o">-</span> <span class="n">l</span> <span class="o">&gt;=</span> <span class="n">threshold</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>


<span class="c1"># Your MajorityChecker object will be instantiated and called as such:
# obj = MajorityChecker(arr)
# param_1 = obj.query(left,right,threshold)
</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">type</span> <span class="n">node</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cnt</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">segmentTree</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">nums</span> <span class="p">[]</span><span class="kt">int</span>
	<span class="n">tr</span>   <span class="p">[]</span><span class="o">*</span><span class="n">node</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">pair</span> <span class="k">struct</span><span class="p">{</span> <span class="n">x</span><span class="p">,</span> <span class="n">cnt</span> <span class="kt">int</span> <span class="p">}</span>

<span class="k">func</span> <span class="n">newSegmentTree</span><span class="p">(</span><span class="n">nums</span> <span class="p">[]</span><span class="kt">int</span><span class="p">)</span> <span class="o">*</span><span class="n">segmentTree</span> <span class="p">{</span>
	<span class="n">n</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
	<span class="n">tr</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">n</span><span class="o">&lt;&lt;</span><span class="m">2</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">tr</span> <span class="p">{</span>
		<span class="n">tr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">node</span><span class="p">{}</span>
	<span class="p">}</span>
	<span class="n">t</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">segmentTree</span><span class="p">{</span><span class="n">nums</span><span class="p">,</span> <span class="n">tr</span><span class="p">}</span>
	<span class="n">t</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">t</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">t</span> <span class="o">*</span><span class="n">segmentTree</span><span class="p">)</span> <span class="n">build</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span>
	<span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">r</span> <span class="p">{</span>
		<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="m">1</span><span class="p">]</span>
		<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="o">=</span> <span class="m">1</span>
		<span class="k">return</span>
	<span class="p">}</span>
	<span class="n">mid</span> <span class="o">:=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="m">1</span>
	<span class="n">t</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
	<span class="n">t</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="m">1</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="n">t</span><span class="o">.</span><span class="n">pushup</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">t</span> <span class="o">*</span><span class="n">segmentTree</span><span class="p">)</span> <span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="kt">int</span><span class="p">)</span> <span class="n">pair</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">pair</span><span class="p">{</span><span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span><span class="p">}</span>
	<span class="p">}</span>
	<span class="n">mid</span> <span class="o">:=</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">l</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="m">1</span>
	<span class="k">if</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">mid</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">mid</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">:=</span> <span class="n">t</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">t</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">left</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">right</span><span class="o">.</span><span class="n">x</span> <span class="p">{</span>
		<span class="n">left</span><span class="o">.</span><span class="n">cnt</span> <span class="o">+=</span> <span class="n">right</span><span class="o">.</span><span class="n">cnt</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">left</span><span class="o">.</span><span class="n">cnt</span> <span class="o">&gt;=</span> <span class="n">right</span><span class="o">.</span><span class="n">cnt</span> <span class="p">{</span>
		<span class="n">left</span><span class="o">.</span><span class="n">cnt</span> <span class="o">-=</span> <span class="n">right</span><span class="o">.</span><span class="n">cnt</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">right</span><span class="o">.</span><span class="n">cnt</span> <span class="o">-=</span> <span class="n">left</span><span class="o">.</span><span class="n">cnt</span>
		<span class="n">left</span> <span class="o">=</span> <span class="n">right</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">left</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">t</span> <span class="o">*</span><span class="n">segmentTree</span><span class="p">)</span> <span class="n">pushup</span><span class="p">(</span><span class="n">u</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="p">{</span>
		<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
		<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="o">&gt;=</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="p">{</span>
		<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
		<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
		<span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">cnt</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">MajorityChecker</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">tree</span> <span class="o">*</span><span class="n">segmentTree</span>
	<span class="n">d</span>    <span class="k">map</span><span class="p">[</span><span class="kt">int</span><span class="p">][]</span><span class="kt">int</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">Constructor</span><span class="p">(</span><span class="n">arr</span> <span class="p">[]</span><span class="kt">int</span><span class="p">)</span> <span class="n">MajorityChecker</span> <span class="p">{</span>
	<span class="n">tree</span> <span class="o">:=</span> <span class="n">newSegmentTree</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
	<span class="n">d</span> <span class="o">:=</span> <span class="k">map</span><span class="p">[</span><span class="kt">int</span><span class="p">][]</span><span class="kt">int</span><span class="p">{}</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">arr</span> <span class="p">{</span>
		<span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">MajorityChecker</span><span class="p">{</span><span class="n">tree</span><span class="p">,</span> <span class="n">d</span><span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">this</span> <span class="o">*</span><span class="n">MajorityChecker</span><span class="p">)</span> <span class="n">Query</span><span class="p">(</span><span class="n">left</span> <span class="kt">int</span><span class="p">,</span> <span class="n">right</span> <span class="kt">int</span><span class="p">,</span> <span class="n">threshold</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="n">x</span> <span class="o">:=</span> <span class="n">this</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">left</span><span class="o">+</span><span class="m">1</span><span class="p">,</span> <span class="n">right</span><span class="o">+</span><span class="m">1</span><span class="p">)</span><span class="o">.</span><span class="n">x</span>
	<span class="n">l</span> <span class="o">:=</span> <span class="n">sort</span><span class="o">.</span><span class="n">SearchInts</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">left</span><span class="p">)</span>
	<span class="n">r</span> <span class="o">:=</span> <span class="n">sort</span><span class="o">.</span><span class="n">SearchInts</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">right</span><span class="o">+</span><span class="m">1</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">r</span><span class="o">-</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">threshold</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">x</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="o">-</span><span class="m">1</span>
<span class="p">}</span>

<span class="c">/**
 * Your MajorityChecker object will be instantiated and called as such:
 * obj := Constructor(arr);
 * param_1 := obj.Query(left,right,threshold);
 */</span>
</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-1157.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
