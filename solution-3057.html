<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-3057.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-3057.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>3057 - Employees Project Allocation</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 3057. Employees Project Allocation Description Table: Project +-------------+---------+ \| Column Name \| Type \| +-------------+---------+ \| project_id \| int \| \| employee_id \| int \| \| workload \| int \| +-------------+---------+ employee_id is the primary key (column with unique values) of this table. employee_id is...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-3057.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-3057.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-3057.html" rel="stylesheet"/>
   <link href="solution-3057.html" rel="stylesheet"/>
   <link href="solution-3057.html" rel="stylesheet"/>
   <link href="solution-3057.html" rel="stylesheet"/>
   <link href="solution-3057.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="3057 - Employees Project Allocation" property="og:title"/>
   <meta content="Leetcode 3057. Employees Project Allocation Description Table: Project +-------------+---------+ \| Column Name \| Type \| +-------------+---------+ \| project_id \| int \| \| employee_id \| int \| \| workload \| int \| +-------------+---------+ employee_id is the primary key (column with unique values) of this table. employee_id is a foreign key (reference column) to Employee table. Each row of this table indicates that the employee with employee_id is working on the project with project_id and the workload of the project. Table: Employees +------------------+---------+ \| Column Name \| Type \| +------------------+---------+ \| employee_id \| int \| \| name \| varchar \| \| team \| varchar \| +------------------+---------+ employee_id is the primary key (column with unique values) of this table. Each row of this table contains information about one employee. Write a solution to find the employees who are allocated to projects with a workload that exceeds the average workload of all employees for their respective teams Return the result table ordered by employee_id, project_id in ascending order. The result format is in the following example. &amp;nbsp; Example 1: Input: Project table: +-------------+-------------+----------+ \| project_id \| employee_id \| workload \| +-------------+-------------+----------+ \| 1 \| 1 \| 45 \| \| 1 \| 2 \| 90 \| \| 2 \| 3 \| 12 \| \| 2 \| 4 \| 68 \| +-------------+-------------+----------+ Employees table: +-------------+--------+------+ \| employee_id \| name \| team \| +-------------+--------+------+ \| 1 \| Khaled \| A \| \| 2 \| Ali \| B \| \| 3 \| John \| B \| \| 4 \| Doe \| A \| +-------------+--------+------+ Output: +-------------+------------+---------------+------------------+ \| employee_id \| project_id \| employee_name \| project_workload \| +-------------+------------+---------------+------------------+ \| 2 \| 1 \| Ali \| 90 \| \| 4 \| 2 \| Doe \| 68 \| +-------------+------------+---------------+------------------+ Explanation: - Employee with ID 1 has a project workload of 45 and belongs to Team A, where the average workload is 56.50. Since his project workload does not exceed the team&amp;#39;s average workload, he will be excluded. - Employee with ID 2 has a project workload of 90 and belongs to Team B, where the average workload is 51.00. Since his project workload does exceed the team&amp;#39;s average workload, he will be included. - Employee with ID 3 has a project workload of 12 and belongs to Team B, where the average workload is 51.00. Since his project workload does not exceed the team&amp;#39;s average workload, he will be excluded. - Employee with ID 4 has a project workload of 68 and belongs to Team A, where the average workload is 56.50. Since his project workload does exceed the team&amp;#39;s average workload, he will be included. Result table orderd by employee_id, project_id in ascending order. Solutions Solution 1: Grouping Statistics + Equi-Join First, we join the Project table and the Employees table based on employee_id, then group by team to calculate the average workload of each team, and record it in the temporary table T. Then, we join the Project table and the Employees table again, and also..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2024-03-08T00:00:00-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2024-03-08-3057-Employees-Project-Allocation/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-3057.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="3057 - Employees Project Allocation" property="twitter:title"/>
   <meta content="Leetcode 3057. Employees Project Allocation Description Table: Project +-------------+---------+ \| Column Name \| Type \| +-------------+---------+ \| project_id \| int \| \| employee_id \| int \| \| workload \| int \| +-------------+---------+ employee_id is the primary key (column with unique values) of this table. employee_id is a foreign key (reference column) to Employee table. Each row of this table indicates that the employee with employee_id is working on the project with project_id and the workload of the project. Table: Employees +------------------+---------+ \| Column Name \| Type \| +------------------+---------+ \| employee_id \| int \| \| name \| varchar \| \| team \| varchar \| +------------------+---------+ employee_id is the primary key (column with unique values) of this table. Each row of this table contains information about one employee. Write a solution to find the employees who are allocated to projects with a workload that exceeds the average workload of all employees for their respective teams Return the result table ordered by employee_id, project_id in ascending order. The result format is in the following example. &amp;nbsp; Example 1: Input: Project table: +-------------+-------------+----------+ \| project_id \| employee_id \| workload \| +-------------+-------------+----------+ \| 1 \| 1 \| 45 \| \| 1 \| 2 \| 90 \| \| 2 \| 3 \| 12 \| \| 2 \| 4 \| 68 \| +-------------+-------------+----------+ Employees table: +-------------+--------+------+ \| employee_id \| name \| team \| +-------------+--------+------+ \| 1 \| Khaled \| A \| \| 2 \| Ali \| B \| \| 3 \| John \| B \| \| 4 \| Doe \| A \| +-------------+--------+------+ Output: +-------------+------------+---------------+------------------+ \| employee_id \| project_id \| employee_name \| project_workload \| +-------------+------------+---------------+------------------+ \| 2 \| 1 \| Ali \| 90 \| \| 4 \| 2 \| Doe \| 68 \| +-------------+------------+---------------+------------------+ Explanation: - Employee with ID 1 has a project workload of 45 and belongs to Team A, where the average workload is 56.50. Since his project workload does not exceed the team&amp;#39;s average workload, he will be excluded. - Employee with ID 2 has a project workload of 90 and belongs to Team B, where the average workload is 51.00. Since his project workload does exceed the team&amp;#39;s average workload, he will be included. - Employee with ID 3 has a project workload of 12 and belongs to Team B, where the average workload is 51.00. Since his project workload does not exceed the team&amp;#39;s average workload, he will be excluded. - Employee with ID 4 has a project workload of 68 and belongs to Team A, where the average workload is 56.50. Since his project workload does exceed the team&amp;#39;s average workload, he will be included. Result table orderd by employee_id, project_id in ascending order. Solutions Solution 1: Grouping Statistics + Equi-Join First, we join the Project table and the Employees table based on employee_id, then group by team to calculate the average workload of each team, and record it in the temporary table T. Then, we join the Project table and the Employees table again, and also..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    3057 - Employees Project Allocation | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="3057 - Employees Project Allocation" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-3057.html" rel="canonical">
          <meta content="https://leetcode.ca/2024-03-08-3057-Employees-Project-Allocation/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2024-03-08T00:00:00-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"3057 - Employees Project Allocation","dateModified":"2024-03-08T00:00:00-08:00","datePublished":"2024-03-08T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2024-03-08-3057-Employees-Project-Allocation/"},"url":"https://leetcode.ca/2024-03-08-3057-Employees-Project-Allocation/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="3057-employees-project-allocation">
       <a href="solution-3057.html">
        3057. Employees Project Allocation
       </a>
      </h1>
      <!-- tags: -->
      <h2 id="description">
       Description
      </h2>
      <p>
       Table:
       <code>
        Project
       </code>
      </p>
      <pre>
+-------------+---------+
\| Column Name \| Type    \|
+-------------+---------+
\| project_id  \| int     \|
\| employee_id \| int     \|
\| workload    \| int     \|
+-------------+---------+
employee_id is the primary key (column with unique values) of this table.
employee_id is a foreign key (reference column) to <code>Employee</code> table.
Each row of this table indicates that the employee with employee_id is working on the project with project_id and the workload of the project.
</pre>
      <p>
       Table:
       <code>
        Employees
       </code>
      </p>
      <pre>
+------------------+---------+
\| Column Name      \| Type    \|
+------------------+---------+
\| employee_id      \| int     \|
\| name             \| varchar \|
\| team             \| varchar \|
+------------------+---------+
employee_id is the primary key (column with unique values) of this table.
Each row of this table contains information about one employee.
</pre>
      <p>
       Write a solution to find the
       <strong>
        employees
       </strong>
       who are allocated to projects with a
       <strong>
        workload that exceeds the average
       </strong>
       workload of all employees for
       <strong>
        their respective teams
       </strong>
      </p>
      <p>
       Return t
       <em>
        he result table ordered by
       </em>
       <code>
        employee_id
       </code>
       ,
       <code>
        project_id
       </code>
       <em>
        in
        <strong>
         ascending
        </strong>
        order.
       </em>
      </p>
      <p>
       The result format is in the following example.
      </p>
      <p>
      </p>
      <p>
       <strong>
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> 
Project table:
+-------------+-------------+----------+
\| project_id  \| employee_id \| workload \|
+-------------+-------------+----------+
\| 1           \| 1           \|  45      \|
\| 1           \| 2           \|  90      \| 
\| 2           \| 3           \|  12      \|
\| 2           \| 4           \|  68      \|
+-------------+-------------+----------+
Employees table:
+-------------+--------+------+
\| employee_id \| name   \| team \|
+-------------+--------+------+
\| 1           \| Khaled \| A    \|
\| 2           \| Ali    \| B    \|
\| 3           \| John   \| B    \|
\| 4           \| Doe    \| A    \|
+-------------+--------+------+
<strong>Output:</strong> 
+-------------+------------+---------------+------------------+
\| employee_id \| project_id \| employee_name \| project_workload \|
+-------------+------------+---------------+------------------+  
\| 2           \| 1          \| Ali           \| 90               \| 
\| 4           \| 2          \| Doe           \| 68               \| 
+-------------+------------+---------------+------------------+
<strong>Explanation:</strong> 
- Employee with ID 1 has a project workload of 45 and belongs to Team A, where the average workload is 56.50. Since his project workload does not exceed the team's average workload, he will be excluded.
- Employee with ID 2 has a project workload of 90 and belongs to Team B, where the average workload is 51.00. Since his project workload does exceed the team's average workload, he will be included.
- Employee with ID 3 has a project workload of 12 and belongs to Team B, where the average workload is 51.00. Since his project workload does not exceed the team's average workload, he will be excluded.
- Employee with ID 4 has a project workload of 68 and belongs to Team A, where the average workload is 56.50. Since his project workload does exceed the team's average workload, he will be included.
Result table orderd by employee_id, project_id in ascending order.
</pre>
      <h2 id="solutions">
       Solutions
      </h2>
      <h3 id="solution-1-grouping-statistics--equi-join">
       Solution 1: Grouping Statistics + Equi-Join
      </h3>
      <p>
       First, we join the
       <code class="language-plaintext highlighter-rouge">
        Project
       </code>
       table and the
       <code class="language-plaintext highlighter-rouge">
        Employees
       </code>
       table based on
       <code class="language-plaintext highlighter-rouge">
        employee_id
       </code>
       , then group by
       <code class="language-plaintext highlighter-rouge">
        team
       </code>
       to calculate the average workload of each team, and record it in the temporary table
       <code class="language-plaintext highlighter-rouge">
        T
       </code>
       .
      </p>
      <p>
       Then, we join the
       <code class="language-plaintext highlighter-rouge">
        Project
       </code>
       table and the
       <code class="language-plaintext highlighter-rouge">
        Employees
       </code>
       table again, and also join the
       <code class="language-plaintext highlighter-rouge">
        T
       </code>
       table, to find employees whose workload is greater than the average workload of the team. Finally, we sort by
       <code class="language-plaintext highlighter-rouge">
        employee_id
       </code>
       and
       <code class="language-plaintext highlighter-rouge">
        project_id
       </code>
       .
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#375366f7-a54a-4860-a78d-b57754d70877'}">
       <li class="uk-active">
        <a href="solution-3057.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-3057.html">
         SQL
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="375366f7-a54a-4860-a78d-b57754d70877">
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>


<span class="k">def</span> <span class="nf">employees_with_above_avg_workload</span><span class="p">(</span>
    <span class="n">project</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">employees</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">"employee_id"</span><span class="p">)</span>
    <span class="n">avg_workload_per_team</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">"team"</span><span class="p">)[</span><span class="s">"workload"</span><span class="p">].</span><span class="n">mean</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">merged_df</span><span class="p">,</span> <span class="n">avg_workload_per_team</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">"team"</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="s">"_avg"</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s">"workload"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">merged_df</span><span class="p">[</span><span class="s">"workload_avg"</span><span class="p">]]</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="p">[[</span><span class="s">"employee_id"</span><span class="p">,</span> <span class="s">"project_id"</span><span class="p">,</span> <span class="s">"name"</span><span class="p">,</span> <span class="s">"workload"</span><span class="p">]]</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">"name"</span><span class="p">:</span> <span class="s">"employee_name"</span><span class="p">,</span> <span class="s">"workload"</span><span class="p">:</span> <span class="s">"project_workload"</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">"employee_id"</span><span class="p">,</span> <span class="s">"project_id"</span><span class="p">])</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-sql highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">WITH</span>
    <span class="n">T</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">team</span><span class="p">,</span> <span class="k">AVG</span><span class="p">(</span><span class="n">workload</span><span class="p">)</span> <span class="k">AS</span> <span class="n">avg_workload</span>
        <span class="k">FROM</span>
            <span class="n">Project</span>
            <span class="k">JOIN</span> <span class="n">Employees</span> <span class="k">USING</span> <span class="p">(</span><span class="n">employee_id</span><span class="p">)</span>
        <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span>
    <span class="p">)</span>
<span class="k">SELECT</span>
    <span class="n">employee_id</span><span class="p">,</span>
    <span class="n">project_id</span><span class="p">,</span>
    <span class="n">name</span> <span class="k">AS</span> <span class="n">employee_name</span><span class="p">,</span>
    <span class="n">workload</span> <span class="k">AS</span> <span class="n">project_workload</span>
<span class="k">FROM</span>
    <span class="n">Project</span>
    <span class="k">JOIN</span> <span class="n">Employees</span> <span class="k">USING</span> <span class="p">(</span><span class="n">employee_id</span><span class="p">)</span>
    <span class="k">JOIN</span> <span class="n">T</span> <span class="k">USING</span> <span class="p">(</span><span class="n">team</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">workload</span> <span class="o">&gt;</span> <span class="n">avg_workload</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-3057.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
