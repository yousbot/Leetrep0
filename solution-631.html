<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-631.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-631.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>631 - Design Excel Sum Formula</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode Formatted question description: https://leetcode.ca/all/631.html 631. Design Excel Sum Formula Level Hard Description Your task is to design the basic function of Excel and implement the function of sum formula. Specifically, you need to implement the following functions: Excel(int H, char W): This is the constructor....">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-631.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-631.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-631.html" rel="stylesheet"/>
   <link href="solution-631.html" rel="stylesheet"/>
   <link href="solution-631.html" rel="stylesheet"/>
   <link href="solution-631.html" rel="stylesheet"/>
   <link href="solution-631.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="631 - Design Excel Sum Formula" property="og:title"/>
   <meta content='Leetcode Formatted question description: https://leetcode.ca/all/631.html 631. Design Excel Sum Formula Level Hard Description Your task is to design the basic function of Excel and implement the function of sum formula. Specifically, you need to implement the following functions: Excel(int H, char W): This is the constructor. The inputs represents the height and width of the Excel form. H is a positive integer, range from 1 to 26. It represents the height. W is a character range from âAâ to âZâ. It represents that the width is the number of characters from âAâ to W. The Excel form content is represented by a height * width 2D integer array C, it should be initialized to zero. You should assume that the first row of C starts from 1, and the first column of C starts from âAâ. void Set(int row, char column, int val): Change the value at C(row, column) to be val. int Get(int row, char column): Return the value at C(row, column). int Sum(int row, char column, List of Strings : numbers): This function calculate and set the value at C(row, column), where the value should be the sum of cells represented by numbers. This function return the sum result at C(row, column). This sum formula should exist until this cell is overlapped by another value or another sum formula. numbers is a list of strings that each string represent a cell or a range of cells. If the string represent a single cell, then it has the following format: ColRow. For example, âF7â represents the cell at (7, F). If the string represent a range of cells, then it has the following format: ColRow1:ColRow2. The range will always be a rectangle, and ColRow1 represent the position of the top-left cell, and ColRow2 represents the position of the bottom-right cell. Example 1: Excel(3,"C"); // construct a 3*3 2D array with all zero. // A B C // 1 0 0 0 // 2 0 0 0 // 3 0 0 0 Set(1, "A", 2); // set C(1,"A") to be 2. // A B C // 1 2 0 0 // 2 0 0 0 // 3 0 0 0 Sum(3, "C", ["A1", "A1:B2"]); // set C(3,"C") to be the sum of value at C(1,"A") and the values sum of the rectangle range whose top-left cell is C(1,"A") and bottom-right cell is C(2,"B"). Return 4. // A B C // 1 2 0 0 // 2 0 0 0 // 3 0 0 4 Set(2, "B", 2); // set C(2,"B") to be 2. Note C(3, "C") should also be changed. // A B C // 1 2 0 0 // 2 0 2 0 // 3 0 0 6 Note: You could assume that there wonât be any circular sum reference. For example, A1 = sum(B1) and B1 = sum(A1). The test cases are using double-quotes to represent a character. Please remember to RESET your class variables declared in class Excel, as static/class variables are persisted...' property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2017-08-22T22:21:01-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2017-08-22-631-Design-Excel-Sum-Formula/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-631.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="631 - Design Excel Sum Formula" property="twitter:title"/>
   <meta content='Leetcode Formatted question description: https://leetcode.ca/all/631.html 631. Design Excel Sum Formula Level Hard Description Your task is to design the basic function of Excel and implement the function of sum formula. Specifically, you need to implement the following functions: Excel(int H, char W): This is the constructor. The inputs represents the height and width of the Excel form. H is a positive integer, range from 1 to 26. It represents the height. W is a character range from âAâ to âZâ. It represents that the width is the number of characters from âAâ to W. The Excel form content is represented by a height * width 2D integer array C, it should be initialized to zero. You should assume that the first row of C starts from 1, and the first column of C starts from âAâ. void Set(int row, char column, int val): Change the value at C(row, column) to be val. int Get(int row, char column): Return the value at C(row, column). int Sum(int row, char column, List of Strings : numbers): This function calculate and set the value at C(row, column), where the value should be the sum of cells represented by numbers. This function return the sum result at C(row, column). This sum formula should exist until this cell is overlapped by another value or another sum formula. numbers is a list of strings that each string represent a cell or a range of cells. If the string represent a single cell, then it has the following format: ColRow. For example, âF7â represents the cell at (7, F). If the string represent a range of cells, then it has the following format: ColRow1:ColRow2. The range will always be a rectangle, and ColRow1 represent the position of the top-left cell, and ColRow2 represents the position of the bottom-right cell. Example 1: Excel(3,"C"); // construct a 3*3 2D array with all zero. // A B C // 1 0 0 0 // 2 0 0 0 // 3 0 0 0 Set(1, "A", 2); // set C(1,"A") to be 2. // A B C // 1 2 0 0 // 2 0 0 0 // 3 0 0 0 Sum(3, "C", ["A1", "A1:B2"]); // set C(3,"C") to be the sum of value at C(1,"A") and the values sum of the rectangle range whose top-left cell is C(1,"A") and bottom-right cell is C(2,"B"). Return 4. // A B C // 1 2 0 0 // 2 0 0 0 // 3 0 0 4 Set(2, "B", 2); // set C(2,"B") to be 2. Note C(3, "C") should also be changed. // A B C // 1 2 0 0 // 2 0 2 0 // 3 0 0 6 Note: You could assume that there wonât be any circular sum reference. For example, A1 = sum(B1) and B1 = sum(A1). The test cases are using double-quotes to represent a character. Please remember to RESET your class variables declared in class Excel, as static/class variables are persisted...' property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    631 - Design Excel Sum Formula | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="631 - Design Excel Sum Formula" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-631.html" rel="canonical">
          <meta content="https://leetcode.ca/2017-08-22-631-Design-Excel-Sum-Formula/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2017-08-22T22:21:01-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"631 - Design Excel Sum Formula","dateModified":"2017-08-22T22:21:01-07:00","datePublished":"2017-08-22T22:21:01-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2017-08-22-631-Design-Excel-Sum-Formula/"},"url":"https://leetcode.ca/2017-08-22-631-Design-Excel-Sum-Formula/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <p>
       Formatted question description:
       <a href="solution-631.html">
        https://leetcode.ca/all/631.html
       </a>
      </p>
      <h1 id="631-design-excel-sum-formula">
       631. Design Excel Sum Formula
      </h1>
      <h2 id="level">
       Level
      </h2>
      <p>
       Hard
      </p>
      <h2 id="description">
       Description
      </h2>
      <p>
       Your task is to design the basic function of Excel and implement the function of sum formula. Specifically, you need to implement the following functions:
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        Excel(int H, char W)
       </code>
       : This is the constructor. The inputs represents the height and width of the Excel form.
       <strong>
        H
       </strong>
       is a positive integer, range from 1 to 26. It represents the height.
       <strong>
        W
       </strong>
       is a character range from âAâ to âZâ. It represents that the width is the number of characters from âAâ to
       <strong>
        W
       </strong>
       . The Excel form content is represented by a height * width 2D integer array
       <code class="language-plaintext highlighter-rouge">
        C
       </code>
       , it should be initialized to zero. You should assume that the first row of
       <code class="language-plaintext highlighter-rouge">
        C
       </code>
       starts from 1, and the first column of
       <code class="language-plaintext highlighter-rouge">
        C
       </code>
       starts from âAâ.
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        void Set(int row, char column, int val)
       </code>
       : Change the value at
       <code class="language-plaintext highlighter-rouge">
        C(row, column)
       </code>
       to be val.
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        int Get(int row, char column)
       </code>
       : Return the value at
       <code class="language-plaintext highlighter-rouge">
        C(row, column)
       </code>
       .
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        int Sum(int row, char column, List of Strings : numbers)
       </code>
       : This function calculate and set the value at
       <code class="language-plaintext highlighter-rouge">
        C(row, column)
       </code>
       , where the value should be the sum of cells represented by numbers. This function return the sum result at
       <code class="language-plaintext highlighter-rouge">
        C(row, column)
       </code>
       . This sum formula should exist until this cell is overlapped by another value or another sum formula.
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        numbers
       </code>
       is a list of strings that each string represent a cell or a range of cells. If the string represent a single cell, then it has the following format:
       <code class="language-plaintext highlighter-rouge">
        ColRow
       </code>
       . For example, âF7â represents the cell at (7, F).
      </p>
      <p>
       If the string represent a range of cells, then it has the following format:
       <code class="language-plaintext highlighter-rouge">
        ColRow1:ColRow2
       </code>
       . The range will always be a rectangle, and ColRow1 represent the position of the top-left cell, and ColRow2 represents the position of the bottom-right cell.
      </p>
      <p>
       Example 1:
      </p>
      <div class="language-plaintext highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code>Excel(3,"C"); 
// construct a 3*3 2D array with all zero.
//   A B C
// 1 0 0 0
// 2 0 0 0
// 3 0 0 0

Set(1, "A", 2);
// set C(1,"A") to be 2.
//   A B C
// 1 2 0 0
// 2 0 0 0
// 3 0 0 0

Sum(3, "C", ["A1", "A1:B2"]);
// set C(3,"C") to be the sum of value at C(1,"A") and the values sum of the rectangle range whose top-left cell is C(1,"A") and bottom-right cell is C(2,"B"). Return 4. 
//   A B C
// 1 2 0 0
// 2 0 0 0
// 3 0 0 4

Set(2, "B", 2);
// set C(2,"B") to be 2. Note C(3, "C") should also be changed.
//   A B C
// 1 2 0 0
// 2 0 2 0
// 3 0 0 6
</code></pre>
       </div>
      </div>
      <p>
       <strong>
        Note:
       </strong>
      </p>
      <ol>
       <li>
        You could assume that there wonât be any circular sum reference. For example, A1 = sum(B1) and B1 = sum(A1).
       </li>
       <li>
        The test cases are using double-quotes to represent a character.
       </li>
       <li>
        Please remember to
        <strong>
         RESET
        </strong>
        your class variables declared in class Excel, as static/class variables are
        <strong>
         persisted across multiple test cases
        </strong>
        . Please see
        <a href="solution-631.html">
         here
        </a>
        for more details.
       </li>
      </ol>
      <h2 id="solution">
       Solution
      </h2>
      <p>
       In class
       <code class="language-plaintext highlighter-rouge">
        Excel
       </code>
       , maintain the number of rows and the number of columns, the cells, and two maps that stores each cell and the sum cells relevant to the cell and stores each sum cell and the cells relevant to the sum cell, respectively.
      </p>
      <p>
       For the constructor, initialize the number of rows to
       <code class="language-plaintext highlighter-rouge">
        H + 1
       </code>
       and the number of columns to
       <code class="language-plaintext highlighter-rouge">
        W - 'A' + 1
       </code>
       , initialize the cells with the rows and the columns, and initialize the two maps.
      </p>
      <p>
       For method
       <code class="language-plaintext highlighter-rouge">
        set
       </code>
       , set the given cellâs value to
       <code class="language-plaintext highlighter-rouge">
        v
       </code>
       , remove the relations in the two maps between the current cell and other cells where the current cell is a sum cell (which means the current cellâs value equals the sum of one or several other cells), and update the cellsâ values that are directly or indirectly affected by the current cell.
      </p>
      <p>
       For method
       <code class="language-plaintext highlighter-rouge">
        get
       </code>
       , simply get the value of the given cell and return.
      </p>
      <p>
       For method
       <code class="language-plaintext highlighter-rouge">
        sum
       </code>
       , first obtain the given cellâs value and call method
       <code class="language-plaintext highlighter-rouge">
        set
       </code>
       to remove the relations of the previous sum formula (if it exists), then update the two maps and calculate the sum of the current cell, and finally update the cellsâ values that are directly or indirectly affected by the current cell, which is the same as the last step in method
       <code class="language-plaintext highlighter-rouge">
        set
       </code>
       .
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#565fc15d-f511-462f-8de2-afdf8521d46a'}">
       <li class="uk-active">
        <a href="solution-631.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-631.html">
         Python
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="565fc15d-f511-462f-8de2-afdf8521d46a">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Excel</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">rows</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">columns</span><span class="o">;</span>
    <span class="kt">int</span><span class="o">[][]</span> <span class="n">cells</span><span class="o">;</span>
    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">cellSumMap</span><span class="o">;</span>
    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">sumCellMap</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Excel</span><span class="o">(</span><span class="kt">int</span> <span class="no">H</span><span class="o">,</span> <span class="kt">char</span> <span class="no">W</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="no">H</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="no">W</span> <span class="o">-</span> <span class="sc">'A'</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">rows</span><span class="o">][</span><span class="n">columns</span><span class="o">];</span>
        <span class="n">cellSumMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;&gt;();</span>
        <span class="n">sumCellMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;&gt;();</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="kt">int</span> <span class="n">r</span><span class="o">,</span> <span class="kt">char</span> <span class="n">c</span><span class="o">,</span> <span class="kt">int</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">prevValue</span> <span class="o">=</span> <span class="n">cells</span><span class="o">[</span><span class="n">r</span><span class="o">][</span><span class="n">c</span> <span class="o">-</span> <span class="sc">'A'</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">difference</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="n">prevValue</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">cellName</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">c</span><span class="o">)</span> <span class="o">+</span> <span class="n">r</span><span class="o">;</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">cellMap</span> <span class="o">=</span> <span class="n">sumCellMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">cellName</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;());</span>
        <span class="n">sumCellMap</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">cellName</span><span class="o">);</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">cellSet</span> <span class="o">=</span> <span class="n">cellMap</span><span class="o">.</span><span class="na">keySet</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">cell</span> <span class="o">:</span> <span class="n">cellSet</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">sumMap</span> <span class="o">=</span> <span class="n">cellSumMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">cell</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;());</span>
            <span class="n">sumMap</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">cellName</span><span class="o">);</span>
            <span class="n">cellSumMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">cell</span><span class="o">,</span> <span class="n">sumMap</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">updateRelevantCells</span><span class="o">(</span><span class="n">cellName</span><span class="o">,</span> <span class="n">difference</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">get</span><span class="o">(</span><span class="kt">int</span> <span class="n">r</span><span class="o">,</span> <span class="kt">char</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">cells</span><span class="o">[</span><span class="n">r</span><span class="o">][</span><span class="n">c</span> <span class="o">-</span> <span class="sc">'A'</span><span class="o">];</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">sum</span><span class="o">(</span><span class="kt">int</span> <span class="n">r</span><span class="o">,</span> <span class="kt">char</span> <span class="n">c</span><span class="o">,</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">strs</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">prevValue</span> <span class="o">=</span> <span class="n">cells</span><span class="o">[</span><span class="n">r</span><span class="o">][</span><span class="n">c</span> <span class="o">-</span> <span class="sc">'A'</span><span class="o">];</span>
        <span class="n">set</span><span class="o">(</span><span class="n">r</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">prevValue</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">sumCellName</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">c</span><span class="o">)</span> <span class="o">+</span> <span class="n">r</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">str</span> <span class="o">:</span> <span class="n">strs</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="sc">':'</span><span class="o">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">String</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">":"</span><span class="o">);</span>
                <span class="nc">String</span> <span class="n">start</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">end</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
                <span class="kt">char</span> <span class="n">startColumn</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="n">endColumn</span> <span class="o">=</span> <span class="n">end</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
                <span class="kt">int</span> <span class="n">startRow</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">start</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">)),</span> <span class="n">endRow</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">end</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">startRow</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">endRow</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">j</span> <span class="o">=</span> <span class="n">startColumn</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">endColumn</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                        <span class="nc">String</span> <span class="n">cellName</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">j</span><span class="o">)</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
                        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">sumMap</span> <span class="o">=</span> <span class="n">cellSumMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">cellName</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;());</span>
                        <span class="kt">int</span> <span class="n">sumCount</span> <span class="o">=</span> <span class="n">sumMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
                        <span class="n">sumMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="n">sumCount</span><span class="o">);</span>
                        <span class="n">cellSumMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">cellName</span><span class="o">,</span> <span class="n">sumMap</span><span class="o">);</span>
                        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">cellMap</span> <span class="o">=</span> <span class="n">sumCellMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;());</span>
                        <span class="kt">int</span> <span class="n">cellCount</span> <span class="o">=</span> <span class="n">cellMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">cellName</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
                        <span class="n">cellMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">cellName</span><span class="o">,</span> <span class="n">cellCount</span><span class="o">);</span>
                        <span class="n">sumCellMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="n">cellMap</span><span class="o">);</span>
                        <span class="n">sum</span> <span class="o">+=</span> <span class="n">cells</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="sc">'A'</span><span class="o">];</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">sumMap</span> <span class="o">=</span> <span class="n">cellSumMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">str</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;());</span>
                <span class="kt">int</span> <span class="n">sumCount</span> <span class="o">=</span> <span class="n">sumMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
                <span class="n">sumMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="n">sumCount</span><span class="o">);</span>
                <span class="n">cellSumMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">str</span><span class="o">,</span> <span class="n">sumMap</span><span class="o">);</span>
                <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">cellMap</span> <span class="o">=</span> <span class="n">sumCellMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;());</span>
                <span class="kt">int</span> <span class="n">cellCount</span> <span class="o">=</span> <span class="n">cellMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">str</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
                <span class="n">cellMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">str</span><span class="o">,</span> <span class="n">cellCount</span><span class="o">);</span>
                <span class="n">sumCellMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="n">cellMap</span><span class="o">);</span>
                <span class="kt">char</span> <span class="n">cellColumn</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
                <span class="kt">int</span> <span class="n">cellRow</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
                <span class="n">sum</span> <span class="o">+=</span> <span class="n">cells</span><span class="o">[</span><span class="n">cellRow</span><span class="o">][</span><span class="n">cellColumn</span> <span class="o">-</span> <span class="sc">'A'</span><span class="o">];</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">difference</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">-</span> <span class="n">prevValue</span><span class="o">;</span>
        <span class="n">updateRelevantCells</span><span class="o">(</span><span class="n">sumCellName</span><span class="o">,</span> <span class="n">difference</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">cells</span><span class="o">[</span><span class="n">r</span><span class="o">][</span><span class="n">c</span> <span class="o">-</span> <span class="sc">'A'</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">updateRelevantCells</span><span class="o">(</span><span class="nc">String</span> <span class="n">cellName</span><span class="o">,</span> <span class="kt">int</span> <span class="n">difference</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Queue</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">cellQueue</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="nc">Queue</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">differenceQueue</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;();</span>
        <span class="n">cellQueue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">cellName</span><span class="o">);</span>
        <span class="n">differenceQueue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">difference</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">cellQueue</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">cellQueue</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">curDifference</span> <span class="o">=</span> <span class="n">differenceQueue</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
            <span class="kt">char</span> <span class="n">column</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">row</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">cell</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
            <span class="n">cells</span><span class="o">[</span><span class="n">row</span><span class="o">][</span><span class="n">column</span> <span class="o">-</span> <span class="sc">'A'</span><span class="o">]</span> <span class="o">+=</span> <span class="n">curDifference</span><span class="o">;</span>
            <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="n">cellSumMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">cell</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;());</span>
            <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">set</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">nextCell</span> <span class="o">:</span> <span class="n">set</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">nextCell</span><span class="o">);</span>
                <span class="n">cellQueue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">nextCell</span><span class="o">);</span>
                <span class="n">differenceQueue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">curDifference</span> <span class="o">*</span> <span class="n">count</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 * Your Excel object will be instantiated and called as such:
 * Excel obj = new Excel(H, W);
 * obj.set(r,c,v);
 * int param_2 = obj.get(r,c);
 * int param_3 = obj.sum(r,c,strs);
 */</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-python highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Excel</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">W</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">grid</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">H</span><span class="p">)]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">formula</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">formula</span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">formula</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">formula</span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span><span class="p">)][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">grid</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">65</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strs</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">':'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">cells</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">64</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">':'</span><span class="p">)</span>
                <span class="n">r1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="nb">ord</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">64</span>
                <span class="n">r2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="nb">ord</span><span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">64</span>
                <span class="n">cells</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">64</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">formula</span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="n">cells</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">formula</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">cells</span> <span class="o">=</span> <span class="n">formula</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cells</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">formula</span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">formula</span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">value</span>

<span class="c1">##############
</span>
<span class="k">class</span> <span class="nc">Excel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
    <span class="s">"""
    :type H: int
    :type W: str
    """</span>
    <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">decodeCoord</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">formulas</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="k">def</span> <span class="nf">decodeCoord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

  <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="s">"""
    :type r: int
    :type c: str
    :type v: int
    :rtype: void
    """</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">decodeCoord</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">formulas</span><span class="p">:</span>
      <span class="k">del</span> <span class="bp">self</span><span class="p">.</span><span class="n">formulas</span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

  <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="s">"""
    :type r: int
    :type c: str
    :rtype: int
    """</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">decodeCoord</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">formulas</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">computeFormula</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">formulas</span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)])</span>
    <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">computeFormula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strs</span><span class="p">):</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strs</span><span class="p">:</span>
      <span class="n">startI</span><span class="p">,</span> <span class="n">startJ</span><span class="p">,</span> <span class="n">endI</span><span class="p">,</span> <span class="n">endJ</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">parseRange</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">startI</span><span class="p">,</span> <span class="n">endI</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">startJ</span><span class="p">,</span> <span class="n">endJ</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">formulas</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">computeFormula</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">formulas</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)])</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ans</span>

  <span class="k">def</span> <span class="nf">parseRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">end</span> <span class="o">=</span> <span class="n">s</span>
    <span class="k">if</span> <span class="s">":"</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
      <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">":"</span><span class="p">)</span>
    <span class="n">startI</span><span class="p">,</span> <span class="n">startJ</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">decodeCoord</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">endI</span><span class="p">,</span> <span class="n">endJ</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">decodeCoord</span><span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">startI</span><span class="p">,</span> <span class="n">startJ</span><span class="p">,</span> <span class="n">endI</span><span class="p">,</span> <span class="n">endJ</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">strs</span><span class="p">):</span>
    <span class="s">"""
    :type r: int
    :type c: str
    :type strs: List[str]
    :rtype: int
    """</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">decodeCoord</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">formulas</span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span> <span class="o">=</span> <span class="n">strs</span>
    <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">computeFormula</span><span class="p">(</span><span class="n">strs</span><span class="p">)</span>

<span class="c1"># Your Excel object will be instantiated and called as such:
# obj = Excel(H, W)
# obj.set(r,c,v)
# param_2 = obj.get(r,c)
# param_3 = obj.sum(r,c,strs)
</span>
</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-631.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
