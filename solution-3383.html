<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-3383.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-3383.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>3383 - Minimum Runes to Add to Cast Spell</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 3383. Minimum Runes to Add to Cast Spell ð Description Alice has just graduated from wizard school, and wishes to cast a magic spell to celebrate. The magic spell contains certain focus points where magic needs to be concentrated, and some of these focus points...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-3383.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-3383.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-3383.html" rel="stylesheet"/>
   <link href="solution-3383.html" rel="stylesheet"/>
   <link href="solution-3383.html" rel="stylesheet"/>
   <link href="solution-3383.html" rel="stylesheet"/>
   <link href="solution-3383.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="3383 - Minimum Runes to Add to Cast Spell" property="og:title"/>
   <meta content="Leetcode 3383. Minimum Runes to Add to Cast Spell ð Description Alice has just graduated from wizard school, and wishes to cast a magic spell to celebrate. The magic spell contains certain focus points where magic needs to be concentrated, and some of these focus points contain magic crystals which serve as the spell&amp;#39;s energy source. Focus points can be linked through directed runes, which channel magic flow from one focus point to another. You are given a integer n denoting the number of focus points and an array of integers crystals where crystals[i] indicates a focus point which holds a magic crystal. You are also given two integer arrays flowFrom and flowTo, which represent the existing directed runes. The ith rune allows magic to freely flow from focus point flowFrom[i] to focus point flowTo[i]. You need to find the number of directed runes Alice must add to her spell, such that each focus point either: Contains a magic crystal. Receives magic flow from another focus point. Return the minimum number of directed runes that she should add. &amp;nbsp; Example 1: Input: n = 6, crystals = [0], flowFrom = [0,1,2,3], flowTo = [1,2,3,0] Output: 2 Explanation:&amp;nbsp; Add two directed runes: From focus point&amp;nbsp;0 to focus point&amp;nbsp;4. From focus point 0 to focus point 5. Example 2: Input: n = 7, crystals = [3,5], flowFrom = [0,1,2,3,5], flowTo = [1,2,0,4,6] Output: 1 Explanation:&amp;nbsp; Add a directed rune from focus point 4 to focus point 2. &amp;nbsp; Constraints: 2 &amp;lt;= n &amp;lt;= 105 1 &amp;lt;= crystals.length &amp;lt;= n 0 &amp;lt;= crystals[i] &amp;lt;= n - 1 1 &amp;lt;= flowFrom.length == flowTo.length &amp;lt;= min(2 * 105, (n * (n - 1)) / 2) 0 &amp;lt;= flowFrom[i], flowTo[i] &amp;lt;= n - 1 flowFrom[i] != flowTo[i] All pre-existing directed runes are distinct. Solutions Solution 1 Java C++ Python Go TypeScript class Solution { private int[] vis; private List&amp;lt;Integer&amp;gt;[] g; private List&amp;lt;Integer&amp;gt; seq = new ArrayList&amp;lt;&amp;gt;(); public int minRunesToAdd(int n, int[] crystals, int[] flowFrom, int[] flowTo) { g = new List[n]; Arrays.setAll(g, i -&amp;gt; new ArrayList&amp;lt;&amp;gt;()); for (int i = 0; i &amp;lt; flowFrom.length; ++i) { g[flowFrom[i]].add(flowTo[i]); } Deque&amp;lt;Integer&amp;gt; q = new ArrayDeque&amp;lt;&amp;gt;(); vis = new int[n]; for (int i : crystals) { vis[i] = 1; q.offer(i); } bfs(q); for (int i = 0; i &amp;lt; n; ++i) { if (vis[i] == 0) { dfs(i); } } int ans = 0; for (int i = seq.size() - 1; i &amp;gt;= 0; --i) { int a = seq.get(i); if (vis[a] == 2) { vis[a] = 1; q.clear(); q.offer(a); bfs(q); ++ans; } } return ans; } private void bfs(Deque&amp;lt;Integer&amp;gt; q) { while (!q.isEmpty()) { int a = q.poll(); for (int b : g[a]) { if (vis[b] == 1) { continue; } vis[b] = 1; q.offer(b); } } } private void dfs(int a) { vis[a] = 2; for (int b : g[a]) { if (vis[b] &amp;gt; 0) { continue; } dfs(b); } seq.add(a); } } class Solution { public: vector&amp;lt;int&amp;gt; vis; vector&amp;lt;vector&amp;lt;int&amp;gt;&amp;gt; g; vector&amp;lt;int&amp;gt; seq;..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2024-12-27T00:00:00-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2024-12-27-3383-Minimum-Runes-to-Add-to-Cast-Spell/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-3383.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="3383 - Minimum Runes to Add to Cast Spell" property="twitter:title"/>
   <meta content="Leetcode 3383. Minimum Runes to Add to Cast Spell ð Description Alice has just graduated from wizard school, and wishes to cast a magic spell to celebrate. The magic spell contains certain focus points where magic needs to be concentrated, and some of these focus points contain magic crystals which serve as the spell&amp;#39;s energy source. Focus points can be linked through directed runes, which channel magic flow from one focus point to another. You are given a integer n denoting the number of focus points and an array of integers crystals where crystals[i] indicates a focus point which holds a magic crystal. You are also given two integer arrays flowFrom and flowTo, which represent the existing directed runes. The ith rune allows magic to freely flow from focus point flowFrom[i] to focus point flowTo[i]. You need to find the number of directed runes Alice must add to her spell, such that each focus point either: Contains a magic crystal. Receives magic flow from another focus point. Return the minimum number of directed runes that she should add. &amp;nbsp; Example 1: Input: n = 6, crystals = [0], flowFrom = [0,1,2,3], flowTo = [1,2,3,0] Output: 2 Explanation:&amp;nbsp; Add two directed runes: From focus point&amp;nbsp;0 to focus point&amp;nbsp;4. From focus point 0 to focus point 5. Example 2: Input: n = 7, crystals = [3,5], flowFrom = [0,1,2,3,5], flowTo = [1,2,0,4,6] Output: 1 Explanation:&amp;nbsp; Add a directed rune from focus point 4 to focus point 2. &amp;nbsp; Constraints: 2 &amp;lt;= n &amp;lt;= 105 1 &amp;lt;= crystals.length &amp;lt;= n 0 &amp;lt;= crystals[i] &amp;lt;= n - 1 1 &amp;lt;= flowFrom.length == flowTo.length &amp;lt;= min(2 * 105, (n * (n - 1)) / 2) 0 &amp;lt;= flowFrom[i], flowTo[i] &amp;lt;= n - 1 flowFrom[i] != flowTo[i] All pre-existing directed runes are distinct. Solutions Solution 1 Java C++ Python Go TypeScript class Solution { private int[] vis; private List&amp;lt;Integer&amp;gt;[] g; private List&amp;lt;Integer&amp;gt; seq = new ArrayList&amp;lt;&amp;gt;(); public int minRunesToAdd(int n, int[] crystals, int[] flowFrom, int[] flowTo) { g = new List[n]; Arrays.setAll(g, i -&amp;gt; new ArrayList&amp;lt;&amp;gt;()); for (int i = 0; i &amp;lt; flowFrom.length; ++i) { g[flowFrom[i]].add(flowTo[i]); } Deque&amp;lt;Integer&amp;gt; q = new ArrayDeque&amp;lt;&amp;gt;(); vis = new int[n]; for (int i : crystals) { vis[i] = 1; q.offer(i); } bfs(q); for (int i = 0; i &amp;lt; n; ++i) { if (vis[i] == 0) { dfs(i); } } int ans = 0; for (int i = seq.size() - 1; i &amp;gt;= 0; --i) { int a = seq.get(i); if (vis[a] == 2) { vis[a] = 1; q.clear(); q.offer(a); bfs(q); ++ans; } } return ans; } private void bfs(Deque&amp;lt;Integer&amp;gt; q) { while (!q.isEmpty()) { int a = q.poll(); for (int b : g[a]) { if (vis[b] == 1) { continue; } vis[b] = 1; q.offer(b); } } } private void dfs(int a) { vis[a] = 2; for (int b : g[a]) { if (vis[b] &amp;gt; 0) { continue; } dfs(b); } seq.add(a); } } class Solution { public: vector&amp;lt;int&amp;gt; vis; vector&amp;lt;vector&amp;lt;int&amp;gt;&amp;gt; g; vector&amp;lt;int&amp;gt; seq;..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    3383 - Minimum Runes to Add to Cast Spell | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="3383 - Minimum Runes to Add to Cast Spell" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-3383.html" rel="canonical">
          <meta content="https://leetcode.ca/2024-12-27-3383-Minimum-Runes-to-Add-to-Cast-Spell/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2024-12-27T00:00:00-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"3383 - Minimum Runes to Add to Cast Spell","dateModified":"2024-12-27T00:00:00-08:00","datePublished":"2024-12-27T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2024-12-27-3383-Minimum-Runes-to-Add-to-Cast-Spell/"},"url":"https://leetcode.ca/2024-12-27-3383-Minimum-Runes-to-Add-to-Cast-Spell/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <!-- problem:start -->
      <h1 id="3383-minimum-runes-to-add-to-cast-spell-">
       <a href="solution-3383.html">
        3383. Minimum Runes to Add to Cast Spell ð
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <!-- description:start -->
      <p>
       Alice has just graduated from wizard school, and wishes to cast a magic spell to celebrate. The magic spell contains certain
       <strong>
        focus points
       </strong>
       where magic needs to be concentrated, and some of these focus points contain
       <strong>
        magic crystals
       </strong>
       which serve as the spell's energy source. Focus points can be linked through
       <strong>
        directed runes
       </strong>
       , which channel magic flow from one focus point to another.
      </p>
      <p>
       You are given a integer
       <code>
        n
       </code>
       denoting the
       <em>
        number
       </em>
       of focus points and an array of integers
       <code>
        crystals
       </code>
       where
       <code>
        crystals[i]
       </code>
       indicates a focus point which holds a magic crystal. You are also given two integer arrays
       <code>
        flowFrom
       </code>
       and
       <code>
        flowTo
       </code>
       , which represent the existing
       <strong>
        directed runes
       </strong>
       . The
       <code>
        i
        <sup>
         th
        </sup>
       </code>
       rune allows magic to freely flow from focus point
       <code>
        flowFrom[i]
       </code>
       to focus point
       <code>
        flowTo[i]
       </code>
       .
      </p>
      <p>
       You need to find the number of directed runes Alice must add to her spell, such that
       <em>
        each
       </em>
       focus point either:
      </p>
      <ul>
       <li>
        <strong>
         Contains
        </strong>
        a magic crystal.
       </li>
       <li>
        <strong>
         Receives
        </strong>
        magic flow
        <em>
         from
        </em>
        another focus point.
       </li>
      </ul>
      <p>
       Return the
       <strong>
        minimum
       </strong>
       number of directed runes that she should add.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <div class="example-block">
       <p>
        <strong>
         Input:
        </strong>
        <span class="example-io">
         n = 6, crystals = [0], flowFrom = [0,1,2,3], flowTo = [1,2,3,0]
        </span>
       </p>
       <p>
        <strong>
         Output:
        </strong>
        <span class="example-io">
         2
        </span>
       </p>
       <p>
        <strong>
         Explanation:
        </strong>
       </p>
       <p>
        <img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/3300-3399/3383.Minimum%20Runes%20to%20Add%20to%20Cast%20Spell/images/runesexample0.png" style="width: 250px; height: 252px;"/>
       </p>
       <p>
        Add two directed runes:
       </p>
       <ul>
        <li>
         From focus point 0 to focus point 4.
        </li>
        <li>
         From focus point 0 to focus point 5.
        </li>
       </ul>
      </div>
      <p>
       <strong class="example">
        Example 2:
       </strong>
      </p>
      <div class="example-block">
       <p>
        <strong>
         Input:
        </strong>
        <span class="example-io">
         n = 7, crystals = [3,5], flowFrom = [0,1,2,3,5], flowTo = [1,2,0,4,6]
        </span>
       </p>
       <p>
        <strong>
         Output:
        </strong>
        <span class="example-io">
         1
        </span>
       </p>
       <p>
        <strong>
         Explanation:
        </strong>
       </p>
       <p>
        <img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/3300-3399/3383.Minimum%20Runes%20to%20Add%20to%20Cast%20Spell/images/runesexample1.png" style="width: 250px; height: 250px;"/>
       </p>
       <p>
        Add a directed rune from focus point 4 to focus point 2.
       </p>
      </div>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         2 &lt;= n &lt;= 10
         <sup>
          5
         </sup>
        </code>
       </li>
       <li>
        <code>
         1 &lt;= crystals.length &lt;= n
        </code>
       </li>
       <li>
        <code>
         0 &lt;= crystals[i] &lt;= n - 1
        </code>
       </li>
       <li>
        <code>
         1 &lt;= flowFrom.length == flowTo.length &lt;= min(2 * 10
         <sup>
          5
         </sup>
         , (n * (n - 1)) / 2)
        </code>
       </li>
       <li>
        <code>
         0 &lt;= flowFrom[i], flowTo[i] &lt;= n - 1
        </code>
       </li>
       <li>
        <code>
         flowFrom[i] != flowTo[i]
        </code>
       </li>
       <li>
        All pre-existing directed runes are
        <strong>
         distinct
        </strong>
        .
       </li>
      </ul>
      <!-- description:end -->
      <h2 id="solutions">
       Solutions
      </h2>
      <!-- solution:start -->
      <h3 id="solution-1">
       Solution 1
      </h3>
      <ul class="uk-tab" data-uk-switcher="{connect:'#5460aa69-db9a-4c0e-b5c5-722c2d9b20f3'}">
       <li class="uk-active">
        <a href="solution-3383.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-3383.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-3383.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-3383.html">
         Go
        </a>
       </li>
       <li>
        <a href="solution-3383.html">
         TypeScript
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="5460aa69-db9a-4c0e-b5c5-722c2d9b20f3">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">vis</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;[]</span> <span class="n">g</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">seq</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">minRunesToAdd</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">crystals</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">flowFrom</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">flowTo</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">g</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">List</span><span class="o">[</span><span class="n">n</span><span class="o">];</span>
        <span class="nc">Arrays</span><span class="o">.</span><span class="na">setAll</span><span class="o">(</span><span class="n">g</span><span class="o">,</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;());</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">flowFrom</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">g</span><span class="o">[</span><span class="n">flowFrom</span><span class="o">[</span><span class="n">i</span><span class="o">]].</span><span class="na">add</span><span class="o">(</span><span class="n">flowTo</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
        <span class="o">}</span>
        <span class="nc">Deque</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">q</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayDeque</span><span class="o">&lt;&gt;();</span>
        <span class="n">vis</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">n</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">:</span> <span class="n">crystals</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">vis</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
            <span class="n">q</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">bfs</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">vis</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">dfs</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">;</span> <span class="o">--</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">vis</span><span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">vis</span><span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
                <span class="n">q</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
                <span class="n">q</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
                <span class="n">bfs</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
                <span class="o">++</span><span class="n">ans</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">bfs</span><span class="o">(</span><span class="nc">Deque</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">q</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">q</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">b</span> <span class="o">:</span> <span class="n">g</span><span class="o">[</span><span class="n">a</span><span class="o">])</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">vis</span><span class="o">[</span><span class="n">b</span><span class="o">]</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">continue</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="n">vis</span><span class="o">[</span><span class="n">b</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
                <span class="n">q</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">dfs</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">vis</span><span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">b</span> <span class="o">:</span> <span class="n">g</span><span class="o">[</span><span class="n">a</span><span class="o">])</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">vis</span><span class="o">[</span><span class="n">b</span><span class="o">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">dfs</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">seq</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">;</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">;</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">seq</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">minRunesToAdd</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">crystals</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">flowFrom</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">flowTo</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">g</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">flowFrom</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">g</span><span class="p">[</span><span class="n">flowFrom</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">push_back</span><span class="p">(</span><span class="n">flowTo</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>

        <span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
        <span class="n">vis</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">:</span> <span class="n">crystals</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">bfs</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">seq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">vis</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
                <span class="n">bfs</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
                <span class="o">++</span><span class="n">ans</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>

<span class="nl">private:</span>
    <span class="kt">void</span> <span class="n">bfs</span><span class="p">(</span><span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">q</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
            <span class="n">q</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">b</span> <span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">vis</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">b</span> <span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">seq</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">minRunesToAdd</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">crystals</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">flowFrom</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">flowTo</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">bfs</span><span class="p">(</span><span class="n">q</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
            <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">popleft</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">q</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">vis</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">seq</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">flowFrom</span><span class="p">,</span> <span class="n">flowTo</span><span class="p">):</span>
            <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

        <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">crystals</span><span class="p">)</span>
        <span class="n">vis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">crystals</span><span class="p">:</span>
            <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">bfs</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

        <span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">seq</span><span class="p">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">i</span><span class="p">])</span>
                <span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">bfs</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
                <span class="n">ans</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ans</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">func</span> <span class="n">minRunesToAdd</span><span class="p">(</span><span class="n">n</span> <span class="kt">int</span><span class="p">,</span> <span class="n">crystals</span> <span class="p">[]</span><span class="kt">int</span><span class="p">,</span> <span class="n">flowFrom</span> <span class="p">[]</span><span class="kt">int</span><span class="p">,</span> <span class="n">flowTo</span> <span class="p">[]</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">ans</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">g</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([][]</span><span class="kt">int</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">flowFrom</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">flowFrom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">flowTo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		<span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">b</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">vis</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">x</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">crystals</span> <span class="p">{</span>
		<span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="m">1</span>
	<span class="p">}</span>

	<span class="n">bfs</span> <span class="o">:=</span> <span class="k">func</span><span class="p">(</span><span class="n">q</span> <span class="p">[]</span><span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="p">{</span>
			<span class="n">a</span> <span class="o">:=</span> <span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">]</span>
			<span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="p">{</span>
				<span class="k">if</span> <span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="m">1</span> <span class="p">{</span>
					<span class="k">continue</span>
				<span class="p">}</span>
				<span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="m">1</span>
				<span class="n">q</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">seq</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{}</span>
	<span class="k">var</span> <span class="n">dfs</span> <span class="k">func</span><span class="p">(</span><span class="n">a</span> <span class="kt">int</span><span class="p">)</span>
	<span class="n">dfs</span> <span class="o">=</span> <span class="k">func</span><span class="p">(</span><span class="n">a</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">vis</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="m">2</span>
		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="p">{</span>
			<span class="k">if</span> <span class="n">vis</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="p">{</span>
				<span class="k">continue</span>
			<span class="p">}</span>
			<span class="n">dfs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
		<span class="p">}</span>
		<span class="n">seq</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">q</span> <span class="o">:=</span> <span class="n">crystals</span>
	<span class="n">bfs</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="k">if</span> <span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="m">0</span> <span class="p">{</span>
			<span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">:=</span> <span class="m">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="m">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="m">1</span> <span class="p">{</span>
		<span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">seq</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">seq</span> <span class="p">{</span>
		<span class="k">if</span> <span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="m">2</span> <span class="p">{</span>
			<span class="n">q</span> <span class="o">=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="n">i</span><span class="p">}</span>
			<span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="m">1</span>
			<span class="n">bfs</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
			<span class="n">ans</span><span class="o">++</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span>
<span class="p">}</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-ts highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">function</span> <span class="nx">minRunesToAdd</span><span class="p">(</span>
    <span class="nx">n</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
    <span class="nx">crystals</span><span class="p">:</span> <span class="kr">number</span><span class="p">[],</span>
    <span class="nx">flowFrom</span><span class="p">:</span> <span class="kr">number</span><span class="p">[],</span>
    <span class="nx">flowTo</span><span class="p">:</span> <span class="kr">number</span><span class="p">[],</span>
<span class="p">):</span> <span class="kr">number</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">g</span><span class="p">:</span> <span class="kr">number</span><span class="p">[][]</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">({</span> <span class="na">length</span><span class="p">:</span> <span class="nx">n</span> <span class="p">},</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">[]);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">flowFrom</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">flowFrom</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span>
            <span class="nx">b</span> <span class="o">=</span> <span class="nx">flowTo</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">g</span><span class="p">[</span><span class="nx">a</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">vis</span><span class="p">:</span> <span class="kr">number</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">n</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">x</span> <span class="k">of</span> <span class="nx">crystals</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vis</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">bfs</span> <span class="o">=</span> <span class="p">(</span><span class="nx">q</span><span class="p">:</span> <span class="kr">number</span><span class="p">[])</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">q</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span><span class="o">!</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">b</span> <span class="k">of</span> <span class="nx">g</span><span class="p">[</span><span class="nx">a</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">vis</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="nx">vis</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="nx">q</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">seq</span><span class="p">:</span> <span class="kr">number</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">dfs</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">vis</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">b</span> <span class="k">of</span> <span class="nx">g</span><span class="p">[</span><span class="nx">a</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">vis</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="nx">dfs</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">seq</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="nx">bfs</span><span class="p">(</span><span class="nx">crystals</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">vis</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">dfs</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">seq</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>

    <span class="kd">let</span> <span class="nx">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">i</span> <span class="k">of</span> <span class="nx">seq</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">vis</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">bfs</span><span class="p">([</span><span class="nx">i</span><span class="p">]);</span>
            <span class="nx">vis</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">ans</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">ans</span><span class="p">;</span>
<span class="p">}</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-3383.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
