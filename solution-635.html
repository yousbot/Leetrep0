<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-635.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-635.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>635 - Design Log Storage System</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 635. Design Log Storage System Description You are given several logs, where each log contains a unique ID and timestamp. Timestamp is a string that has the following format: Year:Month:Day:Hour:Minute:Second, for example, 2017:01:01:23:59:59. All domains are zero-padded decimal numbers. Implement the LogSystem class: LogSystem() Initializes...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-635.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-635.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-635.html" rel="stylesheet"/>
   <link href="solution-635.html" rel="stylesheet"/>
   <link href="solution-635.html" rel="stylesheet"/>
   <link href="solution-635.html" rel="stylesheet"/>
   <link href="solution-635.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="635 - Design Log Storage System" property="og:title"/>
   <meta content='Leetcode 635. Design Log Storage System Description You are given several logs, where each log contains a unique ID and timestamp. Timestamp is a string that has the following format: Year:Month:Day:Hour:Minute:Second, for example, 2017:01:01:23:59:59. All domains are zero-padded decimal numbers. Implement the LogSystem class: LogSystem() Initializes the LogSystem object. void put(int id, string timestamp) Stores the given log (id, timestamp) in your storage system. int[] retrieve(string start, string end, string granularity) Returns the IDs of the logs whose timestamps are within the range from start to end inclusive. start and end all have the same format as timestamp, and granularity means how precise the range should be (i.e. to the exact Day, Minute, etc.). For example, start = &amp;quot;2017:01:01:23:59:59&amp;quot;, end = &amp;quot;2017:01:02:23:59:59&amp;quot;, and granularity = &amp;quot;Day&amp;quot; means that we need to find the logs within the inclusive range from Jan. 1st 2017 to Jan. 2nd 2017, and the Hour, Minute, and Second for each log entry can be ignored. &amp;nbsp; Example 1: Input [&amp;quot;LogSystem&amp;quot;, &amp;quot;put&amp;quot;, &amp;quot;put&amp;quot;, &amp;quot;put&amp;quot;, &amp;quot;retrieve&amp;quot;, &amp;quot;retrieve&amp;quot;] [[], [1, &amp;quot;2017:01:01:23:59:59&amp;quot;], [2, &amp;quot;2017:01:01:22:59:59&amp;quot;], [3, &amp;quot;2016:01:01:00:00:00&amp;quot;], [&amp;quot;2016:01:01:01:01:01&amp;quot;, &amp;quot;2017:01:01:23:00:00&amp;quot;, &amp;quot;Year&amp;quot;], [&amp;quot;2016:01:01:01:01:01&amp;quot;, &amp;quot;2017:01:01:23:00:00&amp;quot;, &amp;quot;Hour&amp;quot;]] Output [null, null, null, null, [3, 2, 1], [2, 1]] Explanation LogSystem logSystem = new LogSystem(); logSystem.put(1, &amp;quot;2017:01:01:23:59:59&amp;quot;); logSystem.put(2, &amp;quot;2017:01:01:22:59:59&amp;quot;); logSystem.put(3, &amp;quot;2016:01:01:00:00:00&amp;quot;); // return [3,2,1], because you need to return all logs between 2016 and 2017. logSystem.retrieve(&amp;quot;2016:01:01:01:01:01&amp;quot;, &amp;quot;2017:01:01:23:00:00&amp;quot;, &amp;quot;Year&amp;quot;); // return [2,1], because you need to return all logs between Jan. 1, 2016 01:XX:XX and Jan. 1, 2017 23:XX:XX. // Log 3 is not returned because Jan. 1, 2016 00:00:00 comes before the start of the range. logSystem.retrieve(&amp;quot;2016:01:01:01:01:01&amp;quot;, &amp;quot;2017:01:01:23:00:00&amp;quot;, &amp;quot;Hour&amp;quot;); &amp;nbsp; Constraints: 1 &amp;lt;= id &amp;lt;= 500 2000 &amp;lt;= Year &amp;lt;= 2017 1 &amp;lt;= Month &amp;lt;= 12 1 &amp;lt;= Day &amp;lt;= 31 0 &amp;lt;= Hour &amp;lt;= 23 0 &amp;lt;= Minute, Second &amp;lt;= 59 granularity is one of the values [&amp;quot;Year&amp;quot;, &amp;quot;Month&amp;quot;, &amp;quot;Day&amp;quot;, &amp;quot;Hour&amp;quot;, &amp;quot;Minute&amp;quot;, &amp;quot;Second&amp;quot;]. At most 500 calls will be made to put and retrieve. Solutions Attributes: self.logs: A list that stores log entries, where each log entry is a tuple consisting of an id (integer) and a timestamp (string in the format YYYY:MM:DD:hh:mm:ss). self.d: A dictionary mapping granularity names ("Year", "Month", "Day", "Hour", "Minute", "Second") to the index positions in the timestamp string that correspond to the end of each granularity level. These indices help in slicing timestamps up to the required granularity. Methods: __init__(self) Initializes the log system. It sets up the logs list to store the log entries and the d dictionary to map each granularity to its respective slice index in the timestamp strings. put(self, id: int, timestamp: str) -&amp;gt; None Adds a log entry to the system. It appends a tuple containing the id and timestamp to the logs list. The id is an integer identifier for the log, and timestamp is a string representing when the log entry was made. retrieve(self, start: str, end: str, granularity: str) -&amp;gt; List[int] Retrieves all log ids with timestamps that fall within the range from start to end, inclusive, at the...' property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2017-08-26T00:00:00-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2017-08-26-635-Design-Log-Storage-System/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-635.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="635 - Design Log Storage System" property="twitter:title"/>
   <meta content='Leetcode 635. Design Log Storage System Description You are given several logs, where each log contains a unique ID and timestamp. Timestamp is a string that has the following format: Year:Month:Day:Hour:Minute:Second, for example, 2017:01:01:23:59:59. All domains are zero-padded decimal numbers. Implement the LogSystem class: LogSystem() Initializes the LogSystem object. void put(int id, string timestamp) Stores the given log (id, timestamp) in your storage system. int[] retrieve(string start, string end, string granularity) Returns the IDs of the logs whose timestamps are within the range from start to end inclusive. start and end all have the same format as timestamp, and granularity means how precise the range should be (i.e. to the exact Day, Minute, etc.). For example, start = &amp;quot;2017:01:01:23:59:59&amp;quot;, end = &amp;quot;2017:01:02:23:59:59&amp;quot;, and granularity = &amp;quot;Day&amp;quot; means that we need to find the logs within the inclusive range from Jan. 1st 2017 to Jan. 2nd 2017, and the Hour, Minute, and Second for each log entry can be ignored. &amp;nbsp; Example 1: Input [&amp;quot;LogSystem&amp;quot;, &amp;quot;put&amp;quot;, &amp;quot;put&amp;quot;, &amp;quot;put&amp;quot;, &amp;quot;retrieve&amp;quot;, &amp;quot;retrieve&amp;quot;] [[], [1, &amp;quot;2017:01:01:23:59:59&amp;quot;], [2, &amp;quot;2017:01:01:22:59:59&amp;quot;], [3, &amp;quot;2016:01:01:00:00:00&amp;quot;], [&amp;quot;2016:01:01:01:01:01&amp;quot;, &amp;quot;2017:01:01:23:00:00&amp;quot;, &amp;quot;Year&amp;quot;], [&amp;quot;2016:01:01:01:01:01&amp;quot;, &amp;quot;2017:01:01:23:00:00&amp;quot;, &amp;quot;Hour&amp;quot;]] Output [null, null, null, null, [3, 2, 1], [2, 1]] Explanation LogSystem logSystem = new LogSystem(); logSystem.put(1, &amp;quot;2017:01:01:23:59:59&amp;quot;); logSystem.put(2, &amp;quot;2017:01:01:22:59:59&amp;quot;); logSystem.put(3, &amp;quot;2016:01:01:00:00:00&amp;quot;); // return [3,2,1], because you need to return all logs between 2016 and 2017. logSystem.retrieve(&amp;quot;2016:01:01:01:01:01&amp;quot;, &amp;quot;2017:01:01:23:00:00&amp;quot;, &amp;quot;Year&amp;quot;); // return [2,1], because you need to return all logs between Jan. 1, 2016 01:XX:XX and Jan. 1, 2017 23:XX:XX. // Log 3 is not returned because Jan. 1, 2016 00:00:00 comes before the start of the range. logSystem.retrieve(&amp;quot;2016:01:01:01:01:01&amp;quot;, &amp;quot;2017:01:01:23:00:00&amp;quot;, &amp;quot;Hour&amp;quot;); &amp;nbsp; Constraints: 1 &amp;lt;= id &amp;lt;= 500 2000 &amp;lt;= Year &amp;lt;= 2017 1 &amp;lt;= Month &amp;lt;= 12 1 &amp;lt;= Day &amp;lt;= 31 0 &amp;lt;= Hour &amp;lt;= 23 0 &amp;lt;= Minute, Second &amp;lt;= 59 granularity is one of the values [&amp;quot;Year&amp;quot;, &amp;quot;Month&amp;quot;, &amp;quot;Day&amp;quot;, &amp;quot;Hour&amp;quot;, &amp;quot;Minute&amp;quot;, &amp;quot;Second&amp;quot;]. At most 500 calls will be made to put and retrieve. Solutions Attributes: self.logs: A list that stores log entries, where each log entry is a tuple consisting of an id (integer) and a timestamp (string in the format YYYY:MM:DD:hh:mm:ss). self.d: A dictionary mapping granularity names ("Year", "Month", "Day", "Hour", "Minute", "Second") to the index positions in the timestamp string that correspond to the end of each granularity level. These indices help in slicing timestamps up to the required granularity. Methods: __init__(self) Initializes the log system. It sets up the logs list to store the log entries and the d dictionary to map each granularity to its respective slice index in the timestamp strings. put(self, id: int, timestamp: str) -&amp;gt; None Adds a log entry to the system. It appends a tuple containing the id and timestamp to the logs list. The id is an integer identifier for the log, and timestamp is a string representing when the log entry was made. retrieve(self, start: str, end: str, granularity: str) -&amp;gt; List[int] Retrieves all log ids with timestamps that fall within the range from start to end, inclusive, at the...' property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    635 - Design Log Storage System | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="635 - Design Log Storage System" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-635.html" rel="canonical">
          <meta content="https://leetcode.ca/2017-08-26-635-Design-Log-Storage-System/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2017-08-26T00:00:00-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"635 - Design Log Storage System","dateModified":"2017-08-26T00:00:00-07:00","datePublished":"2017-08-26T00:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2017-08-26-635-Design-Log-Storage-System/"},"url":"https://leetcode.ca/2017-08-26-635-Design-Log-Storage-System/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="635-design-log-storage-system">
       <a href="solution-635.html">
        635. Design Log Storage System
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       You are given several logs, where each log contains a unique ID and timestamp. Timestamp is a string that has the following format:
       <code>
        Year:Month:Day:Hour:Minute:Second
       </code>
       , for example,
       <code>
        2017:01:01:23:59:59
       </code>
       . All domains are zero-padded decimal numbers.
      </p>
      <p>
       Implement the
       <code>
        LogSystem
       </code>
       class:
      </p>
      <ul>
       <li>
        <code>
         LogSystem()
        </code>
        Initializes the
        <code>
         LogSystem
        </code>
        <b>
        </b>
        object.
       </li>
       <li>
        <code>
         void put(int id, string timestamp)
        </code>
        Stores the given log
        <code>
         (id, timestamp)
        </code>
        in your storage system.
       </li>
       <li>
        <code>
         int[] retrieve(string start, string end, string granularity)
        </code>
        Returns the IDs of the logs whose timestamps are within the range from
        <code>
         start
        </code>
        to
        <code>
         end
        </code>
        inclusive.
        <code>
         start
        </code>
        and
        <code>
         end
        </code>
        all have the same format as
        <code>
         timestamp
        </code>
        , and
        <code>
         granularity
        </code>
        means how precise the range should be (i.e. to the exact
        <code>
         Day
        </code>
        ,
        <code>
         Minute
        </code>
        , etc.). For example,
        <code>
         start = "2017:01:01:23:59:59"
        </code>
        ,
        <code>
         end = "2017:01:02:23:59:59"
        </code>
        , and
        <code>
         granularity = "Day"
        </code>
        means that we need to find the logs within the inclusive range from
        <strong>
         Jan. 1st 2017
        </strong>
        to
        <strong>
         Jan. 2nd 2017
        </strong>
        , and the
        <code>
         Hour
        </code>
        ,
        <code>
         Minute
        </code>
        , and
        <code>
         Second
        </code>
        for each log entry can be ignored.
       </li>
      </ul>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input</strong>
["LogSystem", "put", "put", "put", "retrieve", "retrieve"]
[[], [1, "2017:01:01:23:59:59"], [2, "2017:01:01:22:59:59"], [3, "2016:01:01:00:00:00"], ["2016:01:01:01:01:01", "2017:01:01:23:00:00", "Year"], ["2016:01:01:01:01:01", "2017:01:01:23:00:00", "Hour"]]
<strong>Output</strong>
[null, null, null, null, [3, 2, 1], [2, 1]]

<strong>Explanation</strong>
LogSystem logSystem = new LogSystem();
logSystem.put(1, "2017:01:01:23:59:59");
logSystem.put(2, "2017:01:01:22:59:59");
logSystem.put(3, "2016:01:01:00:00:00");

// return [3,2,1], because you need to return all logs between 2016 and 2017.
logSystem.retrieve("2016:01:01:01:01:01", "2017:01:01:23:00:00", "Year");

// return [2,1], because you need to return all logs between Jan. 1, 2016 01:XX:XX and Jan. 1, 2017 23:XX:XX.
// Log 3 is not returned because Jan. 1, 2016 00:00:00 comes before the start of the range.
logSystem.retrieve("2016:01:01:01:01:01", "2017:01:01:23:00:00", "Hour");
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         1 &lt;= id &lt;= 500
        </code>
       </li>
       <li>
        <code>
         2000 &lt;= Year &lt;= 2017
        </code>
       </li>
       <li>
        <code>
         1 &lt;= Month &lt;= 12
        </code>
       </li>
       <li>
        <code>
         1 &lt;= Day &lt;= 31
        </code>
       </li>
       <li>
        <code>
         0 &lt;= Hour &lt;= 23
        </code>
       </li>
       <li>
        <code>
         0 &lt;= Minute, Second &lt;= 59
        </code>
       </li>
       <li>
        <code>
         granularity
        </code>
        is one of the values
        <code>
         ["Year", "Month", "Day", "Hour", "Minute", "Second"]
        </code>
        .
       </li>
       <li>
        At most
        <code>
         500
        </code>
        calls will be made to
        <code>
         put
        </code>
        and
        <code>
         retrieve
        </code>
        .
       </li>
      </ul>
      <h2 id="solutions">
       Solutions
      </h2>
      <h3 id="attributes">
       Attributes:
      </h3>
      <ul>
       <li>
        <code class="language-plaintext highlighter-rouge">
         self.logs
        </code>
        : A list that stores log entries, where each log entry is a tuple consisting of an
        <code class="language-plaintext highlighter-rouge">
         id
        </code>
        (integer) and a
        <code class="language-plaintext highlighter-rouge">
         timestamp
        </code>
        (string in the format
        <code class="language-plaintext highlighter-rouge">
         YYYY:MM:DD:hh:mm:ss
        </code>
        ).
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         self.d
        </code>
        : A dictionary mapping granularity names (
        <code class="language-plaintext highlighter-rouge">
         "Year"
        </code>
        ,
        <code class="language-plaintext highlighter-rouge">
         "Month"
        </code>
        ,
        <code class="language-plaintext highlighter-rouge">
         "Day"
        </code>
        ,
        <code class="language-plaintext highlighter-rouge">
         "Hour"
        </code>
        ,
        <code class="language-plaintext highlighter-rouge">
         "Minute"
        </code>
        ,
        <code class="language-plaintext highlighter-rouge">
         "Second"
        </code>
        ) to the index positions in the timestamp string that correspond to the end of each granularity level. These indices help in slicing timestamps up to the required granularity.
       </li>
      </ul>
      <h3 id="methods">
       Methods:
      </h3>
      <h4 id="__init__self">
       <code class="language-plaintext highlighter-rouge">
        __init__(self)
       </code>
      </h4>
      <ul>
       <li>
        Initializes the log system. It sets up the
        <code class="language-plaintext highlighter-rouge">
         logs
        </code>
        list to store the log entries and the
        <code class="language-plaintext highlighter-rouge">
         d
        </code>
        dictionary to map each granularity to its respective slice index in the timestamp strings.
       </li>
      </ul>
      <h4 id="putself-id-int-timestamp-str---none">
       <code class="language-plaintext highlighter-rouge">
        put(self, id: int, timestamp: str) -&gt; None
       </code>
      </h4>
      <ul>
       <li>
        Adds a log entry to the system. It appends a tuple containing the
        <code class="language-plaintext highlighter-rouge">
         id
        </code>
        and
        <code class="language-plaintext highlighter-rouge">
         timestamp
        </code>
        to the
        <code class="language-plaintext highlighter-rouge">
         logs
        </code>
        list. The
        <code class="language-plaintext highlighter-rouge">
         id
        </code>
        is an integer identifier for the log, and
        <code class="language-plaintext highlighter-rouge">
         timestamp
        </code>
        is a string representing when the log entry was made.
       </li>
      </ul>
      <h4 id="retrieveself-start-str-end-str-granularity-str---listint">
       <code class="language-plaintext highlighter-rouge">
        retrieve(self, start: str, end: str, granularity: str) -&gt; List[int]
       </code>
      </h4>
      <ul>
       <li>
        Retrieves all log
        <code class="language-plaintext highlighter-rouge">
         id
        </code>
        s with timestamps that fall within the range from
        <code class="language-plaintext highlighter-rouge">
         start
        </code>
        to
        <code class="language-plaintext highlighter-rouge">
         end
        </code>
        , inclusive, at the specified
        <code class="language-plaintext highlighter-rouge">
         granularity
        </code>
        .
       </li>
       <li>
        The method uses the
        <code class="language-plaintext highlighter-rouge">
         d
        </code>
        dictionary to find the slice index
        <code class="language-plaintext highlighter-rouge">
         i
        </code>
        corresponding to the given
        <code class="language-plaintext highlighter-rouge">
         granularity
        </code>
        . This index determines how much of the timestamp strings should be considered for comparison.
       </li>
       <li>
        It then iterates over all stored logs, comparing the sliced timestamps (
        <code class="language-plaintext highlighter-rouge">
         ts[:i]
        </code>
        ) against the sliced
        <code class="language-plaintext highlighter-rouge">
         start
        </code>
        and
        <code class="language-plaintext highlighter-rouge">
         end
        </code>
        boundaries.
       </li>
       <li>
        If a logâs timestamp falls within the range, the logâs
        <code class="language-plaintext highlighter-rouge">
         id
        </code>
        is included in the result list.
       </li>
      </ul>
      <h3 id="example-usage">
       Example Usage:
      </h3>
      <div class="language-python highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code><span class="n">obj</span> <span class="o">=</span> <span class="n">LogSystem</span><span class="p">()</span>
<span class="n">obj</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"2017:01:01:23:59:59"</span><span class="p">)</span>
<span class="n">obj</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"2017:01:02:23:59:59"</span><span class="p">)</span>

<span class="c1"># Retrieve logs within the entire year of 2017
</span><span class="n">logs</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"2017:01:01:00:00:00"</span><span class="p">,</span> <span class="s">"2017:12:31:23:59:59"</span><span class="p">,</span> <span class="s">"Year"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">logs</span><span class="p">)</span>  <span class="c1"># Output: [1, 2]
</span>
<span class="c1"># Retrieve logs from January 1, 2017
</span><span class="n">logs</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"2017:01:01:00:00:00"</span><span class="p">,</span> <span class="s">"2017:01:01:23:59:59"</span><span class="p">,</span> <span class="s">"Day"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">logs</span><span class="p">)</span>  <span class="c1"># Output: [1]
</span></code></pre>
       </div>
      </div>
      <h2 id="improve-efficiency-on-retrival">
       Improve efficiency on retrival
      </h2>
      <p>
       Using a sorted data structure to store the log entries can indeed make retrieval operations more efficient, especially when dealing with a large number of logs. Pythonâs
       <code class="language-plaintext highlighter-rouge">
        bisect
       </code>
       module can be used for efficient insertion and searching in a sorted list, but it only works well for immutable elements and doesnât directly support key-based sorting or retrieval.
      </p>
      <p>
       For a scenario that benefits from sorted data and key-based operations, a better approach might be to use a
       <code class="language-plaintext highlighter-rouge">
        TreeMap
       </code>
       in languages like Java, which Python can mimic with the
       <code class="language-plaintext highlighter-rouge">
        sortedcontainers
       </code>
       moduleâs
       <code class="language-plaintext highlighter-rouge">
        SortedDict
       </code>
       . This data structure maintains elements in sorted order and supports efficient insertion, deletion, and range query operations.
      </p>
      <h3 id="explanation">
       Explanation:
      </h3>
      <ul>
       <li>
        <strong>
         Storage:
        </strong>
        Instead of a list,
        <code class="language-plaintext highlighter-rouge">
         self.logs
        </code>
        is now a
        <code class="language-plaintext highlighter-rouge">
         SortedDict
        </code>
        , where each key is a timestamp, and the value is a list of IDs that share the same timestamp. This allows the log system to efficiently manage and query logs based on timestamps.
       </li>
       <li>
        <strong>
         Insertion (
         <code class="language-plaintext highlighter-rouge">
          put
         </code>
         method):
        </strong>
        Inserts logs into the
        <code class="language-plaintext highlighter-rouge">
         SortedDict
        </code>
        based on their timestamp. If multiple logs have the same timestamp, theyâre appended to the list at that timestamp key.
       </li>
       <li>
        <strong>
         Retrieval (
         <code class="language-plaintext highlighter-rouge">
          retrieve
         </code>
         method):
        </strong>
        To retrieve logs within a specified range and granularity, the method first adjusts the
        <code class="language-plaintext highlighter-rouge">
         start
        </code>
        and
        <code class="language-plaintext highlighter-rouge">
         end
        </code>
        according to the granularity. It then iterates over the timestamp keys within the specified range using
        <code class="language-plaintext highlighter-rouge">
         SortedDict
        </code>
        âs
        <code class="language-plaintext highlighter-rouge">
         irange
        </code>
        method, which efficiently finds the keys within the given range. The method accumulates the IDs of the logs that fall within the adjusted
        <code class="language-plaintext highlighter-rouge">
         start
        </code>
        and
        <code class="language-plaintext highlighter-rouge">
         end
        </code>
        range.
       </li>
      </ul>
      <h3 id="advantages">
       Advantages:
      </h3>
      <ul>
       <li>
        <strong>
         Efficiency:
        </strong>
        By maintaining the logs in a sorted order, the
        <code class="language-plaintext highlighter-rouge">
         retrieve
        </code>
        method becomes more efficient, especially for range queries, as it avoids scanning logs that fall outside the desired timestamp range.
       </li>
       <li>
        <strong>
         Flexibility:
        </strong>
        The use of
        <code class="language-plaintext highlighter-rouge">
         SortedDict
        </code>
        allows for efficient queries not only based on exact timestamp matches but also for range-based retrievals, making the system more versatile.
       </li>
      </ul>
      <p>
       This approach optimizes the retrieval operation by leveraging the sorted nature of the logs, which is particularly beneficial as the number of logs grows.
      </p>
      <h1 id="irange-in-sorteddict">
       irange() in SortedDict
      </h1>
      <p>
       <code class="language-plaintext highlighter-rouge">
        irange()
       </code>
       is a method associated with the
       <code class="language-plaintext highlighter-rouge">
        SortedDict
       </code>
       object from the
       <code class="language-plaintext highlighter-rouge">
        sortedcontainers
       </code>
       module in Python, not part of Pythonâs standard library. The
       <code class="language-plaintext highlighter-rouge">
        sortedcontainers
       </code>
       module provides
       <code class="language-plaintext highlighter-rouge">
        SortedDict
       </code>
       ,
       <code class="language-plaintext highlighter-rouge">
        SortedSet
       </code>
       , and
       <code class="language-plaintext highlighter-rouge">
        SortedList
       </code>
       collections that maintain their elements in sorted order. The
       <code class="language-plaintext highlighter-rouge">
        irange()
       </code>
       method of a
       <code class="language-plaintext highlighter-rouge">
        SortedDict
       </code>
       object is particularly useful for iterating over a range of keys in sorted order.
      </p>
      <p>
       Hereâs how you can use the
       <code class="language-plaintext highlighter-rouge">
        irange()
       </code>
       method with a
       <code class="language-plaintext highlighter-rouge">
        SortedDict
       </code>
       :
      </p>
      <h3 id="installation-of-sortedcontainers">
       Installation of
       <code class="language-plaintext highlighter-rouge">
        sortedcontainers
       </code>
      </h3>
      <p>
       First, ensure you have the
       <code class="language-plaintext highlighter-rouge">
        sortedcontainers
       </code>
       module installed. If not, you can install it using pip:
      </p>
      <div class="language-bash highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code>pip <span class="nb">install </span>sortedcontainers
</code></pre>
       </div>
      </div>
      <h3 id="example-usage-of-irange">
       Example Usage of
       <code class="language-plaintext highlighter-rouge">
        irange()
       </code>
      </h3>
      <div class="language-python highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code><span class="kn">from</span> <span class="nn">sortedcontainers</span> <span class="kn">import</span> <span class="n">SortedDict</span>

<span class="c1"># Creating a SortedDict object
</span><span class="n">sd</span> <span class="o">=</span> <span class="n">SortedDict</span><span class="p">({</span><span class="s">'apple'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'banana'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">'cherry'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">'date'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s">'elderberry'</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

<span class="c1"># Iterating over a range of keys using irange()
# This will include the start key 'banana' and exclude the stop key 'elderberry'
</span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sd</span><span class="p">.</span><span class="n">irange</span><span class="p">(</span><span class="s">'banana'</span><span class="p">,</span> <span class="s">'elderberry'</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">)):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">sd</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre>
       </div>
      </div>
      <h3 id="output">
       Output
      </h3>
      <div class="language-plaintext highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code>banana: 3
cherry: 5
date: 7
</code></pre>
       </div>
      </div>
      <h3 id="explanation-1">
       Explanation
      </h3>
      <ul>
       <li>
        <p>
         <code class="language-plaintext highlighter-rouge">
          SortedDict
         </code>
         : A dictionary that maintains its keys in sorted order, which is useful for efficiently performing range queries and maintaining sorted data.
        </p>
       </li>
       <li>
        <p>
         <code class="language-plaintext highlighter-rouge">
          irange(start_key, stop_key, inclusive=(True, True))
         </code>
         : Iterates over the keys of the
         <code class="language-plaintext highlighter-rouge">
          SortedDict
         </code>
         starting with
         <code class="language-plaintext highlighter-rouge">
          start_key
         </code>
         and ending with
         <code class="language-plaintext highlighter-rouge">
          stop_key
         </code>
         . The
         <code class="language-plaintext highlighter-rouge">
          inclusive
         </code>
         parameter is a tuple indicating whether the start and stop keys should be included in the range. By default, both are set to
         <code class="language-plaintext highlighter-rouge">
          True
         </code>
         , meaning both
         <code class="language-plaintext highlighter-rouge">
          start_key
         </code>
         and
         <code class="language-plaintext highlighter-rouge">
          stop_key
         </code>
         are included. In the example above,
         <code class="language-plaintext highlighter-rouge">
          inclusive=(True, False)
         </code>
         means that the range includes
         <code class="language-plaintext highlighter-rouge">
          banana
         </code>
         but excludes
         <code class="language-plaintext highlighter-rouge">
          elderberry
         </code>
         .
        </p>
       </li>
      </ul>
      <p>
       <code class="language-plaintext highlighter-rouge">
        irange()
       </code>
       is valuable for scenarios where you need to iterate over a subset of keys within a certain range in a dictionary thatâs maintained in sorted order. This method combines the convenience of dictionary key-value access with the efficiency of sorted data structures for range queries.
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#0ee3bdad-71c1-4191-906a-68ee17ffe03f'}">
       <li class="uk-active">
        <a href="solution-635.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-635.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-635.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-635.html">
         Go
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="0ee3bdad-71c1-4191-906a-68ee17ffe03f">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">LogSystem</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Log</span><span class="o">&gt;</span> <span class="n">logs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">LogSystem</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">d</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Year"</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="n">d</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Month"</span><span class="o">,</span> <span class="mi">7</span><span class="o">);</span>
        <span class="n">d</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Day"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
        <span class="n">d</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Hour"</span><span class="o">,</span> <span class="mi">13</span><span class="o">);</span>
        <span class="n">d</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Minute"</span><span class="o">,</span> <span class="mi">16</span><span class="o">);</span>
        <span class="n">d</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Second"</span><span class="o">,</span> <span class="mi">19</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">put</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">timestamp</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Log</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">timestamp</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="nf">retrieve</span><span class="o">(</span><span class="nc">String</span> <span class="n">start</span><span class="o">,</span> <span class="nc">String</span> <span class="n">end</span><span class="o">,</span> <span class="nc">String</span> <span class="n">granularity</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">ans</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">granularity</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">i</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">e</span> <span class="o">=</span> <span class="n">end</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">i</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">var</span> <span class="n">log</span> <span class="o">:</span> <span class="n">logs</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">t</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="na">ts</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">i</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">t</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">e</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">ans</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">log</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Log</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">ts</span><span class="o">;</span>

    <span class="nc">Log</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">ts</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 * Your LogSystem object will be instantiated and called as such:
 * LogSystem obj = new LogSystem();
 * obj.put(id,timestamp);
 * List&lt;Integer&gt; param_2 = obj.retrieve(start,end,granularity);
 */</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">LogSystem</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">LogSystem</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">d</span><span class="p">[</span><span class="s">"Year"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
        <span class="n">d</span><span class="p">[</span><span class="s">"Month"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
        <span class="n">d</span><span class="p">[</span><span class="s">"Day"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
        <span class="n">d</span><span class="p">[</span><span class="s">"Hour"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">13</span><span class="p">;</span>
        <span class="n">d</span><span class="p">[</span><span class="s">"Minute"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
        <span class="n">d</span><span class="p">[</span><span class="s">"Second"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">put</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">,</span> <span class="n">string</span> <span class="n">timestamp</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">logs</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">id</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">retrieve</span><span class="p">(</span><span class="n">string</span> <span class="n">start</span><span class="p">,</span> <span class="n">string</span> <span class="n">end</span><span class="p">,</span> <span class="n">string</span> <span class="n">granularity</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">granularity</span><span class="p">];</span>
        <span class="k">auto</span> <span class="n">s</span> <span class="o">=</span> <span class="n">start</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
        <span class="k">auto</span> <span class="n">e</span> <span class="o">=</span> <span class="n">end</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span> <span class="p">[</span><span class="n">id</span><span class="p">,</span> <span class="n">ts</span><span class="p">]</span> <span class="o">:</span> <span class="n">logs</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">auto</span> <span class="n">t</span> <span class="o">=</span> <span class="n">ts</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&amp;&amp;</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">ans</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>

<span class="nl">private:</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">string</span><span class="o">&gt;&gt;</span> <span class="n">logs</span><span class="p">;</span>
    <span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**
 * Your LogSystem object will be instantiated and called as such:
 * LogSystem* obj = new LogSystem();
 * obj-&gt;put(id,timestamp);
 * vector&lt;int&gt; param_2 = obj-&gt;retrieve(start,end,granularity);
 */</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">LogSystem</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"Year"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s">"Month"</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s">"Day"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s">"Hour"</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
            <span class="s">"Minute"</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
            <span class="s">"Second"</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logs</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="nb">id</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">granularity</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">d</span><span class="p">[</span><span class="n">granularity</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">id</span> <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">logs</span> <span class="k">if</span> <span class="n">start</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">ts</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">[:</span><span class="n">i</span><span class="p">]]</span>


<span class="c1"># Your LogSystem object will be instantiated and called as such:
# obj = LogSystem()
# obj.put(id,timestamp)
# param_2 = obj.retrieve(start,end,granularity)
</span>

<span class="c1">############
</span>
<span class="c1"># pip install sortedcontainers
</span><span class="kn">from</span> <span class="nn">sortedcontainers</span> <span class="kn">import</span> <span class="n">SortedDict</span>

<span class="c1"># optimized, sorted
</span><span class="k">class</span> <span class="nc">LogSystem</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logs</span> <span class="o">=</span> <span class="n">SortedDict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">timestamp</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">logs</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">logs</span><span class="p">[</span><span class="n">timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logs</span><span class="p">[</span><span class="n">timestamp</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">granularity</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"Year"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s">"Month"</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s">"Day"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s">"Hour"</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
            <span class="s">"Minute"</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
            <span class="s">"Second"</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="p">[:</span><span class="n">index</span><span class="p">[</span><span class="n">granularity</span><span class="p">]]</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">end</span><span class="p">[:</span><span class="n">index</span><span class="p">[</span><span class="n">granularity</span><span class="p">]]</span>
        
        <span class="c1"># Adjust end to ensure it captures the correct range for the granularity
</span>        <span class="n">end</span> <span class="o">=</span> <span class="n">end</span><span class="p">[:</span><span class="n">index</span><span class="p">[</span><span class="n">granularity</span><span class="p">]]</span> <span class="o">+</span> <span class="s">"9"</span> <span class="o">*</span> <span class="p">(</span><span class="mi">19</span> <span class="o">-</span> <span class="n">index</span><span class="p">[</span><span class="n">granularity</span><span class="p">])</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Using irange to efficiently iterate over the range of timestamps
</span>        <span class="c1"># By default, both are set to True for inclusive{}
</span>        <span class="c1">#   eg: sd.irange('banana', 'elderberry', inclusive=(True, True))
</span>        <span class="k">for</span> <span class="n">timestamp</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">logs</span><span class="p">.</span><span class="n">irange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">timestamp</span><span class="p">[:</span><span class="n">index</span><span class="p">[</span><span class="n">granularity</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">result</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">logs</span><span class="p">[</span><span class="n">timestamp</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">type</span> <span class="n">LogSystem</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">logs</span> <span class="p">[]</span><span class="n">pair</span>
	<span class="n">d</span>    <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">Constructor</span><span class="p">()</span> <span class="n">LogSystem</span> <span class="p">{</span>
	<span class="n">d</span> <span class="o">:=</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">{</span>
		<span class="s">"Year"</span><span class="o">:</span>   <span class="m">4</span><span class="p">,</span>
		<span class="s">"Month"</span><span class="o">:</span>  <span class="m">7</span><span class="p">,</span>
		<span class="s">"Day"</span><span class="o">:</span>    <span class="m">10</span><span class="p">,</span>
		<span class="s">"Hour"</span><span class="o">:</span>   <span class="m">13</span><span class="p">,</span>
		<span class="s">"Minute"</span><span class="o">:</span> <span class="m">16</span><span class="p">,</span>
		<span class="s">"Second"</span><span class="o">:</span> <span class="m">19</span><span class="p">,</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">LogSystem</span><span class="p">{[]</span><span class="n">pair</span><span class="p">{},</span> <span class="n">d</span><span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">this</span> <span class="o">*</span><span class="n">LogSystem</span><span class="p">)</span> <span class="n">Put</span><span class="p">(</span><span class="n">id</span> <span class="kt">int</span><span class="p">,</span> <span class="n">timestamp</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">this</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">logs</span><span class="p">,</span> <span class="n">pair</span><span class="p">{</span><span class="n">id</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">})</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">this</span> <span class="o">*</span><span class="n">LogSystem</span><span class="p">)</span> <span class="n">Retrieve</span><span class="p">(</span><span class="n">start</span> <span class="kt">string</span><span class="p">,</span> <span class="n">end</span> <span class="kt">string</span><span class="p">,</span> <span class="n">granularity</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="n">ans</span> <span class="p">[]</span><span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">i</span> <span class="o">:=</span> <span class="n">this</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="n">granularity</span><span class="p">]</span>
	<span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="o">:=</span> <span class="n">start</span><span class="p">[</span><span class="o">:</span><span class="n">i</span><span class="p">],</span> <span class="n">end</span><span class="p">[</span><span class="o">:</span><span class="n">i</span><span class="p">]</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">log</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">this</span><span class="o">.</span><span class="n">logs</span> <span class="p">{</span>
		<span class="n">t</span> <span class="o">:=</span> <span class="n">log</span><span class="o">.</span><span class="n">ts</span><span class="p">[</span><span class="o">:</span><span class="n">i</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&amp;&amp;</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">e</span> <span class="p">{</span>
			<span class="n">ans</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">log</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">pair</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">id</span> <span class="kt">int</span>
	<span class="n">ts</span> <span class="kt">string</span>
<span class="p">}</span>

<span class="c">/**
 * Your LogSystem object will be instantiated and called as such:
 * obj := Constructor();
 * obj.Put(id,timestamp);
 * param_2 := obj.Retrieve(start,end,granularity);
 */</span>
</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-635.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
