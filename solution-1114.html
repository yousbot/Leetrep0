<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-1114.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-1114.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>1114 - Print in Order</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 1114. Print in Order Description Suppose we have a class: public class Foo { public void first() { print(&amp;quot;first&amp;quot;); } public void second() { print(&amp;quot;second&amp;quot;); } public void third() { print(&amp;quot;third&amp;quot;); } } The same instance of Foo will be passed to three different threads....">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-1114.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-1114.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-1114.html" rel="stylesheet"/>
   <link href="solution-1114.html" rel="stylesheet"/>
   <link href="solution-1114.html" rel="stylesheet"/>
   <link href="solution-1114.html" rel="stylesheet"/>
   <link href="solution-1114.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="1114 - Print in Order" property="og:title"/>
   <meta content="Leetcode 1114. Print in Order Description Suppose we have a class: public class Foo { public void first() { print(&amp;quot;first&amp;quot;); } public void second() { print(&amp;quot;second&amp;quot;); } public void third() { print(&amp;quot;third&amp;quot;); } } The same instance of Foo will be passed to three different threads. Thread A will call first(), thread B will call second(), and thread C will call third(). Design a mechanism and modify the program to ensure that second() is executed after first(), and third() is executed after second(). Note: We do not know how the threads will be scheduled in the operating system, even though the numbers in the input seem to imply the ordering. The input format you see is mainly to ensure our tests&amp;#39; comprehensiveness. &amp;nbsp; Example 1: Input: nums = [1,2,3] Output: &amp;quot;firstsecondthird&amp;quot; Explanation: There are three threads being fired asynchronously. The input [1,2,3] means thread A calls first(), thread B calls second(), and thread C calls third(). &amp;quot;firstsecondthird&amp;quot; is the correct output. Example 2: Input: nums = [1,3,2] Output: &amp;quot;firstsecondthird&amp;quot; Explanation: The input [1,3,2] means thread A calls first(), thread B calls third(), and thread C calls second(). &amp;quot;firstsecondthird&amp;quot; is the correct output. &amp;nbsp; Constraints: nums is a permutation of [1, 2, 3]. Solutions Solution 1: Multithreading + Lock or Semaphore We can use three semaphores $a$, $b$, and $c$ to control the execution order of the three threads. Initially, the count of semaphore $a$ is $1$, and the counts of $b$ and $c$ are $0$. When thread $A$ executes the first() method, it first needs to acquire semaphore $a$. After acquiring successfully, it executes the first() method, and then releases semaphore $b$. This allows thread $B$ to acquire semaphore $b$ and execute the second() method. When thread $B$ executes the second() method, it first needs to acquire semaphore $b$. After acquiring successfully, it executes the second() method, and then releases semaphore $c$. This allows thread $C$ to acquire semaphore $c$ and execute the third() method. When thread $C$ executes the third() method, it first needs to acquire semaphore $c$. After acquiring successfully, it executes the third() method, and then releases semaphore $a$. This allows thread $A$ to acquire semaphore $a$ and execute the first() method. The time complexity is $O(1)$, and the space complexity is $O(1)$. Solution 2: Multithreading + Barrier In Python, a Barrier is a synchronization primitive that is used in concurrent programming. It allows multiple threads to wait for each other at a certain point in the code, ensuring that all the participating threads have reached this point before any of them can proceed. This is useful in scenarios where a part of the computation in one thread depends on the completion of similar parts in other threads. Hereâs an example using the Barrier from Pythonâs threading module: import threading import time import random def task(barrier, name): print(f'{name} is waiting for the barrier.') time.sleep(random.randint(1, 5)) # Simulate work barrier.wait() # Wait for all threads to arrive at this point print(f'{name} has crossed the..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2018-12-18T00:00:00-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2018-12-18-1114-Print-in-Order/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-1114.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="1114 - Print in Order" property="twitter:title"/>
   <meta content="Leetcode 1114. Print in Order Description Suppose we have a class: public class Foo { public void first() { print(&amp;quot;first&amp;quot;); } public void second() { print(&amp;quot;second&amp;quot;); } public void third() { print(&amp;quot;third&amp;quot;); } } The same instance of Foo will be passed to three different threads. Thread A will call first(), thread B will call second(), and thread C will call third(). Design a mechanism and modify the program to ensure that second() is executed after first(), and third() is executed after second(). Note: We do not know how the threads will be scheduled in the operating system, even though the numbers in the input seem to imply the ordering. The input format you see is mainly to ensure our tests&amp;#39; comprehensiveness. &amp;nbsp; Example 1: Input: nums = [1,2,3] Output: &amp;quot;firstsecondthird&amp;quot; Explanation: There are three threads being fired asynchronously. The input [1,2,3] means thread A calls first(), thread B calls second(), and thread C calls third(). &amp;quot;firstsecondthird&amp;quot; is the correct output. Example 2: Input: nums = [1,3,2] Output: &amp;quot;firstsecondthird&amp;quot; Explanation: The input [1,3,2] means thread A calls first(), thread B calls third(), and thread C calls second(). &amp;quot;firstsecondthird&amp;quot; is the correct output. &amp;nbsp; Constraints: nums is a permutation of [1, 2, 3]. Solutions Solution 1: Multithreading + Lock or Semaphore We can use three semaphores $a$, $b$, and $c$ to control the execution order of the three threads. Initially, the count of semaphore $a$ is $1$, and the counts of $b$ and $c$ are $0$. When thread $A$ executes the first() method, it first needs to acquire semaphore $a$. After acquiring successfully, it executes the first() method, and then releases semaphore $b$. This allows thread $B$ to acquire semaphore $b$ and execute the second() method. When thread $B$ executes the second() method, it first needs to acquire semaphore $b$. After acquiring successfully, it executes the second() method, and then releases semaphore $c$. This allows thread $C$ to acquire semaphore $c$ and execute the third() method. When thread $C$ executes the third() method, it first needs to acquire semaphore $c$. After acquiring successfully, it executes the third() method, and then releases semaphore $a$. This allows thread $A$ to acquire semaphore $a$ and execute the first() method. The time complexity is $O(1)$, and the space complexity is $O(1)$. Solution 2: Multithreading + Barrier In Python, a Barrier is a synchronization primitive that is used in concurrent programming. It allows multiple threads to wait for each other at a certain point in the code, ensuring that all the participating threads have reached this point before any of them can proceed. This is useful in scenarios where a part of the computation in one thread depends on the completion of similar parts in other threads. Hereâs an example using the Barrier from Pythonâs threading module: import threading import time import random def task(barrier, name): print(f'{name} is waiting for the barrier.') time.sleep(random.randint(1, 5)) # Simulate work barrier.wait() # Wait for all threads to arrive at this point print(f'{name} has crossed the..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    1114 - Print in Order | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="1114 - Print in Order" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-1114.html" rel="canonical">
          <meta content="https://leetcode.ca/2018-12-18-1114-Print-in-Order/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2018-12-18T00:00:00-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"1114 - Print in Order","dateModified":"2018-12-18T00:00:00-08:00","datePublished":"2018-12-18T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2018-12-18-1114-Print-in-Order/"},"url":"https://leetcode.ca/2018-12-18-1114-Print-in-Order/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="1114-print-in-order">
       <a href="solution-1114.html">
        1114. Print in Order
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       Suppose we have a class:
      </p>
      <pre>
public class Foo {
  public void first() { print("first"); }
  public void second() { print("second"); }
  public void third() { print("third"); }
}
</pre>
      <p>
       The same instance of
       <code>
        Foo
       </code>
       will be passed to three different threads. Thread A will call
       <code>
        first()
       </code>
       , thread B will call
       <code>
        second()
       </code>
       , and thread C will call
       <code>
        third()
       </code>
       . Design a mechanism and modify the program to ensure that
       <code>
        second()
       </code>
       is executed after
       <code>
        first()
       </code>
       , and
       <code>
        third()
       </code>
       is executed after
       <code>
        second()
       </code>
       .
      </p>
      <p>
       <strong>
        Note:
       </strong>
      </p>
      <p>
       We do not know how the threads will be scheduled in the operating system, even though the numbers in the input seem to imply the ordering. The input format you see is mainly to ensure our tests' comprehensiveness.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> nums = [1,2,3]
<strong>Output:</strong> "firstsecondthird"
<strong>Explanation:</strong> There are three threads being fired asynchronously. The input [1,2,3] means thread A calls first(), thread B calls second(), and thread C calls third(). "firstsecondthird" is the correct output.
</pre>
      <p>
       <strong class="example">
        Example 2:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> nums = [1,3,2]
<strong>Output:</strong> "firstsecondthird"
<strong>Explanation:</strong> The input [1,3,2] means thread A calls first(), thread B calls third(), and thread C calls second(). "firstsecondthird" is the correct output.
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         nums
        </code>
        is a permutation of
        <code>
         [1, 2, 3]
        </code>
        .
       </li>
      </ul>
      <h2 id="solutions">
       Solutions
      </h2>
      <p>
       <strong>
        Solution 1: Multithreading + Lock or Semaphore
       </strong>
      </p>
      <p>
       We can use three semaphores $a$, $b$, and $c$ to control the execution order of the three threads. Initially, the count of semaphore $a$ is $1$, and the counts of $b$ and $c$ are $0$.
      </p>
      <p>
       When thread $A$ executes the
       <code class="language-plaintext highlighter-rouge">
        first()
       </code>
       method, it first needs to acquire semaphore $a$. After acquiring successfully, it executes the
       <code class="language-plaintext highlighter-rouge">
        first()
       </code>
       method, and then releases semaphore $b$. This allows thread $B$ to acquire semaphore $b$ and execute the
       <code class="language-plaintext highlighter-rouge">
        second()
       </code>
       method.
      </p>
      <p>
       When thread $B$ executes the
       <code class="language-plaintext highlighter-rouge">
        second()
       </code>
       method, it first needs to acquire semaphore $b$. After acquiring successfully, it executes the
       <code class="language-plaintext highlighter-rouge">
        second()
       </code>
       method, and then releases semaphore $c$. This allows thread $C$ to acquire semaphore $c$ and execute the
       <code class="language-plaintext highlighter-rouge">
        third()
       </code>
       method.
      </p>
      <p>
       When thread $C$ executes the
       <code class="language-plaintext highlighter-rouge">
        third()
       </code>
       method, it first needs to acquire semaphore $c$. After acquiring successfully, it executes the
       <code class="language-plaintext highlighter-rouge">
        third()
       </code>
       method, and then releases semaphore $a$. This allows thread $A$ to acquire semaphore $a$ and execute the
       <code class="language-plaintext highlighter-rouge">
        first()
       </code>
       method.
      </p>
      <p>
       The time complexity is $O(1)$, and the space complexity is $O(1)$.
      </p>
      <p>
       <strong>
        Solution 2: Multithreading + Barrier
       </strong>
      </p>
      <p>
       In Python, a
       <code class="language-plaintext highlighter-rouge">
        Barrier
       </code>
       is a synchronization primitive that is used in concurrent programming. It allows multiple threads to wait for each other at a certain point in the code, ensuring that all the participating threads have reached this point before any of them can proceed. This is useful in scenarios where a part of the computation in one thread depends on the completion of similar parts in other threads.
      </p>
      <p>
       Hereâs an example using the
       <code class="language-plaintext highlighter-rouge">
        Barrier
       </code>
       from Pythonâs
       <code class="language-plaintext highlighter-rouge">
        threading
       </code>
       module:
      </p>
      <div class="language-python highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code><span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">task</span><span class="p">(</span><span class="n">barrier</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s"> is waiting for the barrier.'</span><span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># Simulate work
</span>    <span class="n">barrier</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>  <span class="c1"># Wait for all threads to arrive at this point
</span>    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s"> has crossed the barrier.'</span><span class="p">)</span>

<span class="c1"># Create a barrier for 3 threads
</span><span class="n">barrier</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Barrier</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Start 3 threads that will wait on the barrier
</span><span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">barrier</span><span class="p">,</span> <span class="sa">f</span><span class="s">'Thread </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">'</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
    <span class="n">t</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
    <span class="n">t</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s">'All threads have crossed the barrier.'</span><span class="p">)</span>
</code></pre>
       </div>
      </div>
      <p>
       In this example, three threads are started, and each of them executes the
       <code class="language-plaintext highlighter-rouge">
        task
       </code>
       function. Inside
       <code class="language-plaintext highlighter-rouge">
        task
       </code>
       , each thread first prints a message indicating itâs waiting for the barrier. Then, it simulates some work by sleeping for a random amount of time between 1 and 5 seconds. After the simulated work, the thread calls
       <code class="language-plaintext highlighter-rouge">
        barrier.wait()
       </code>
       , which causes the thread to wait until all three threads have reached this point.
      </p>
      <p>
       Once all threads have called
       <code class="language-plaintext highlighter-rouge">
        barrier.wait()
       </code>
       , they are all released to proceed past the barrier point. This is indicated by printing that each thread has âcrossed the barrierâ. Finally, the main thread waits for all threads to complete by joining them and then prints that all threads have crossed the barrier.
      </p>
      <p>
       This
       <code class="language-plaintext highlighter-rouge">
        Barrier
       </code>
       example demonstrates how to synchronize threads in Python, ensuring that certain parts of your program in different threads run in step with each other.
      </p>
      <p>
       <strong>
        Solution 3: Multithreading + Event
       </strong>
      </p>
      <p>
       The
       <code class="language-plaintext highlighter-rouge">
        Event
       </code>
       object from Pythonâs
       <code class="language-plaintext highlighter-rouge">
        threading
       </code>
       module is a simple synchronization primitive that is used to communicate between threads. One thread signals an event, and other threads can wait for that event to be set. Hereâs an example to demonstrate how
       <code class="language-plaintext highlighter-rouge">
        Event
       </code>
       can be used in Python:
      </p>
      <div class="language-python highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Thread</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">waiter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s"> is waiting for the event to be set.'</span><span class="p">)</span>
    <span class="n">event</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>  <span class="c1"># Block until the event is set.
</span>    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s"> has detected the event is set and is proceeding.'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">setter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Event setter is sleeping.'</span><span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>  <span class="c1"># Simulate doing some work for a while
</span>    <span class="n">event</span><span class="p">.</span><span class="nb">set</span><span class="p">()</span>  <span class="c1"># Set the event, all waiting threads are unblocked.
</span>    <span class="k">print</span><span class="p">(</span><span class="s">'Event setter has set the event. Waiting threads are released.'</span><span class="p">)</span>

<span class="c1"># Create an Event object
</span><span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

<span class="c1"># Start a thread that will wait for the event to be set
</span><span class="n">waiter_thread1</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">waiter</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s">'Waiter 1'</span><span class="p">))</span>
<span class="n">waiter_thread1</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

<span class="n">waiter_thread2</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">waiter</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s">'Waiter 2'</span><span class="p">))</span>
<span class="n">waiter_thread2</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

<span class="c1"># Start a thread that will set the event after a delay
</span><span class="n">setter_thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">setter</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># Delay of 3 seconds
</span><span class="n">setter_thread</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

<span class="c1"># Join all threads to the main thread
</span><span class="n">waiter_thread1</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
<span class="n">waiter_thread2</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
<span class="n">setter_thread</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s">'All threads have completed.'</span><span class="p">)</span>
</code></pre>
       </div>
      </div>
      <p>
       In this example, two âwaiterâ threads are waiting for an event to be set, and a âsetterâ thread sets the event after a delay of 3 seconds. The
       <code class="language-plaintext highlighter-rouge">
        event.wait()
       </code>
       call in the waiter threads blocks those threads until the event is set by calling
       <code class="language-plaintext highlighter-rouge">
        event.set()
       </code>
       in the setter thread. Once the event is set, all waiting threads are unblocked and proceed with their execution.
      </p>
      <p>
       This mechanism allows for simple communication between threads, where an event can signal that some condition has been met, a task has been completed, or a certain point in the program flow has been reached.
      </p>
      <p>
       <strong>
        Solution 4: Multithreading + Condition
       </strong>
      </p>
      <p>
       In Python, a
       <code class="language-plaintext highlighter-rouge">
        Condition
       </code>
       object from the
       <code class="language-plaintext highlighter-rouge">
        threading
       </code>
       module is a synchronization primitive that allows one or more threads to wait until they are notified by another thread. This can be useful in situations where some threads need to wait for some condition to become true before proceeding. The
       <code class="language-plaintext highlighter-rouge">
        Condition
       </code>
       provides methods for acquiring and releasing a lock, waiting for a condition to become true, and notifying other threads that the condition may be true now.
      </p>
      <p>
       Hereâs an example to demonstrate how to use a
       <code class="language-plaintext highlighter-rouge">
        Condition
       </code>
       :
      </p>
      <div class="language-python highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code><span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># A list to use as the shared resource or condition
</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">condition</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Condition</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Consumer</span><span class="p">(</span><span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">items</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">condition</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">items</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> is waiting for items to be added'</span><span class="p">)</span>
                    <span class="n">condition</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>  <span class="c1"># Wait until an item is available
</span>                <span class="n">item</span> <span class="o">=</span> <span class="n">items</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> consumed an item: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Producer</span><span class="p">(</span><span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">items</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Simulate time to produce an item
</span>            <span class="k">with</span> <span class="n">condition</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'item </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">'</span>
                <span class="n">items</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> produced an item: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
                <span class="n">condition</span><span class="p">.</span><span class="n">notify</span><span class="p">()</span>  <span class="c1"># Notify waiting consumers an item is available
</span>
<span class="c1"># Create and start producer and consumer threads
</span><span class="n">producer</span> <span class="o">=</span> <span class="n">Producer</span><span class="p">(</span><span class="s">'Producer'</span><span class="p">)</span>
<span class="n">consumer</span> <span class="o">=</span> <span class="n">Consumer</span><span class="p">(</span><span class="s">'Consumer'</span><span class="p">)</span>

<span class="n">producer</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">consumer</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

<span class="n">producer</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
<span class="n">consumer</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
</code></pre>
       </div>
      </div>
      <p>
       In this example:
      </p>
      <ul>
       <li>
        The
        <code class="language-plaintext highlighter-rouge">
         Producer
        </code>
        thread produces items (in this case, just strings) and adds them to the
        <code class="language-plaintext highlighter-rouge">
         items
        </code>
        list. After producing an item, it calls
        <code class="language-plaintext highlighter-rouge">
         condition.notify()
        </code>
        to signal to the
        <code class="language-plaintext highlighter-rouge">
         Consumer
        </code>
        threads that a new item is available.
       </li>
       <li>
        The
        <code class="language-plaintext highlighter-rouge">
         Consumer
        </code>
        thread waits for items to be added to the list by calling
        <code class="language-plaintext highlighter-rouge">
         condition.wait()
        </code>
        . This call will block the
        <code class="language-plaintext highlighter-rouge">
         Consumer
        </code>
        until the
        <code class="language-plaintext highlighter-rouge">
         Producer
        </code>
        adds an item to the list and calls
        <code class="language-plaintext highlighter-rouge">
         condition.notify()
        </code>
        .
       </li>
       <li>
        Both
        <code class="language-plaintext highlighter-rouge">
         Producer
        </code>
        and
        <code class="language-plaintext highlighter-rouge">
         Consumer
        </code>
        use
        <code class="language-plaintext highlighter-rouge">
         with condition:
        </code>
        to automatically acquire a lock before modifying the
        <code class="language-plaintext highlighter-rouge">
         items
        </code>
        list and to release the lock afterward. This ensures that the list is not accessed by multiple threads at the same time, preventing race conditions.
       </li>
      </ul>
      <p>
       This example demonstrates how
       <code class="language-plaintext highlighter-rouge">
        Condition
       </code>
       objects can be used to synchronize threads in a producer-consumer scenario.
      </p>
      <p>
       <strong>
        Solution 5: Multithreading + Lock
       </strong>
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        threading.Lock
       </code>
       is a synchronization primitive that is used to enforce limits on access to a resource in a multi-threaded environment. It is one of the simplest locking mechanisms provided by the
       <code class="language-plaintext highlighter-rouge">
        threading
       </code>
       module in Python. A lock can be in one of two states: âlockedâ or âunlockedâ. It has two basic methods:
       <code class="language-plaintext highlighter-rouge">
        .acquire()
       </code>
       (to lock) and
       <code class="language-plaintext highlighter-rouge">
        .release()
       </code>
       (to unlock).
      </p>
      <p>
       Here is a basic example of using a
       <code class="language-plaintext highlighter-rouge">
        threading.Lock
       </code>
       :
      </p>
      <div class="language-python highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code><span class="kn">import</span> <span class="nn">threading</span>

<span class="c1"># Shared resource
</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Create a lock
</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Lock</span><span class="p">()</span>

<span class="c1"># A function to increment global counter
</span><span class="k">def</span> <span class="nf">increment</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">counter</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">):</span>
        <span class="c1"># Acquire the lock
</span>        <span class="n">lock</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Release the lock
</span>        <span class="n">lock</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

<span class="c1"># Create threads
</span><span class="n">thread1</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">increment</span><span class="p">)</span>
<span class="n">thread2</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">increment</span><span class="p">)</span>

<span class="c1"># Start threads
</span><span class="n">thread1</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">thread2</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

<span class="c1"># Wait for both threads to finish
</span><span class="n">thread1</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
<span class="n">thread2</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"The final counter value is </span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre>
       </div>
      </div>
      <p>
       In this example, two threads are incrementing a shared global counter. The
       <code class="language-plaintext highlighter-rouge">
        lock.acquire()
       </code>
       method is used to ensure that only one thread can enter the critical section of code at any time to increment the counter. This prevents race conditions and ensures that the final value of the counter is correct.
      </p>
      <p>
       <strong>
        Difference Between Lock and Semaphore
       </strong>
       :
      </p>
      <ul>
       <li>
        <p>
         <strong>
          Lock
         </strong>
         : A lock allows only one thread to access the critical section of code at a time. When a thread acquires a lock, any other thread that attempts to acquire it will be blocked until the lock is released by the current owner. Locks are typically binary (either locked or unlocked).
        </p>
       </li>
       <li>
        <p>
         <strong>
          Semaphore
         </strong>
         : A semaphore allows a fixed number of threads to access the critical section. Itâs initialized with a given count, which represents the number of threads allowed to access the critical section concurrently. When a thread enters the section, it decrements the count, and when it exits, it increments the count. If the count reaches zero, subsequent threads attempting to enter will block until the count is greater than zero again.
        </p>
       </li>
      </ul>
      <p>
       The
       <code class="language-plaintext highlighter-rouge">
        key difference
       </code>
       is in the
       <code class="language-plaintext highlighter-rouge">
        number of threads
       </code>
       allowed to access the critical section: locks restrict access to one thread at a time, whereas semaphores allow multiple threads (up to a fixed limit) to access the shared resource concurrently.
      </p>
      <p>
       Semaphores can be used for controlling access to a pool of resources, while locks are more suited for situations where access to a single resource must be synchronized among threads.
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#ad6c846f-2b51-467e-bd37-8a4c775ebe6e'}">
       <li class="uk-active">
        <a href="solution-1114.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-1114.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-1114.html">
         Python
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="ad6c846f-2b51-467e-bd37-8a4c775ebe6e">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Semaphore</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Semaphore</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="kd">private</span> <span class="nc">Semaphore</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Semaphore</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="kd">private</span> <span class="nc">Semaphore</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Semaphore</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>

    <span class="kd">public</span> <span class="nf">Foo</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">first</span><span class="o">(</span><span class="nc">Runnable</span> <span class="n">printFirst</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
        <span class="n">a</span><span class="o">.</span><span class="na">acquire</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="c1">// printFirst.run() outputs "first". Do not change or remove this line.</span>
        <span class="n">printFirst</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
        <span class="n">b</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">second</span><span class="o">(</span><span class="nc">Runnable</span> <span class="n">printSecond</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
        <span class="n">b</span><span class="o">.</span><span class="na">acquire</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="c1">// printSecond.run() outputs "second". Do not change or remove this line.</span>
        <span class="n">printSecond</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">third</span><span class="o">(</span><span class="nc">Runnable</span> <span class="n">printThird</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
        <span class="n">c</span><span class="o">.</span><span class="na">acquire</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="c1">// printThird.run() outputs "third". Do not change or remove this line.</span>
        <span class="n">printThird</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
        <span class="n">a</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Foo</span> <span class="p">{</span>
<span class="nl">private:</span>
    <span class="n">mutex</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">;</span>

<span class="nl">public:</span>
    <span class="n">Foo</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">m2</span><span class="p">.</span><span class="n">lock</span><span class="p">();</span>
        <span class="n">m3</span><span class="p">.</span><span class="n">lock</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">first</span><span class="p">(</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">()</span><span class="o">&gt;</span> <span class="n">printFirst</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printFirst</span><span class="p">();</span>
        <span class="n">m2</span><span class="p">.</span><span class="n">unlock</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">second</span><span class="p">(</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">()</span><span class="o">&gt;</span> <span class="n">printSecond</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m2</span><span class="p">.</span><span class="n">lock</span><span class="p">();</span>
        <span class="n">printSecond</span><span class="p">();</span>
        <span class="n">m3</span><span class="p">.</span><span class="n">unlock</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">third</span><span class="p">(</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">()</span><span class="o">&gt;</span> <span class="n">printThird</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m3</span><span class="p">.</span><span class="n">lock</span><span class="p">();</span>
        <span class="n">printThird</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Semaphore</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore1</span> <span class="o">=</span> <span class="n">Semaphore</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore2</span> <span class="o">=</span> <span class="n">Semaphore</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore3</span> <span class="o">=</span> <span class="n">Semaphore</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printFirst</span><span class="p">:</span> <span class="s">'Callable[[], None]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore1</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="c1"># printFirst() outputs "first". Do not change or remove this line.
</span>        <span class="n">printFirst</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore2</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printSecond</span><span class="p">:</span> <span class="s">'Callable[[], None]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore2</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="c1"># printSecond() outputs "second". Do not change or remove this line.
</span>        <span class="n">printSecond</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore3</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">third</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printThird</span><span class="p">:</span> <span class="s">'Callable[[], None]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore3</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="c1"># printThird() outputs "third". Do not change or remove this line.
</span>        <span class="n">printThird</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">semaphore1</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

<span class="c1">#############
</span>
<span class="s">'''
A Barrier is a synchronization primitive that allows multiple threads
to wait until all threads have reached a certain point of execution before continuing.
'''</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Barrier</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">first_barrier</span> <span class="o">=</span> <span class="n">Barrier</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">second_barrier</span> <span class="o">=</span> <span class="n">Barrier</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="s">'''
    first() self.first_barrier.wait(),  waits at self.first_barrier,
    blocking until another thread also reaches that point.
    Once both threads have reached the barrier,
    they are released, and execution continues.
    '''</span>
    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printFirst</span><span class="p">):</span>
        <span class="n">printFirst</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">first_barrier</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

    <span class="s">'''
    The second method is similar.
    It takes a function printSecond as a parameter.

    It first waits at self.first_barrier, ensuring that the first method has completed.
    Then, it calls printSecond to print the "second" output.

    Finally, it waits at self.second_barrier,
    blocking until the third method reaches the same point.
    '''</span>
    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printSecond</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">first_barrier</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">printSecond</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">second_barrier</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">third</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printThird</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">second_barrier</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">printThird</span><span class="p">()</span>

<span class="c1">############
</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Event</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">done</span> <span class="o">=</span> <span class="p">(</span><span class="n">Event</span><span class="p">(),</span><span class="n">Event</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printFirst</span><span class="p">):</span>
        <span class="n">printFirst</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">done</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printSecond</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">done</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">printSecond</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">done</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">third</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printThird</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">done</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">printThird</span><span class="p">()</span>

<span class="c1">############
</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Semaphore</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">gates</span> <span class="o">=</span> <span class="p">(</span><span class="n">Semaphore</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Semaphore</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printFirst</span><span class="p">):</span>
        <span class="n">printFirst</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">gates</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printSecond</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">gates</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">printSecond</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">gates</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">third</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printThird</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">gates</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">printThird</span><span class="p">()</span>

<span class="c1">############
</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Condition</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">exec_condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">order</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">first_finish</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">second_finish</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printFirst</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">exec_condition</span><span class="p">:</span>
            <span class="n">printFirst</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">exec_condition</span><span class="p">.</span><span class="n">notify</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printSecond</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">exec_condition</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">exec_condition</span><span class="p">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">first_finish</span><span class="p">)</span>
            <span class="n">printSecond</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">order</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">exec_condition</span><span class="p">.</span><span class="n">notify</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">third</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printThird</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">exec_condition</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">exec_condition</span><span class="p">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">second_finish</span><span class="p">)</span>
            <span class="n">printThird</span><span class="p">()</span>

<span class="c1">############
</span>
<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l2</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l3</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l2</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l3</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printFirst</span><span class="p">:</span> <span class="s">'Callable[[], None]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">printFirst</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l2</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printSecond</span><span class="p">:</span> <span class="s">'Callable[[], None]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l2</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">printSecond</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l3</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">third</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printThird</span><span class="p">:</span> <span class="s">'Callable[[], None]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l3</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">printThird</span><span class="p">()</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-1114.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
