<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-358.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-358.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>358 - Rearrange String k Distance Apart</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 358. Rearrange String k Distance Apart Description Given a string s and an integer k, rearrange s such that the same characters are at least distance k from each other. If it is not possible to rearrange the string, return an empty string &amp;quot;&amp;quot;. &amp;nbsp;...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-358.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-358.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-358.html" rel="stylesheet"/>
   <link href="solution-358.html" rel="stylesheet"/>
   <link href="solution-358.html" rel="stylesheet"/>
   <link href="solution-358.html" rel="stylesheet"/>
   <link href="solution-358.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="358 - Rearrange String k Distance Apart" property="og:title"/>
   <meta content="Leetcode 358. Rearrange String k Distance Apart Description Given a string s and an integer k, rearrange s such that the same characters are at least distance k from each other. If it is not possible to rearrange the string, return an empty string &amp;quot;&amp;quot;. &amp;nbsp; Example 1: Input: s = &amp;quot;aabbcc&amp;quot;, k = 3 Output: &amp;quot;abcabc&amp;quot; Explanation: The same letters are at least a distance of 3 from each other. Example 2: Input: s = &amp;quot;aaabc&amp;quot;, k = 3 Output: &amp;quot;&amp;quot; Explanation: It is not possible to rearrange the string. Example 3: Input: s = &amp;quot;aaadbbcc&amp;quot;, k = 2 Output: &amp;quot;abacabcd&amp;quot; Explanation: The same letters are at least a distance of 2 from each other. &amp;nbsp; Constraints: 1 &amp;lt;= s.length &amp;lt;= 3 * 105 s consists of only lowercase English letters. 0 &amp;lt;= k &amp;lt;= s.length Solutions The method uses a max heap to ensure that the character with the highest remaining frequency is selected next, while a queue maintains the constraint of k distance to avoid repeating characters. Steps and Explanation: Counting Characters: Using Counter(s).items(), it counts the occurrences of each character in the string s. It creates a heap h from these counts, with each element being a tuple of the negative count (to create a max heap, since Pythonâs heapq module provides a min heap by default) and the character itself. Heapify: heapify(h) converts the list h into a heap, prioritizing characters by their negative counts, effectively making it a max heap based on character frequency. Initialization: A queue q (implemented with deque) is used to keep track of characters and their remaining counts as they are used, ensuring they can only be re-added to the heap after k iterations. An answer list ans is initialized to build the rearranged string. Rearrangement Process: While the heap h is not empty, it repeatedly pops the character with the highest frequency (heappop(h)), appends it to ans, and decreases its count. This character is then added to the queue q. If the length of q exceeds k, it means that a character at the front of the queue can now be safely re-added to the heap without violating the k distance constraint, as it has been at least k characters since it was last used. The character and its updated count are only re-added to the heap if the count is not zero (w != 0). Completion Check: After processing all characters, it checks if the length of the answer list ans is equal to the length of the input string s. If not, this indicates that it was impossible to rearrange s according to the constraints, and an empty string is returned. Otherwise, it joins and returns the characters in ans as the rearranged string. Java C++ Python Go class Solution { public String rearrangeString(String s, int k) { int n = s.length(); int[] cnt = new int[26]; for (char c : s.toCharArray()) { ++cnt[c - 'a']; } PriorityQueue&amp;lt;int[]&amp;gt; pq = new PriorityQueue&amp;lt;&amp;gt;((a, b)..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2016-11-22T00:00:00-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2016-11-22-358-Rearrange-String-k-Distance-Apart/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-358.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="358 - Rearrange String k Distance Apart" property="twitter:title"/>
   <meta content="Leetcode 358. Rearrange String k Distance Apart Description Given a string s and an integer k, rearrange s such that the same characters are at least distance k from each other. If it is not possible to rearrange the string, return an empty string &amp;quot;&amp;quot;. &amp;nbsp; Example 1: Input: s = &amp;quot;aabbcc&amp;quot;, k = 3 Output: &amp;quot;abcabc&amp;quot; Explanation: The same letters are at least a distance of 3 from each other. Example 2: Input: s = &amp;quot;aaabc&amp;quot;, k = 3 Output: &amp;quot;&amp;quot; Explanation: It is not possible to rearrange the string. Example 3: Input: s = &amp;quot;aaadbbcc&amp;quot;, k = 2 Output: &amp;quot;abacabcd&amp;quot; Explanation: The same letters are at least a distance of 2 from each other. &amp;nbsp; Constraints: 1 &amp;lt;= s.length &amp;lt;= 3 * 105 s consists of only lowercase English letters. 0 &amp;lt;= k &amp;lt;= s.length Solutions The method uses a max heap to ensure that the character with the highest remaining frequency is selected next, while a queue maintains the constraint of k distance to avoid repeating characters. Steps and Explanation: Counting Characters: Using Counter(s).items(), it counts the occurrences of each character in the string s. It creates a heap h from these counts, with each element being a tuple of the negative count (to create a max heap, since Pythonâs heapq module provides a min heap by default) and the character itself. Heapify: heapify(h) converts the list h into a heap, prioritizing characters by their negative counts, effectively making it a max heap based on character frequency. Initialization: A queue q (implemented with deque) is used to keep track of characters and their remaining counts as they are used, ensuring they can only be re-added to the heap after k iterations. An answer list ans is initialized to build the rearranged string. Rearrangement Process: While the heap h is not empty, it repeatedly pops the character with the highest frequency (heappop(h)), appends it to ans, and decreases its count. This character is then added to the queue q. If the length of q exceeds k, it means that a character at the front of the queue can now be safely re-added to the heap without violating the k distance constraint, as it has been at least k characters since it was last used. The character and its updated count are only re-added to the heap if the count is not zero (w != 0). Completion Check: After processing all characters, it checks if the length of the answer list ans is equal to the length of the input string s. If not, this indicates that it was impossible to rearrange s according to the constraints, and an empty string is returned. Otherwise, it joins and returns the characters in ans as the rearranged string. Java C++ Python Go class Solution { public String rearrangeString(String s, int k) { int n = s.length(); int[] cnt = new int[26]; for (char c : s.toCharArray()) { ++cnt[c - 'a']; } PriorityQueue&amp;lt;int[]&amp;gt; pq = new PriorityQueue&amp;lt;&amp;gt;((a, b)..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    358 - Rearrange String k Distance Apart | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="358 - Rearrange String k Distance Apart" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-358.html" rel="canonical">
          <meta content="https://leetcode.ca/2016-11-22-358-Rearrange-String-k-Distance-Apart/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2016-11-22T00:00:00-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"358 - Rearrange String k Distance Apart","dateModified":"2016-11-22T00:00:00-08:00","datePublished":"2016-11-22T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2016-11-22-358-Rearrange-String-k-Distance-Apart/"},"url":"https://leetcode.ca/2016-11-22-358-Rearrange-String-k-Distance-Apart/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="358-rearrange-string-k-distance-apart">
       <a href="solution-358.html">
        358. Rearrange String k Distance Apart
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       Given a string
       <code>
        s
       </code>
       and an integer
       <code>
        k
       </code>
       , rearrange
       <code>
        s
       </code>
       such that the same characters are
       <strong>
        at least
       </strong>
       distance
       <code>
        k
       </code>
       from each other. If it is not possible to rearrange the string, return an empty string
       <code>
        ""
       </code>
       .
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> s = "aabbcc", k = 3
<strong>Output:</strong> "abcabc"
<strong>Explanation:</strong> The same letters are at least a distance of 3 from each other.
</pre>
      <p>
       <strong class="example">
        Example 2:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> s = "aaabc", k = 3
<strong>Output:</strong> ""
<strong>Explanation:</strong> It is not possible to rearrange the string.
</pre>
      <p>
       <strong class="example">
        Example 3:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> s = "aaadbbcc", k = 2
<strong>Output:</strong> "abacabcd"
<strong>Explanation:</strong> The same letters are at least a distance of 2 from each other.
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         1 &lt;= s.length &lt;= 3 * 10
         <sup>
          5
         </sup>
        </code>
       </li>
       <li>
        <code>
         s
        </code>
        consists of only lowercase English letters.
       </li>
       <li>
        <code>
         0 &lt;= k &lt;= s.length
        </code>
       </li>
      </ul>
      <h2 id="solutions">
       Solutions
      </h2>
      <p>
       The method uses a max heap to ensure that the character with the highest remaining frequency is selected next, while a queue maintains the constraint of
       <code class="language-plaintext highlighter-rouge">
        k
       </code>
       distance to avoid repeating characters.
      </p>
      <h3 id="steps-and-explanation">
       Steps and Explanation:
      </h3>
      <ol>
       <li>
        <strong>
         Counting Characters
        </strong>
        :
        <ul>
         <li>
          Using
          <code class="language-plaintext highlighter-rouge">
           Counter(s).items()
          </code>
          , it counts the occurrences of each character in the string
          <code class="language-plaintext highlighter-rouge">
           s
          </code>
          .
         </li>
         <li>
          It creates a heap
          <code class="language-plaintext highlighter-rouge">
           h
          </code>
          from these counts, with each element being a tuple of the negative count (to create a max heap, since Pythonâs heapq module provides a min heap by default) and the character itself.
         </li>
        </ul>
       </li>
       <li>
        <strong>
         Heapify
        </strong>
        :
        <ul>
         <li>
          <code class="language-plaintext highlighter-rouge">
           heapify(h)
          </code>
          converts the list
          <code class="language-plaintext highlighter-rouge">
           h
          </code>
          into a heap, prioritizing characters by their negative counts, effectively making it a max heap based on character frequency.
         </li>
        </ul>
       </li>
       <li>
        <strong>
         Initialization
        </strong>
        :
        <ul>
         <li>
          A queue
          <code class="language-plaintext highlighter-rouge">
           q
          </code>
          (implemented with
          <code class="language-plaintext highlighter-rouge">
           deque
          </code>
          ) is used to keep track of characters and their remaining counts as they are used, ensuring they can only be re-added to the heap after
          <code class="language-plaintext highlighter-rouge">
           k
          </code>
          iterations.
         </li>
         <li>
          An answer list
          <code class="language-plaintext highlighter-rouge">
           ans
          </code>
          is initialized to build the rearranged string.
         </li>
        </ul>
       </li>
       <li>
        <strong>
         Rearrangement Process
        </strong>
        :
        <ul>
         <li>
          While the heap
          <code class="language-plaintext highlighter-rouge">
           h
          </code>
          is not empty, it repeatedly pops the character with the highest frequency (
          <code class="language-plaintext highlighter-rouge">
           heappop(h)
          </code>
          ), appends it to
          <code class="language-plaintext highlighter-rouge">
           ans
          </code>
          , and decreases its count. This character is then added to the queue
          <code class="language-plaintext highlighter-rouge">
           q
          </code>
          .
         </li>
         <li>
          If the length of
          <code class="language-plaintext highlighter-rouge">
           q
          </code>
          exceeds
          <code class="language-plaintext highlighter-rouge">
           k
          </code>
          , it means that a character at the front of the queue can now be safely re-added to the heap without violating the
          <code class="language-plaintext highlighter-rouge">
           k
          </code>
          distance constraint, as it has been at least
          <code class="language-plaintext highlighter-rouge">
           k
          </code>
          characters since it was last used. The character and its updated count are only re-added to the heap if the count is not zero (
          <code class="language-plaintext highlighter-rouge">
           w != 0
          </code>
          ).
         </li>
        </ul>
       </li>
       <li>
        <strong>
         Completion Check
        </strong>
        :
        <ul>
         <li>
          After processing all characters, it checks if the length of the answer list
          <code class="language-plaintext highlighter-rouge">
           ans
          </code>
          is equal to the length of the input string
          <code class="language-plaintext highlighter-rouge">
           s
          </code>
          . If not, this indicates that it was impossible to rearrange
          <code class="language-plaintext highlighter-rouge">
           s
          </code>
          according to the constraints, and an empty string is returned. Otherwise, it joins and returns the characters in
          <code class="language-plaintext highlighter-rouge">
           ans
          </code>
          as the rearranged string.
         </li>
        </ul>
       </li>
      </ol>
      <ul class="uk-tab" data-uk-switcher="{connect:'#2335c202-34d3-4108-8c78-a6cd5399b0fc'}">
       <li class="uk-active">
        <a href="solution-358.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-358.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-358.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-358.html">
         Go
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="2335c202-34d3-4108-8c78-a6cd5399b0fc">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">rearrangeString</span><span class="o">(</span><span class="nc">String</span> <span class="n">s</span><span class="o">,</span> <span class="kt">int</span> <span class="n">k</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">cnt</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="mi">26</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span> <span class="o">:</span> <span class="n">s</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">())</span> <span class="o">{</span>
            <span class="o">++</span><span class="n">cnt</span><span class="o">[</span><span class="n">c</span> <span class="o">-</span> <span class="sc">'a'</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">[]&gt;</span> <span class="n">pq</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;&gt;((</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">-</span> <span class="n">a</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">26</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">cnt</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">pq</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="n">cnt</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">i</span><span class="o">});</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">Deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">[]&gt;</span> <span class="n">q</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayDeque</span><span class="o">&lt;&gt;();</span>
        <span class="nc">StringBuilder</span> <span class="n">ans</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">pq</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="kt">var</span> <span class="n">p</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">p</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">c</span> <span class="o">=</span> <span class="n">p</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
            <span class="n">ans</span><span class="o">.</span><span class="na">append</span><span class="o">((</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="sc">'a'</span> <span class="o">+</span> <span class="n">c</span><span class="o">));</span>
            <span class="n">q</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="n">v</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">c</span><span class="o">});</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="na">pollFirst</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">p</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">pq</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="n">n</span> <span class="o">?</span> <span class="n">ans</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">:</span> <span class="s">""</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">string</span> <span class="n">rearrangeString</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">unordered_map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">cnt</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">char</span> <span class="n">c</span> <span class="o">:</span> <span class="n">s</span><span class="p">)</span> <span class="o">++</span><span class="n">cnt</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
        <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">pq</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span> <span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="o">:</span> <span class="n">cnt</span><span class="p">)</span> <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">});</span>
        <span class="n">queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
        <span class="n">string</span> <span class="n">ans</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">pq</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">auto</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
            <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="n">c</span><span class="p">;</span>
            <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">v</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">});</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">auto</span> <span class="n">p</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
                <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">?</span> <span class="n">ans</span> <span class="o">:</span> <span class="s">""</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kn">from</span> <span class="nn">heapq</span> <span class="kn">import</span> <span class="n">heapify</span>

<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">rearrangeString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">).</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">heapify</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">h</span><span class="p">:</span>
            <span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">heappop</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">ans</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">q</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span> <span class="c1"># enqueue even if 'v-1==0'
</span>            <span class="c1"># not '&gt;='
</span>            <span class="c1"># use example k=1, then q size is 2, then q can pop one out
</span>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span> <span class="c1"># @note: this is avoid you pick up same char in the same k-segment.
</span>                <span class="n">w</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">popleft</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">w</span><span class="p">:</span> <span class="c1"># w!=0
</span>                    <span class="n">heappush</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
        <span class="k">return</span> <span class="s">""</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">else</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>

<span class="c1">#############
</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">heapq</span>

<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">rearrangeString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>

        <span class="n">counts</span> <span class="o">=</span> <span class="n">collections</span><span class="p">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="n">pq</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ch</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">heapq</span><span class="p">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">pq</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">count</span><span class="p">,</span> <span class="n">ch</span><span class="p">))</span>

        <span class="n">sb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">pq</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">pq</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s">""</span>
                <span class="n">count</span><span class="p">,</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">heapq</span><span class="p">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">pq</span><span class="p">)</span>
                <span class="n">sb</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># pushed in as negated, so it's: if actual-positive-count &gt; 1
</span>                    <span class="n">tmp</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ch</span><span class="p">))</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

            <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="n">heapq</span><span class="p">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">pq</span><span class="p">,</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">ch</span><span class="p">))</span>

        <span class="k">return</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">func</span> <span class="n">rearrangeString</span><span class="p">(</span><span class="n">s</span> <span class="kt">string</span><span class="p">,</span> <span class="n">k</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="n">cnt</span> <span class="o">:=</span> <span class="k">map</span><span class="p">[</span><span class="kt">byte</span><span class="p">]</span><span class="kt">int</span><span class="p">{}</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">s</span> <span class="p">{</span>
		<span class="n">cnt</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="n">pq</span> <span class="o">:=</span> <span class="n">hp</span><span class="p">{}</span>
	<span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">cnt</span> <span class="p">{</span>
		<span class="n">heap</span><span class="o">.</span><span class="n">Push</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pq</span><span class="p">,</span> <span class="n">pair</span><span class="p">{</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">})</span>
	<span class="p">}</span>
	<span class="n">ans</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">{}</span>
	<span class="n">q</span> <span class="o">:=</span> <span class="p">[]</span><span class="n">pair</span><span class="p">{}</span>
	<span class="k">for</span> <span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">p</span> <span class="o">:=</span> <span class="n">heap</span><span class="o">.</span><span class="n">Pop</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pq</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
		<span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">p</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">c</span>
		<span class="n">ans</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
		<span class="n">q</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">pair</span><span class="p">{</span><span class="n">v</span> <span class="o">-</span> <span class="m">1</span><span class="p">,</span> <span class="n">c</span><span class="p">})</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">k</span> <span class="p">{</span>
			<span class="n">p</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">]</span>
			<span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="p">{</span>
				<span class="n">heap</span><span class="o">.</span><span class="n">Push</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pq</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kt">string</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="s">""</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">pair</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">v</span> <span class="kt">int</span>
	<span class="n">c</span> <span class="kt">byte</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">hp</span> <span class="p">[]</span><span class="n">pair</span>

<span class="k">func</span> <span class="p">(</span><span class="n">h</span> <span class="n">hp</span><span class="p">)</span> <span class="n">Len</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="p">}</span>
<span class="k">func</span> <span class="p">(</span><span class="n">h</span> <span class="n">hp</span><span class="p">)</span> <span class="n">Less</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
	<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
	<span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">v</span>
<span class="p">}</span>
<span class="k">func</span> <span class="p">(</span><span class="n">h</span> <span class="n">hp</span><span class="p">)</span> <span class="n">Swap</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">}</span>
<span class="k">func</span> <span class="p">(</span><span class="n">h</span> <span class="o">*</span><span class="n">hp</span><span class="p">)</span> <span class="n">Push</span><span class="p">(</span><span class="n">v</span> <span class="n">any</span><span class="p">)</span>   <span class="p">{</span> <span class="o">*</span><span class="n">h</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="p">(</span><span class="n">pair</span><span class="p">))</span> <span class="p">}</span>
<span class="k">func</span> <span class="p">(</span><span class="n">h</span> <span class="o">*</span><span class="n">hp</span><span class="p">)</span> <span class="n">Pop</span><span class="p">()</span> <span class="n">any</span>     <span class="p">{</span> <span class="n">a</span> <span class="o">:=</span> <span class="o">*</span><span class="n">h</span><span class="p">;</span> <span class="n">v</span> <span class="o">:=</span> <span class="n">a</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">];</span> <span class="o">*</span><span class="n">h</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="o">:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">];</span> <span class="k">return</span> <span class="n">v</span> <span class="p">}</span>
</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-358.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
