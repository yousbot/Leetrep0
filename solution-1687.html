<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-1687.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-1687.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>1687 - Delivering Boxes from Storage to Ports</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode Formatted question description: https://leetcode.ca/all/1687.html 1687. Delivering Boxes from Storage to Ports Level Hard Description You have the task of delivering some boxes from storage to their ports using only one ship. However, this ship has a limit on the number of boxes and the total...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-1687.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-1687.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-1687.html" rel="stylesheet"/>
   <link href="solution-1687.html" rel="stylesheet"/>
   <link href="solution-1687.html" rel="stylesheet"/>
   <link href="solution-1687.html" rel="stylesheet"/>
   <link href="solution-1687.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="1687 - Delivering Boxes from Storage to Ports" property="og:title"/>
   <meta content="Leetcode Formatted question description: https://leetcode.ca/all/1687.html 1687. Delivering Boxes from Storage to Ports Level Hard Description You have the task of delivering some boxes from storage to their ports using only one ship. However, this ship has a limit on the number of boxes and the total weight that it can carry. You are given an array boxes, where boxes[i] = [ports_i, weight_i], and three integers portsCount, maxBoxes, and maxWeight. ports_i is the port where you need to deliver the i-th box and weights_i is the weight of the i-th box. portsCount is the number of ports. maxBoxes and maxWeight are the respective box and weight limits of the ship. The boxes need to be delivered in the order they are given. The ship will follow these steps: The ship will take some number of boxes from the boxes queue, not violating the maxBoxes and maxWeight constraints. For each loaded box in order, the ship will make a trip to the port the box needs to be delivered to and deliver it. If the ship is already at the correct port, no trip is needed, and the box can immediately be delivered. The ship then makes a return trip to storage to take more boxes from the queue. The ship must end at storage after all the boxes have been delivered. Return the minimum number of trips the ship needs to make to deliver all boxes to their respective ports. Example 1: Input: boxes = [[1,1],[2,1],[1,1]], portsCount = 2, maxBoxes = 3, maxWeight = 3 Output: 4 Explanation: The optimal strategy is as follows: The ship takes all the boxes in the queue, goes to port 1, then port 2, then port 1 again, then returns to storage. 4 trips. So the total number of trips is 4. Note that the first and third boxes cannot be delivered together because the boxes need to be delivered in order (i.e. the second box needs to be delivered at port 2 before the third box). Example 2: Input: boxes = [[1,2],[3,3],[3,1],[3,1],[2,4]], portsCount = 3, maxBoxes = 3, maxWeight = 6 Output: 6 Explanation: The optimal strategy is as follows: The ship takes the first box, goes to port 1, then returns to storage. 2 trips. The ship takes the second, third and fourth boxes, goes to port 3, then returns to storage. 2 trips. The ship takes the fifth box, goes to port 3, then returns to storage. 2 trips. So the total number of trips is 2 + 2 + 2 = 6. Example 3: Input: boxes = [[1,4],[1,2],[2,1],[2,1],[3,2],[3,4]], portsCount = 3, maxBoxes = 6, maxWeight = 7 Output: 6 Explanation: The optimal strategy is as follows: The ship takes the first and second boxes, goes to port 1, then returns to storage. 2 trips. The ship takes the third and fourth boxes, goes to port 2, then returns to storage. 2 trips. The ship takes the fifth and sixth boxes, goes to port 3, then returns to..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2020-07-13T22:21:01-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2020-07-13-1687-Delivering-Boxes-from-Storage-to-Ports/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-1687.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="1687 - Delivering Boxes from Storage to Ports" property="twitter:title"/>
   <meta content="Leetcode Formatted question description: https://leetcode.ca/all/1687.html 1687. Delivering Boxes from Storage to Ports Level Hard Description You have the task of delivering some boxes from storage to their ports using only one ship. However, this ship has a limit on the number of boxes and the total weight that it can carry. You are given an array boxes, where boxes[i] = [ports_i, weight_i], and three integers portsCount, maxBoxes, and maxWeight. ports_i is the port where you need to deliver the i-th box and weights_i is the weight of the i-th box. portsCount is the number of ports. maxBoxes and maxWeight are the respective box and weight limits of the ship. The boxes need to be delivered in the order they are given. The ship will follow these steps: The ship will take some number of boxes from the boxes queue, not violating the maxBoxes and maxWeight constraints. For each loaded box in order, the ship will make a trip to the port the box needs to be delivered to and deliver it. If the ship is already at the correct port, no trip is needed, and the box can immediately be delivered. The ship then makes a return trip to storage to take more boxes from the queue. The ship must end at storage after all the boxes have been delivered. Return the minimum number of trips the ship needs to make to deliver all boxes to their respective ports. Example 1: Input: boxes = [[1,1],[2,1],[1,1]], portsCount = 2, maxBoxes = 3, maxWeight = 3 Output: 4 Explanation: The optimal strategy is as follows: The ship takes all the boxes in the queue, goes to port 1, then port 2, then port 1 again, then returns to storage. 4 trips. So the total number of trips is 4. Note that the first and third boxes cannot be delivered together because the boxes need to be delivered in order (i.e. the second box needs to be delivered at port 2 before the third box). Example 2: Input: boxes = [[1,2],[3,3],[3,1],[3,1],[2,4]], portsCount = 3, maxBoxes = 3, maxWeight = 6 Output: 6 Explanation: The optimal strategy is as follows: The ship takes the first box, goes to port 1, then returns to storage. 2 trips. The ship takes the second, third and fourth boxes, goes to port 3, then returns to storage. 2 trips. The ship takes the fifth box, goes to port 3, then returns to storage. 2 trips. So the total number of trips is 2 + 2 + 2 = 6. Example 3: Input: boxes = [[1,4],[1,2],[2,1],[2,1],[3,2],[3,4]], portsCount = 3, maxBoxes = 6, maxWeight = 7 Output: 6 Explanation: The optimal strategy is as follows: The ship takes the first and second boxes, goes to port 1, then returns to storage. 2 trips. The ship takes the third and fourth boxes, goes to port 2, then returns to storage. 2 trips. The ship takes the fifth and sixth boxes, goes to port 3, then returns to..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    1687 - Delivering Boxes from Storage to Ports | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="1687 - Delivering Boxes from Storage to Ports" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-1687.html" rel="canonical">
          <meta content="https://leetcode.ca/2020-07-13-1687-Delivering-Boxes-from-Storage-to-Ports/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2020-07-13T22:21:01-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"1687 - Delivering Boxes from Storage to Ports","dateModified":"2020-07-13T22:21:01-07:00","datePublished":"2020-07-13T22:21:01-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2020-07-13-1687-Delivering-Boxes-from-Storage-to-Ports/"},"url":"https://leetcode.ca/2020-07-13-1687-Delivering-Boxes-from-Storage-to-Ports/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <p>
       Formatted question description:
       <a href="solution-1687.html">
        https://leetcode.ca/all/1687.html
       </a>
      </p>
      <h1 id="1687-delivering-boxes-from-storage-to-ports">
       1687. Delivering Boxes from Storage to Ports
      </h1>
      <h2 id="level">
       Level
      </h2>
      <p>
       Hard
      </p>
      <h2 id="description">
       Description
      </h2>
      <p>
       You have the task of delivering some boxes from storage to their ports using only one ship. However, this ship has a
       <strong>
        limit
       </strong>
       on the
       <strong>
        number of boxes
       </strong>
       and the
       <strong>
        total weight
       </strong>
       that it can carry.
      </p>
      <p>
       You are given an array
       <code class="language-plaintext highlighter-rouge">
        boxes
       </code>
       , where
       <code class="language-plaintext highlighter-rouge">
        boxes[i] = [ports_i, weight_i]
       </code>
       , and three integers
       <code class="language-plaintext highlighter-rouge">
        portsCount
       </code>
       ,
       <code class="language-plaintext highlighter-rouge">
        maxBoxes
       </code>
       , and
       <code class="language-plaintext highlighter-rouge">
        maxWeight
       </code>
       .
      </p>
      <ul>
       <li>
        <code class="language-plaintext highlighter-rouge">
         ports_i
        </code>
        is the port where you need to deliver the
        <code class="language-plaintext highlighter-rouge">
         i-th
        </code>
        box and
        <code class="language-plaintext highlighter-rouge">
         weights_i
        </code>
        is the weight of the
        <code class="language-plaintext highlighter-rouge">
         i-th
        </code>
        box.
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         portsCount
        </code>
        is the number of ports.
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         maxBoxes
        </code>
        and
        <code class="language-plaintext highlighter-rouge">
         maxWeight
        </code>
        are the respective box and weight limits of the ship.
       </li>
      </ul>
      <p>
       The boxes need to be delivered
       <strong>
        in the order they are given
       </strong>
       . The ship will follow these steps:
      </p>
      <ul>
       <li>
        The ship will take some number of
        <code class="language-plaintext highlighter-rouge">
         boxes
        </code>
        from the boxes queue, not violating the
        <code class="language-plaintext highlighter-rouge">
         maxBoxes
        </code>
        and
        <code class="language-plaintext highlighter-rouge">
         maxWeight
        </code>
        constraints.
       </li>
       <li>
        For each loaded box
        <strong>
         in order
        </strong>
        , the ship will make a
        <strong>
         trip
        </strong>
        to the port the box needs to be delivered to and deliver it. If the ship is already at the correct port, no
        <strong>
         trip
        </strong>
        is needed, and the box can immediately be delivered.
       </li>
       <li>
        The ship then makes a return
        <strong>
         trip
        </strong>
        to storage to take more boxes from the queue.
       </li>
      </ul>
      <p>
       The ship must end at storage after all the boxes have been delivered.
      </p>
      <p>
       Return
       <em>
        the
        <strong>
         minimum
        </strong>
        number of
        <strong>
         trips
        </strong>
        the ship needs to make to deliver all boxes to their respective ports
       </em>
       .
      </p>
      <p>
       <strong>
        Example 1:
       </strong>
      </p>
      <p>
       <strong>
        Input:
       </strong>
       boxes = [[1,1],[2,1],[1,1]], portsCount = 2, maxBoxes = 3, maxWeight = 3
      </p>
      <p>
       <strong>
        Output:
       </strong>
       4
      </p>
      <p>
       <strong>
        Explanation:
       </strong>
       The optimal strategy is as follows:
      </p>
      <ul>
       <li>
        The ship takes all the boxes in the queue, goes to port 1, then port 2, then port 1 again, then returns to storage. 4 trips.
       </li>
      </ul>
      <p>
       So the total number of trips is 4.
      </p>
      <p>
       Note that the first and third boxes cannot be delivered together because the boxes need to be delivered in order (i.e. the second box needs to be delivered at port 2 before the third box).
      </p>
      <p>
       <strong>
        Example 2:
       </strong>
      </p>
      <p>
       <strong>
        Input:
       </strong>
       boxes = [[1,2],[3,3],[3,1],[3,1],[2,4]], portsCount = 3, maxBoxes = 3, maxWeight = 6
      </p>
      <p>
       <strong>
        Output:
       </strong>
       6
      </p>
      <p>
       <strong>
        Explanation:
       </strong>
       The optimal strategy is as follows:
      </p>
      <ul>
       <li>
        The ship takes the first box, goes to port 1, then returns to storage. 2 trips.
       </li>
       <li>
        The ship takes the second, third and fourth boxes, goes to port 3, then returns to storage. 2 trips.
       </li>
       <li>
        The ship takes the fifth box, goes to port 3, then returns to storage. 2 trips.
       </li>
      </ul>
      <p>
       So the total number of trips is 2 + 2 + 2 = 6.
      </p>
      <p>
       <strong>
        Example 3:
       </strong>
      </p>
      <p>
       <strong>
        Input:
       </strong>
       boxes = [[1,4],[1,2],[2,1],[2,1],[3,2],[3,4]], portsCount = 3, maxBoxes = 6, maxWeight = 7
      </p>
      <p>
       <strong>
        Output:
       </strong>
       6
      </p>
      <p>
       <strong>
        Explanation:
       </strong>
       The optimal strategy is as follows:
      </p>
      <ul>
       <li>
        The ship takes the first and second boxes, goes to port 1, then returns to storage. 2 trips.
       </li>
       <li>
        The ship takes the third and fourth boxes, goes to port 2, then returns to storage. 2 trips.
       </li>
       <li>
        The ship takes the fifth and sixth boxes, goes to port 3, then returns to storage. 2 trips.
       </li>
      </ul>
      <p>
       So the total number of trips is 2 + 2 + 2 = 6.
      </p>
      <p>
       <strong>
        Example 4:
       </strong>
      </p>
      <p>
       <strong>
        Input:
       </strong>
       boxes = [[2,4],[2,5],[3,1],[3,2],[3,7],[3,1],[4,4],[1,3],[5,2]], portsCount = 5, maxBoxes = 5, maxWeight = 7
      </p>
      <p>
       <strong>
        Output:
       </strong>
       14
      </p>
      <p>
       <strong>
        Explanation:
       </strong>
       The optimal strategy is as follows:
      </p>
      <ul>
       <li>
        The ship takes the first box, goes to port 2, then storage. 2 trips.
       </li>
       <li>
        The ship takes the second box, goes to port 2, then storage. 2 trips.
       </li>
       <li>
        The ship takes the third and fourth boxes, goes to port 3, then storage. 2 trips.
       </li>
       <li>
        The ship takes the fifth box, goes to port 3, then storage. 2 trips.
       </li>
       <li>
        The ship takes the sixth and seventh boxes, goes to port 3, then port 4, then storage. 3 trips.
       </li>
       <li>
        The ship takes the eighth and ninth boxes, goes to port 1, then port 5, then storage. 3 trips.
       </li>
      </ul>
      <p>
       So the total number of trips is 2 + 2 + 2 + 2 + 3 + 3 = 14.
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code class="language-plaintext highlighter-rouge">
         1 &lt;= boxes.length &lt;= 10^5
        </code>
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         1 &lt;= portsCount, maxBoxes, maxWeight &lt;= 10^5
        </code>
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         1 &lt;= ports_i &lt;= portsCount
        </code>
       </li>
       <li>
        <code class="language-plaintext highlighter-rouge">
         1 &lt;= weights_i &lt;= maxWeight
        </code>
       </li>
      </ul>
      <h2 id="solution">
       Solution
      </h2>
      <p>
       Use dynamic programming with monotonic deque. Let
       <code class="language-plaintext highlighter-rouge">
        n
       </code>
       be the number of boxes. Create an array
       <code class="language-plaintext highlighter-rouge">
        dp
       </code>
       of length
       <code class="language-plaintext highlighter-rouge">
        n + 1
       </code>
       , where
       <code class="language-plaintext highlighter-rouge">
        dp[i]
       </code>
       represents the minimum number of trips to deliver the first
       <code class="language-plaintext highlighter-rouge">
        i
       </code>
       boxes. Also create an array
       <code class="language-plaintext highlighter-rouge">
        differences
       </code>
       of length
       <code class="language-plaintext highlighter-rouge">
        n + 1
       </code>
       , where
       <code class="language-plaintext highlighter-rouge">
        differences[i]
       </code>
       represents the number of different adjacent pairs of
       <code class="language-plaintext highlighter-rouge">
        ports
       </code>
       before index
       <code class="language-plaintext highlighter-rouge">
        i
       </code>
       . Then there is
       <code class="language-plaintext highlighter-rouge">
        dp[i] = min{dp[j] + differences[i] - differences[j + 1] + 2}
       </code>
       such that
       <code class="language-plaintext highlighter-rouge">
        i - j &lt;= maxBoxes
       </code>
       and the sum of weights from index
       <code class="language-plaintext highlighter-rouge">
        j + 1
       </code>
       to index
       <code class="language-plaintext highlighter-rouge">
        i
       </code>
       is less than or equal to
       <code class="language-plaintext highlighter-rouge">
        maxWeight
       </code>
       . Finally, return
       <code class="language-plaintext highlighter-rouge">
        dp[n]
       </code>
       .
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#b9e75aaa-488e-4477-abbd-fb5af3c84401'}">
       <li class="uk-active">
        <a href="solution-1687.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-1687.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-1687.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-1687.html">
         Go
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="b9e75aaa-488e-4477-abbd-fb5af3c84401">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">boxDelivering</span><span class="o">(</span><span class="kt">int</span><span class="o">[][]</span> <span class="n">boxes</span><span class="o">,</span> <span class="kt">int</span> <span class="n">portsCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">maxBoxes</span><span class="o">,</span> <span class="kt">int</span> <span class="n">maxWeight</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">ports</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">weights</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">differences</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
        <span class="kt">long</span><span class="o">[]</span> <span class="n">prefixWeights</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">ports</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="mi">0</span><span class="o">];</span>
            <span class="n">weights</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="mi">1</span><span class="o">];</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">)</span>
                <span class="n">differences</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">differences</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="o">(</span><span class="n">ports</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span> <span class="o">!=</span> <span class="n">ports</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="o">);</span>
            <span class="n">prefixWeights</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">prefixWeights</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">weights</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="nc">Deque</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">deque</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;();</span>
        <span class="n">deque</span><span class="o">.</span><span class="na">offerLast</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">dp</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">remain</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(!</span><span class="n">deque</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">deque</span><span class="o">.</span><span class="na">peekFirst</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">maxBoxes</span> <span class="o">||</span> <span class="n">prefixWeights</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="n">prefixWeights</span><span class="o">[</span><span class="n">deque</span><span class="o">.</span><span class="na">peekFirst</span><span class="o">()]</span> <span class="o">&gt;</span> <span class="n">maxWeight</span><span class="o">))</span>
                <span class="n">deque</span><span class="o">.</span><span class="na">pollFirst</span><span class="o">();</span>
            <span class="n">dp</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">remain</span><span class="o">[</span><span class="n">deque</span><span class="o">.</span><span class="na">peekFirst</span><span class="o">()]</span> <span class="o">+</span> <span class="n">differences</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">remain</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">dp</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="n">differences</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
                <span class="k">while</span> <span class="o">(!</span><span class="n">deque</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">remain</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="n">remain</span><span class="o">[</span><span class="n">deque</span><span class="o">.</span><span class="na">peekLast</span><span class="o">()])</span>
                    <span class="n">deque</span><span class="o">.</span><span class="na">pollLast</span><span class="o">();</span>
                <span class="n">deque</span><span class="o">.</span><span class="na">offerLast</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">dp</span><span class="o">[</span><span class="n">length</span><span class="o">];</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="err">############</span>

<span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">boxDelivering</span><span class="o">(</span><span class="kt">int</span><span class="o">[][]</span> <span class="n">boxes</span><span class="o">,</span> <span class="kt">int</span> <span class="n">portsCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">maxBoxes</span><span class="o">,</span> <span class="kt">int</span> <span class="n">maxWeight</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="kt">long</span><span class="o">[]</span> <span class="n">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">cs</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">n</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="mi">0</span><span class="o">],</span> <span class="n">w</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="mi">1</span><span class="o">];</span>
            <span class="n">ws</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">ws</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="n">w</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">cs</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">cs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="o">(</span><span class="n">p</span> <span class="o">!=</span> <span class="n">boxes</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
        <span class="nc">Deque</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">q</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayDeque</span><span class="o">&lt;&gt;();</span>
        <span class="n">q</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(!</span><span class="n">q</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span>
                <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">q</span><span class="o">.</span><span class="na">peekFirst</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">maxBoxes</span> <span class="o">||</span> <span class="n">ws</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="n">ws</span><span class="o">[</span><span class="n">q</span><span class="o">.</span><span class="na">peekFirst</span><span class="o">()]</span> <span class="o">&gt;</span> <span class="n">maxWeight</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">q</span><span class="o">.</span><span class="na">pollFirst</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">q</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">f</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">cs</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">f</span><span class="o">[</span><span class="n">q</span><span class="o">.</span><span class="na">peekFirst</span><span class="o">()]</span> <span class="o">-</span> <span class="n">cs</span><span class="o">[</span><span class="n">q</span><span class="o">.</span><span class="na">peekFirst</span><span class="o">()]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(!</span><span class="n">q</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">f</span><span class="o">[</span><span class="n">q</span><span class="o">.</span><span class="na">peekLast</span><span class="o">()]</span> <span class="o">-</span> <span class="n">cs</span><span class="o">[</span><span class="n">q</span><span class="o">.</span><span class="na">peekLast</span><span class="o">()]</span> <span class="o">&gt;=</span> <span class="n">f</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="n">cs</span><span class="o">[</span><span class="n">i</span><span class="o">])</span> <span class="o">{</span>
                    <span class="n">q</span><span class="o">.</span><span class="na">pollLast</span><span class="o">();</span>
                <span class="o">}</span>
                <span class="n">q</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">[</span><span class="n">n</span><span class="o">];</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-python highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">boxDelivering</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="n">portsCount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">maxBoxes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">maxWeight</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span>
        <span class="n">ws</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">accumulate</span><span class="p">((</span><span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">),</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">pairwise</span><span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">)]</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">accumulate</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">while</span> <span class="n">q</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maxBoxes</span> <span class="ow">or</span> <span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ws</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">maxWeight</span><span class="p">):</span>
                <span class="n">q</span><span class="p">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">q</span><span class="p">:</span>
                <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">cs</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="k">while</span> <span class="n">q</span> <span class="ow">and</span> <span class="n">f</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">cs</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">q</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>


</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">boxDelivering</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span> <span class="n">boxes</span><span class="p">,</span> <span class="kt">int</span> <span class="n">portsCount</span><span class="p">,</span> <span class="kt">int</span> <span class="n">maxBoxes</span><span class="p">,</span> <span class="kt">int</span> <span class="n">maxWeight</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="kt">long</span> <span class="n">ws</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">f</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">cs</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="n">ws</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">w</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">ws</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">{</span> <span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="p">};</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">maxBoxes</span> <span class="o">||</span> <span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ws</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">&gt;</span> <span class="n">maxWeight</span><span class="p">))</span> <span class="n">q</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">-</span> <span class="n">cs</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">f</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">()]</span> <span class="o">-</span> <span class="n">cs</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">()]</span> <span class="o">&gt;=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">q</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">func</span> <span class="n">boxDelivering</span><span class="p">(</span><span class="n">boxes</span> <span class="p">[][]</span><span class="kt">int</span><span class="p">,</span> <span class="n">portsCount</span> <span class="kt">int</span><span class="p">,</span> <span class="n">maxBoxes</span> <span class="kt">int</span><span class="p">,</span> <span class="n">maxWeight</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="n">n</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span>
	<span class="n">ws</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="m">1</span><span class="p">)</span>
	<span class="n">cs</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">box</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">boxes</span> <span class="p">{</span>
		<span class="n">p</span><span class="p">,</span> <span class="n">w</span> <span class="o">:=</span> <span class="n">box</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
		<span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="m">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span>
		<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="m">1</span> <span class="p">{</span>
			<span class="n">t</span> <span class="o">:=</span> <span class="m">0</span>
			<span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="m">1</span><span class="p">][</span><span class="m">0</span><span class="p">]</span> <span class="p">{</span>
				<span class="n">t</span><span class="o">++</span>
			<span class="p">}</span>
			<span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="m">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">f</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="m">1</span><span class="p">)</span>
	<span class="n">q</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">0</span><span class="p">}</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="k">for</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maxBoxes</span> <span class="o">||</span> <span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">ws</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">maxWeight</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">]</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="p">{</span>
			<span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">cs</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">]]</span> <span class="o">+</span> <span class="m">2</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="p">{</span>
			<span class="k">for</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="n">f</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">]]</span><span class="o">-</span><span class="n">cs</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">{</span>
				<span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="o">:</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">]</span>
			<span class="p">}</span>
			<span class="n">q</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<span class="p">}</span>
</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-1687.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
