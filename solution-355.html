<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-355.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-355.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>355 - Design Twitter</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode Question Formatted question description: https://leetcode.ca/all/355.html Design a simplified version of Twitter where users can post tweets, follow/unfollow another user, and is able to see the 10 most recent tweets in the user&amp;#39;s news feed. Implement the Twitter class: Twitter() Initializes your twitter object. void postTweet(int...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-355.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-355.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-355.html" rel="stylesheet"/>
   <link href="solution-355.html" rel="stylesheet"/>
   <link href="solution-355.html" rel="stylesheet"/>
   <link href="solution-355.html" rel="stylesheet"/>
   <link href="solution-355.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="355 - Design Twitter" property="og:title"/>
   <meta content="Leetcode Question Formatted question description: https://leetcode.ca/all/355.html Design a simplified version of Twitter where users can post tweets, follow/unfollow another user, and is able to see the 10 most recent tweets in the user&amp;#39;s news feed. Implement the Twitter class: Twitter() Initializes your twitter object. void postTweet(int userId, int tweetId) Composes a new tweet with ID tweetId by the user userId. Each call to this function will be made with a unique tweetId. List&amp;lt;Integer&amp;gt; getNewsFeed(int userId) Retrieves the 10 most recent tweet IDs in the user&amp;#39;s news feed. Each item in the news feed must be posted by users who the user followed or by the user themself. Tweets must be ordered from most recent to least recent. void follow(int followerId, int followeeId) The user with ID followerId started following the user with ID followeeId. void unfollow(int followerId, int followeeId) The user with ID followerId started unfollowing the user with ID followeeId. &amp;nbsp; Example 1: Input [&amp;quot;Twitter&amp;quot;, &amp;quot;postTweet&amp;quot;, &amp;quot;getNewsFeed&amp;quot;, &amp;quot;follow&amp;quot;, &amp;quot;postTweet&amp;quot;, &amp;quot;getNewsFeed&amp;quot;, &amp;quot;unfollow&amp;quot;, &amp;quot;getNewsFeed&amp;quot;] [[], [1, 5], [1], [1, 2], [2, 6], [1], [1, 2], [1]] Output [null, null, [5], null, null, [6, 5], null, [5]] Explanation Twitter twitter = new Twitter(); twitter.postTweet(1, 5); // User 1 posts a new tweet (id = 5). twitter.getNewsFeed(1); // User 1&amp;#39;s news feed should return a list with 1 tweet id -&amp;gt; [5]. return [5] twitter.follow(1, 2); // User 1 follows user 2. twitter.postTweet(2, 6); // User 2 posts a new tweet (id = 6). twitter.getNewsFeed(1); // User 1&amp;#39;s news feed should return a list with 2 tweet ids -&amp;gt; [6, 5]. Tweet id 6 should precede tweet id 5 because it is posted after tweet id 5. twitter.unfollow(1, 2); // User 1 unfollows user 2. twitter.getNewsFeed(1); // User 1&amp;#39;s news feed should return a list with 1 tweet id -&amp;gt; [5], since user 1 is no longer following user 2. &amp;nbsp; Constraints: 1 &amp;lt;= userId, followerId, followeeId &amp;lt;= 500 0 &amp;lt;= tweetId &amp;lt;= 104 All the tweets have unique IDs. At most 3 * 104 calls will be made to postTweet, getNewsFeed, follow, and unfollow. Algorithm We need to do it with two hash tables, The first is to establish a mapping between the user and all his friends, The other is to establish a mapping between users and all their tweet. Since getting new things needs to be arranged in chronological order, then we can use an integer variable cnt to simulate the time point. Each time a message is sent, cnt increments by 1, then we know that the cnt is the most recent one. When we establish the mapping between the user and all its tweet, we also need to establish the mapping between each message and its time point cnt. The main difficulty of this question is to implement the getNewsFeed() function. This function gets the last 10 tweet of yourself and your friends. Our approach is that the user also adds to his friends list, and then traverses all of the userâs friends, traversing..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2016-11-19T21:21:01-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2016-11-19-355-Design-Twitter/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-355.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="355 - Design Twitter" property="twitter:title"/>
   <meta content="Leetcode Question Formatted question description: https://leetcode.ca/all/355.html Design a simplified version of Twitter where users can post tweets, follow/unfollow another user, and is able to see the 10 most recent tweets in the user&amp;#39;s news feed. Implement the Twitter class: Twitter() Initializes your twitter object. void postTweet(int userId, int tweetId) Composes a new tweet with ID tweetId by the user userId. Each call to this function will be made with a unique tweetId. List&amp;lt;Integer&amp;gt; getNewsFeed(int userId) Retrieves the 10 most recent tweet IDs in the user&amp;#39;s news feed. Each item in the news feed must be posted by users who the user followed or by the user themself. Tweets must be ordered from most recent to least recent. void follow(int followerId, int followeeId) The user with ID followerId started following the user with ID followeeId. void unfollow(int followerId, int followeeId) The user with ID followerId started unfollowing the user with ID followeeId. &amp;nbsp; Example 1: Input [&amp;quot;Twitter&amp;quot;, &amp;quot;postTweet&amp;quot;, &amp;quot;getNewsFeed&amp;quot;, &amp;quot;follow&amp;quot;, &amp;quot;postTweet&amp;quot;, &amp;quot;getNewsFeed&amp;quot;, &amp;quot;unfollow&amp;quot;, &amp;quot;getNewsFeed&amp;quot;] [[], [1, 5], [1], [1, 2], [2, 6], [1], [1, 2], [1]] Output [null, null, [5], null, null, [6, 5], null, [5]] Explanation Twitter twitter = new Twitter(); twitter.postTweet(1, 5); // User 1 posts a new tweet (id = 5). twitter.getNewsFeed(1); // User 1&amp;#39;s news feed should return a list with 1 tweet id -&amp;gt; [5]. return [5] twitter.follow(1, 2); // User 1 follows user 2. twitter.postTweet(2, 6); // User 2 posts a new tweet (id = 6). twitter.getNewsFeed(1); // User 1&amp;#39;s news feed should return a list with 2 tweet ids -&amp;gt; [6, 5]. Tweet id 6 should precede tweet id 5 because it is posted after tweet id 5. twitter.unfollow(1, 2); // User 1 unfollows user 2. twitter.getNewsFeed(1); // User 1&amp;#39;s news feed should return a list with 1 tweet id -&amp;gt; [5], since user 1 is no longer following user 2. &amp;nbsp; Constraints: 1 &amp;lt;= userId, followerId, followeeId &amp;lt;= 500 0 &amp;lt;= tweetId &amp;lt;= 104 All the tweets have unique IDs. At most 3 * 104 calls will be made to postTweet, getNewsFeed, follow, and unfollow. Algorithm We need to do it with two hash tables, The first is to establish a mapping between the user and all his friends, The other is to establish a mapping between users and all their tweet. Since getting new things needs to be arranged in chronological order, then we can use an integer variable cnt to simulate the time point. Each time a message is sent, cnt increments by 1, then we know that the cnt is the most recent one. When we establish the mapping between the user and all its tweet, we also need to establish the mapping between each message and its time point cnt. The main difficulty of this question is to implement the getNewsFeed() function. This function gets the last 10 tweet of yourself and your friends. Our approach is that the user also adds to his friends list, and then traverses all of the userâs friends, traversing..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    355 - Design Twitter | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="355 - Design Twitter" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-355.html" rel="canonical">
          <meta content="https://leetcode.ca/2016-11-19-355-Design-Twitter/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2016-11-19T21:21:01-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"355 - Design Twitter","dateModified":"2016-11-19T21:21:01-08:00","datePublished":"2016-11-19T21:21:01-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2016-11-19-355-Design-Twitter/"},"url":"https://leetcode.ca/2016-11-19-355-Design-Twitter/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="question">
       Question
      </h1>
      <p>
       Formatted question description:
       <a href="solution-355.html">
        https://leetcode.ca/all/355.html
       </a>
      </p>
      <p>
       Design a simplified version of Twitter where users can post tweets, follow/unfollow another user, and is able to see the
       <code>
        10
       </code>
       most recent tweets in the user's news feed.
      </p>
      <p>
       Implement the
       <code>
        Twitter
       </code>
       class:
      </p>
      <ul>
       <li>
        <code>
         Twitter()
        </code>
        Initializes your twitter object.
       </li>
       <li>
        <code>
         void postTweet(int userId, int tweetId)
        </code>
        Composes a new tweet with ID
        <code>
         tweetId
        </code>
        by the user
        <code>
         userId
        </code>
        . Each call to this function will be made with a unique
        <code>
         tweetId
        </code>
        .
       </li>
       <li>
        <code>
         List&lt;Integer&gt; getNewsFeed(int userId)
        </code>
        Retrieves the
        <code>
         10
        </code>
        most recent tweet IDs in the user's news feed. Each item in the news feed must be posted by users who the user followed or by the user themself. Tweets must be
        <strong>
         ordered from most recent to least recent
        </strong>
        .
       </li>
       <li>
        <code>
         void follow(int followerId, int followeeId)
        </code>
        The user with ID
        <code>
         followerId
        </code>
        started following the user with ID
        <code>
         followeeId
        </code>
        .
       </li>
       <li>
        <code>
         void unfollow(int followerId, int followeeId)
        </code>
        The user with ID
        <code>
         followerId
        </code>
        started unfollowing the user with ID
        <code>
         followeeId
        </code>
        .
       </li>
      </ul>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input</strong>
["Twitter", "postTweet", "getNewsFeed", "follow", "postTweet", "getNewsFeed", "unfollow", "getNewsFeed"]
[[], [1, 5], [1], [1, 2], [2, 6], [1], [1, 2], [1]]
<strong>Output</strong>
[null, null, [5], null, null, [6, 5], null, [5]]

<strong>Explanation</strong>
Twitter twitter = new Twitter();
twitter.postTweet(1, 5); // User 1 posts a new tweet (id = 5).
twitter.getNewsFeed(1);  // User 1's news feed should return a list with 1 tweet id -&gt; [5]. return [5]
twitter.follow(1, 2);    // User 1 follows user 2.
twitter.postTweet(2, 6); // User 2 posts a new tweet (id = 6).
twitter.getNewsFeed(1);  // User 1's news feed should return a list with 2 tweet ids -&gt; [6, 5]. Tweet id 6 should precede tweet id 5 because it is posted after tweet id 5.
twitter.unfollow(1, 2);  // User 1 unfollows user 2.
twitter.getNewsFeed(1);  // User 1's news feed should return a list with 1 tweet id -&gt; [5], since user 1 is no longer following user 2.
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         1 &lt;= userId, followerId, followeeId &lt;= 500
        </code>
       </li>
       <li>
        <code>
         0 &lt;= tweetId &lt;= 10
         <sup>
          4
         </sup>
        </code>
       </li>
       <li>
        All the tweets have
        <strong>
         unique
        </strong>
        IDs.
       </li>
       <li>
        At most
        <code>
         3 * 10
         <sup>
          4
         </sup>
        </code>
        calls will be made to
        <code>
         postTweet
        </code>
        ,
        <code>
         getNewsFeed
        </code>
        ,
        <code>
         follow
        </code>
        , and
        <code>
         unfollow
        </code>
        .
       </li>
      </ul>
      <h1 id="algorithm">
       Algorithm
      </h1>
      <p>
       We need to do it with two hash tables,
      </p>
      <ul>
       <li>
        The first is to establish a mapping between the user and all his friends,
       </li>
       <li>
        The other is to establish a mapping between users and all their tweet.
       </li>
      </ul>
      <p>
       Since getting new things needs to be arranged in chronological order, then we can use an integer variable
       <code class="language-plaintext highlighter-rouge">
        cnt
       </code>
       to simulate the time point. Each time a message is sent,
       <code class="language-plaintext highlighter-rouge">
        cnt
       </code>
       increments by 1, then we know that the
       <code class="language-plaintext highlighter-rouge">
        cnt
       </code>
       is the most recent one.
      </p>
      <p>
       When we establish the mapping between the user and all its tweet, we also need to establish the mapping between each message and its time point
       <code class="language-plaintext highlighter-rouge">
        cnt
       </code>
       .
      </p>
      <p>
       The main difficulty of this question is to implement the
       <code class="language-plaintext highlighter-rouge">
        getNewsFeed()
       </code>
       function. This function gets the last 10 tweet of yourself and your friends. Our approach is that the user also adds to his friends list, and then traverses all of the userâs friends, traversing each tweet of friends maintain a
       <code class="language-plaintext highlighter-rouge">
        hash table
       </code>
       (or
       <code class="language-plaintext highlighter-rouge">
        heap
       </code>
       ) of size 10,
      </p>
      <ul>
       <li>
        If the newly traversed message is later than the earliest message in the hash table, then add this message, and then delete the oldest message, so that we can find the last 10 tweet.
       </li>
      </ul>
      <h1 id="code">
       Code
      </h1>
      <ul class="uk-tab" data-uk-switcher="{connect:'#236b3ffc-c5bd-4e7a-91e7-2bab185d1e25'}">
       <li class="uk-active">
        <a href="solution-355.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-355.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-355.html">
         Python
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="236b3ffc-c5bd-4e7a-91e7-2bab185d1e25">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code>
<span class="kd">class</span> <span class="nc">Twitter</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">userTweets</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">userFollowing</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">tweets</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">time</span><span class="o">;</span>

    <span class="cm">/** Initialize your data structure here. */</span>
    <span class="kd">public</span> <span class="nf">Twitter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">userTweets</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">userFollowing</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">tweets</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">time</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** Compose a new tweet. */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postTweet</span><span class="o">(</span><span class="kt">int</span> <span class="n">userId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">tweetId</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">userTweets</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="n">k</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;()).</span><span class="na">add</span><span class="o">(</span><span class="n">tweetId</span><span class="o">);</span>
        <span class="n">tweets</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">tweetId</span><span class="o">,</span> <span class="o">++</span><span class="n">time</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Retrieve the 10 most recent tweet ids in the user's news feed. Each item in the news feed
     * must be posted by users who the user followed or by the user herself. Tweets must be ordered
     * from most recent to least recent.
     */</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="nf">getNewsFeed</span><span class="o">(</span><span class="kt">int</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">following</span> <span class="o">=</span> <span class="n">userFollowing</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;());</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">users</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;(</span><span class="n">following</span><span class="o">);</span>
        <span class="n">users</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">userId</span><span class="o">);</span>
        <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">pq</span>
            <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;&gt;(</span><span class="mi">10</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">tweets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">b</span><span class="o">)</span> <span class="o">-</span> <span class="n">tweets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">a</span><span class="o">)));</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">u</span> <span class="o">:</span> <span class="n">users</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">userTweet</span> <span class="o">=</span> <span class="n">userTweets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">u</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">userTweet</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">userTweet</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">userTweet</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">;</span> <span class="o">--</span><span class="n">i</span><span class="o">,</span> <span class="o">--</span><span class="n">k</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">pq</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">userTweet</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">pq</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">res</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">res</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">pq</span><span class="o">.</span><span class="na">poll</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** Follower follows a followee. If the operation is invalid, it should be a no-op. */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">follow</span><span class="o">(</span><span class="kt">int</span> <span class="n">followerId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">followeeId</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">userFollowing</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">followerId</span><span class="o">,</span> <span class="n">k</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;()).</span><span class="na">add</span><span class="o">(</span><span class="n">followeeId</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/** Follower unfollows a followee. If the operation is invalid, it should be a no-op. */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">unfollow</span><span class="o">(</span><span class="kt">int</span> <span class="n">followerId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">followeeId</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">userFollowing</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">followerId</span><span class="o">,</span> <span class="n">k</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;()).</span><span class="na">remove</span><span class="o">(</span><span class="n">followeeId</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 * Your Twitter object will be instantiated and called as such:
 * Twitter obj = new Twitter();
 * obj.postTweet(userId,tweetId);
 * List&lt;Integer&gt; param_2 = obj.getNewsFeed(userId);
 * obj.follow(followerId,followeeId);
 * obj.unfollow(followerId,followeeId);
 */</span>

<span class="c1">//////////////////</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Design_Twitter</span> <span class="o">{</span>
    <span class="kd">class</span> <span class="nc">Twitter</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">userToFollowingsMap</span><span class="o">;</span> <span class="c1">// user to who he/she is following</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;&gt;</span> <span class="n">userToTweetsMap</span><span class="o">;</span>
        <span class="nc">SeqTime</span> <span class="n">seqTime</span><span class="o">;</span>

        <span class="cm">/** Initialize your data structure here. */</span>
        <span class="kd">public</span> <span class="nf">Twitter</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">userToFollowingsMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
            <span class="n">userToTweetsMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
            <span class="n">seqTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SeqTime</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="cm">/** Compose a new tweet. */</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postTweet</span><span class="o">(</span><span class="kt">int</span> <span class="n">userId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">tweetId</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// init the friend map</span>
            <span class="nc">Tweet</span> <span class="n">tweet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Tweet</span><span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="n">tweetId</span><span class="o">,</span> <span class="n">seqTime</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
            <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">followings</span> <span class="o">=</span> <span class="n">userToFollowingsMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;());</span>
            <span class="n">followings</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">userId</span><span class="o">);</span> <span class="c1">// èªå·±æ¯èªå·±çfriendï¼çèªå·±çtwitt</span>
            <span class="n">userToFollowingsMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="n">followings</span><span class="o">);</span>

            <span class="c1">// save the tweet into the tweetmap</span>
            <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">tweets</span> <span class="o">=</span> <span class="n">userToTweetsMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;(</span>
                <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="o">.</span><span class="na">time</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="na">time</span>
            <span class="o">));</span>
            <span class="n">tweets</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">tweet</span><span class="o">);</span>
            <span class="n">userToTweetsMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="n">tweets</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="cm">/** Retrieve the 10 most recent tweet ids in the user's news feed. Each item in the news feed must be posted by users who the user followed or by the user herself. Tweets must be ordered from most recent to least recent. */</span>
        <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="nf">getNewsFeed</span><span class="o">(</span><span class="kt">int</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">followings</span> <span class="o">=</span> <span class="n">userToFollowingsMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">userId</span><span class="o">);</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">followings</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">followings</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
            <span class="o">}</span>


            <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;&gt;</span> <span class="n">tweetList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">following</span> <span class="o">:</span> <span class="n">followings</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">tweets</span> <span class="o">=</span> <span class="n">userToTweetsMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">following</span><span class="o">);</span>
                <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">top10List</span> <span class="o">=</span> <span class="n">getTop10Tweets</span><span class="o">(</span><span class="n">tweets</span><span class="o">);</span>

                <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">top10List</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(!</span><span class="n">top10List</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">tweetList</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">following</span><span class="o">,</span> <span class="n">top10List</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>

            <span class="k">return</span> <span class="nf">mergeTweets</span><span class="o">(</span><span class="n">tweetList</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="cm">/** Follower follows a followee. If the operation is invalid, it should be a no-op. */</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">follow</span><span class="o">(</span><span class="kt">int</span> <span class="n">followerId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">followeeId</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">followings</span> <span class="o">=</span> <span class="n">userToFollowingsMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">followerId</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;());</span>
            <span class="n">followings</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">followerId</span><span class="o">);</span> <span class="c1">// self follow</span>
            <span class="n">followings</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">followeeId</span><span class="o">);</span>
            <span class="n">userToFollowingsMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">followerId</span><span class="o">,</span> <span class="n">followings</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="cm">/** Follower unfollows a followee. If the operation is invalid, it should be a no-op. */</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">unfollow</span><span class="o">(</span><span class="kt">int</span> <span class="n">followerId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">followeeId</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">followerId</span> <span class="o">==</span> <span class="n">followeeId</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">followings</span> <span class="o">=</span> <span class="n">userToFollowingsMap</span><span class="o">.</span><span class="na">getOrDefault</span><span class="o">(</span><span class="n">followerId</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;());</span>
            <span class="n">followings</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">followeeId</span><span class="o">);</span>
            <span class="n">userToFollowingsMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">followerId</span><span class="o">,</span> <span class="n">followings</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="nf">getTop10Tweets</span><span class="o">(</span><span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">tweets</span><span class="o">)</span> <span class="o">{</span>

            <span class="c1">// most recent at top</span>
            <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">top10Tweets</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;(</span>
                <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="o">.</span><span class="na">time</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="na">time</span>
            <span class="o">);</span>

            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">tweets</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">tweets</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span>

                <span class="n">top10Tweets</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">tweets</span><span class="o">.</span><span class="na">poll</span><span class="o">());</span>
            <span class="o">}</span>

            <span class="c1">// push back</span>
            <span class="nc">Iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">top10Tweets</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">tweets</span><span class="o">.</span><span class="na">offer</span><span class="o">((</span><span class="nc">Tweet</span><span class="o">)</span><span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
            <span class="o">}</span>

            <span class="k">return</span> <span class="n">top10Tweets</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="nf">mergeTweets</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;&gt;</span> <span class="n">tweetLists</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">ans</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
            <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">finalPQ</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;(</span>
                <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="o">.</span><span class="na">time</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="na">time</span>
            <span class="o">);</span>

            <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">userId</span> <span class="o">:</span> <span class="n">tweetLists</span><span class="o">.</span><span class="na">keySet</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">tweets</span> <span class="o">=</span> <span class="n">tweetLists</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">userId</span><span class="o">);</span>
                <span class="nc">Tweet</span> <span class="n">top</span> <span class="o">=</span> <span class="n">tweets</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
                <span class="c1">//tweetLists.put(userId, tweets);</span>
                <span class="n">finalPQ</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">top</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">count</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">tweetLists</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// similar to question for LC281  k-iterators</span>
                <span class="nc">Tweet</span> <span class="n">curr</span> <span class="o">=</span> <span class="n">finalPQ</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
                <span class="n">ans</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">curr</span><span class="o">.</span><span class="na">twitterId</span><span class="o">);</span>
                <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Tweet</span><span class="o">&gt;</span> <span class="n">nextTweetList</span> <span class="o">=</span> <span class="n">tweetLists</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">curr</span><span class="o">.</span><span class="na">userId</span><span class="o">);</span>

                <span class="k">if</span> <span class="o">(!</span><span class="n">nextTweetList</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">finalPQ</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">nextTweetList</span><span class="o">.</span><span class="na">poll</span><span class="o">());</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">tweetLists</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">curr</span><span class="o">.</span><span class="na">userId</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">class</span> <span class="nc">Tweet</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">twitterId</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">userId</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">time</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Tweet</span><span class="o">(</span><span class="kt">int</span> <span class="n">userId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">twitterId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">time</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">userId</span> <span class="o">=</span> <span class="n">userId</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">twitterId</span> <span class="o">=</span> <span class="n">twitterId</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">time</span> <span class="o">=</span> <span class="n">time</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">class</span> <span class="nc">SeqTime</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">time</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">SeqTime</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">time</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getTime</span><span class="o">()</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">curTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">;</span>
            <span class="n">time</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span> <span class="c1">// @note: possible overflow for int</span>
            <span class="k">return</span> <span class="n">curTime</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="cm">/**
 * Your Twitter object will be instantiated and called as such:
 * Twitter obj = new Twitter();
 * obj.postTweet(userId,tweetId);
 * List&lt;Integer&gt; param_2 = obj.getNewsFeed(userId);
 * obj.follow(followerId,followeeId);
 * obj.unfollow(followerId,followeeId);
 */</span>
<span class="o">}</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="c1">// OJ: https://leetcode.com/problems/design-twitter/</span>
<span class="c1">// Time:</span>
<span class="c1">//     * Twitter: O(1)</span>
<span class="c1">//     * getNewsFeed: O(F)</span>
<span class="c1">//     * follow: O(1)</span>
<span class="c1">//     * unfollow: O(1)</span>
<span class="c1">// Space: O(F + R) where F is number of feeds, R is count of follower-followee relationships.</span>
<span class="k">class</span> <span class="nc">Twitter</span> <span class="p">{</span>
<span class="nl">private:</span>
    <span class="n">deque</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">feeds</span><span class="p">;</span>
    <span class="n">unordered_map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">unordered_set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">followerToFollowee</span><span class="p">;</span>
<span class="nl">public:</span>
    <span class="n">Twitter</span><span class="p">()</span> <span class="p">{}</span>
    <span class="kt">void</span> <span class="n">postTweet</span><span class="p">(</span><span class="kt">int</span> <span class="n">userId</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tweetId</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">feeds</span><span class="p">.</span><span class="n">push_front</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span> <span class="n">tweetId</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">getNewsFeed</span><span class="p">(</span><span class="kt">int</span> <span class="n">userId</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
        <span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">feeds</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
        <span class="k">auto</span> <span class="o">&amp;</span><span class="n">followees</span> <span class="o">=</span> <span class="n">followerToFollowee</span><span class="p">[</span><span class="n">userId</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">it</span> <span class="o">!=</span> <span class="n">feeds</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">posterId</span> <span class="o">=</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">first</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">posterId</span> <span class="o">==</span> <span class="n">userId</span>
            <span class="o">||</span> <span class="n">followees</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">posterId</span><span class="p">)</span> <span class="o">!=</span> <span class="n">followees</span><span class="p">.</span><span class="n">end</span><span class="p">())</span> <span class="p">{</span>
                <span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">);</span>
                <span class="o">++</span><span class="n">cnt</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="o">++</span><span class="n">it</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">follow</span><span class="p">(</span><span class="kt">int</span> <span class="n">followerId</span><span class="p">,</span> <span class="kt">int</span> <span class="n">followeeId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">followerId</span> <span class="o">==</span> <span class="n">followeeId</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="n">followerToFollowee</span><span class="p">[</span><span class="n">followerId</span><span class="p">].</span><span class="n">insert</span><span class="p">(</span><span class="n">followeeId</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">unfollow</span><span class="p">(</span><span class="kt">int</span> <span class="n">followerId</span><span class="p">,</span> <span class="kt">int</span> <span class="n">followeeId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">followerId</span> <span class="o">==</span> <span class="n">followeeId</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="n">followerToFollowee</span><span class="p">[</span><span class="n">followerId</span><span class="p">].</span><span class="n">erase</span><span class="p">(</span><span class="n">followeeId</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-python highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="s">'''
heapq.nlargest(n, iterable, key=None) is used to
find the n largest elements from a dataset defined by iterable.


people = [
    {"name": "Alice", "age": 30},
    {"name": "Bob", "age": 25},
    {"name": "Carol", "age": 40},
    {"name": "Dave", "age": 20}
]

# Using nlargest to find the two oldest people
oldest_two = heapq.nlargest(2, people, key=lambda person: person["age"])

print(oldest_two)
# Output: [{'name': 'Carol', 'age': 40}, {'name': 'Alice', 'age': 30}]

'''</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">heapq</span> <span class="kn">import</span> <span class="n">nlargest</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">class</span> <span class="nc">Twitter</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""
        Initialize your data structure here.
        """</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">user_tweets</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">user_following</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tweet_time</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># id =&gt; timestamp
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">postTweet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">userId</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">tweetId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">"""
        Compose a new tweet.
        """</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">time</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">user_tweets</span><span class="p">[</span><span class="n">userId</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">tweetId</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tweet_time</span><span class="p">[</span><span class="n">tweetId</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">time</span>

    <span class="k">def</span> <span class="nf">getNewsFeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">userId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="s">"""
        Retrieve the 10 most recent tweet ids in the user's news feed. Each item in the news feed must be posted by users who the user followed or by the user herself. Tweets must be ordered from most recent to least recent.
        """</span>
        <span class="n">following</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">user_following</span><span class="p">[</span><span class="n">userId</span><span class="p">]</span>
        <span class="n">users</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">following</span><span class="p">)</span>
        <span class="n">users</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">userId</span><span class="p">)</span>  <span class="c1"># should see my own tweets too
</span>        <span class="n">tweets</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">user_tweets</span><span class="p">[</span><span class="n">u</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">users</span><span class="p">]</span>  <span class="c1"># Get the 10 most recent tweets
</span>        <span class="s">'''
        unconventional way to flatten a list of lists into a single list:
            lists = [[1, 2, 3], [4, 5], [6]]
            flattened = sum(lists, [])
            print(flattened)  # Output: [1, 2, 3, 4, 5, 6]

        or, another way getting flattened tweets:
            flattened_tweets = [tweet for each_user_tweets in tweets for tweet in each_user_tweets]
        '''</span>
        <span class="n">tweets</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tweets</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">tweets</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tweet</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">tweet_time</span><span class="p">[</span><span class="n">tweet</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">follow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">followerId</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">followeeId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">"""
        Follower follows a followee. If the operation is invalid, it should be a no-op.
        """</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">user_following</span><span class="p">[</span><span class="n">followerId</span><span class="p">].</span><span class="n">add</span><span class="p">(</span><span class="n">followeeId</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unfollow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">followerId</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">followeeId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">"""
        Follower unfollows a followee. If the operation is invalid, it should be a no-op.
        """</span>
        <span class="n">following</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">user_following</span><span class="p">[</span><span class="n">followerId</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">followeeId</span> <span class="ow">in</span> <span class="n">following</span><span class="p">:</span>
            <span class="n">following</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">followeeId</span><span class="p">)</span>

<span class="c1"># Your Twitter object will be instantiated and called as such:
# obj = Twitter()
# obj.postTweet(userId,tweetId)
# param_2 = obj.getNewsFeed(userId)
# obj.follow(followerId,followeeId)
# obj.unfollow(followerId,followeeId)
</span>
<span class="c1">############
</span>
<span class="kn">import</span> <span class="nn">heapq</span>


<span class="k">class</span> <span class="nc">Twitter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s">"""
    Initialize your data structure here.
    """</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">ts</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">tweets</span> <span class="o">=</span> <span class="n">collections</span><span class="p">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">friendship</span> <span class="o">=</span> <span class="n">collections</span><span class="p">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">postTweet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">userId</span><span class="p">,</span> <span class="n">tweetId</span><span class="p">):</span>
    <span class="s">"""
    Compose a new tweet.
    :type userId: int
    :type tweetId: int
    :rtype: void
    """</span>
    <span class="n">tInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">tweetId</span><span class="p">,</span> <span class="n">userId</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tweets</span><span class="p">[</span><span class="n">userId</span><span class="p">])</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">tweets</span><span class="p">[</span><span class="n">userId</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">tInfo</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">ts</span> <span class="o">-=</span> <span class="mi">1</span>

  <span class="k">def</span> <span class="nf">getNewsFeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">userId</span><span class="p">):</span>
    <span class="s">"""
    Retrieve the 10 most recent tweet ids in the user's news feed. Each item in the news feed must be posted by users who the user followed or by the user herself. Tweets must be ordered from most recent to least recent.
    :type userId: int
    :rtype: List[int]
    """</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">heap</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">tweets</span><span class="p">[</span><span class="n">userId</span><span class="p">]:</span>
      <span class="n">heapq</span><span class="p">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">tweets</span><span class="p">[</span><span class="n">userId</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">followeeId</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">friendship</span><span class="p">[</span><span class="n">userId</span><span class="p">]:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">tweets</span><span class="p">[</span><span class="n">followeeId</span><span class="p">]:</span>
        <span class="n">heapq</span><span class="p">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">tweets</span><span class="p">[</span><span class="n">followeeId</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">while</span> <span class="n">heap</span> <span class="ow">and</span> <span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># not using nlargest()
</span>      <span class="n">_</span><span class="p">,</span> <span class="n">tid</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">heapq</span><span class="p">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span>
      <span class="n">ret</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tid</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">heapq</span><span class="p">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">tweets</span><span class="p">[</span><span class="n">uid</span><span class="p">][</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
      <span class="n">cnt</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">ret</span>

  <span class="k">def</span> <span class="nf">follow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">followerId</span><span class="p">,</span> <span class="n">followeeId</span><span class="p">):</span>
    <span class="s">"""
    Follower follows a followee. If the operation is invalid, it should be a no-op.
    :type followerId: int
    :type followeeId: int
    :rtype: void
    """</span>
    <span class="k">if</span> <span class="n">followerId</span> <span class="o">==</span> <span class="n">followeeId</span><span class="p">:</span>
      <span class="k">return</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">friendship</span><span class="p">[</span><span class="n">followerId</span><span class="p">]</span> <span class="o">|=</span> <span class="p">{</span><span class="n">followeeId</span><span class="p">}</span>

  <span class="k">def</span> <span class="nf">unfollow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">followerId</span><span class="p">,</span> <span class="n">followeeId</span><span class="p">):</span>
    <span class="s">"""
    Follower unfollows a followee. If the operation is invalid, it should be a no-op.
    :type followerId: int
    :type followeeId: int
    :rtype: void
    """</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">friendship</span><span class="p">[</span><span class="n">followerId</span><span class="p">]</span> <span class="o">-=</span> <span class="p">{</span><span class="n">followeeId</span><span class="p">}</span>

<span class="c1"># Your Twitter object will be instantiated and called as such:
# obj = Twitter()
# obj.postTweet(userId,tweetId)
# param_2 = obj.getNewsFeed(userId)
# obj.follow(followerId,followeeId)
# obj.unfollow(followerId,followeeId)
</span>
</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-355.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
