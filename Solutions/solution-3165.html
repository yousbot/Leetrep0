<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-3165.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-3165.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>3165 - Maximum Sum of Subsequence With Non-adjacent Elements</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 3165. Maximum Sum of Subsequence With Non-adjacent Elements Description You are given an array nums consisting of integers. You are also given a 2D array queries, where queries[i] = [posi, xi]. For query i, we first set nums[posi] equal to xi, then we calculate the...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-3165.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-3165.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-3165.html" rel="stylesheet"/>
   <link href="solution-3165.html" rel="stylesheet"/>
   <link href="solution-3165.html" rel="stylesheet"/>
   <link href="solution-3165.html" rel="stylesheet"/>
   <link href="solution-3165.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="3165 - Maximum Sum of Subsequence With Non-adjacent Elements" property="og:title"/>
   <meta content="Leetcode 3165. Maximum Sum of Subsequence With Non-adjacent Elements Description You are given an array nums consisting of integers. You are also given a 2D array queries, where queries[i] = [posi, xi]. For query i, we first set nums[posi] equal to xi, then we calculate the answer to query i which is the maximum sum of a subsequence of nums where no two adjacent elements are selected. Return the sum of the answers to all queries. Since the final answer may be very large, return it modulo 109 + 7. A subsequence is an array that can be derived from another array by deleting some or no elements without changing the order of the remaining elements. &amp;nbsp; Example 1: Input: nums = [3,5,9], queries = [[1,-2],[0,-3]] Output: 21 Explanation: After the 1st query, nums = [3,-2,9] and the maximum sum of a subsequence with non-adjacent elements is 3 + 9 = 12. After the 2nd query, nums = [-3,-2,9] and the maximum sum of a subsequence with non-adjacent elements is 9. Example 2: Input: nums = [0,-1], queries = [[0,-5]] Output: 0 Explanation: After the 1st query, nums = [-5,-1] and the maximum sum of a subsequence with non-adjacent elements is 0 (choosing an empty subsequence). &amp;nbsp; Constraints: 1 &amp;lt;= nums.length &amp;lt;= 5 * 104 -105 &amp;lt;= nums[i] &amp;lt;= 105 1 &amp;lt;= queries.length &amp;lt;= 5 * 104 queries[i] == [posi, xi] 0 &amp;lt;= posi &amp;lt;= nums.length - 1 -105 &amp;lt;= xi &amp;lt;= 105 Solutions Solution 1 Java C++ Python Go TypeScript class Node { int l, r; long s00, s01, s10, s11; Node(int l, int r) { this.l = l; this.r = r; this.s00 = this.s01 = this.s10 = this.s11 = 0; } } class SegmentTree { Node[] tr; SegmentTree(int n) { tr = new Node[n * 4]; build(1, 1, n); } void build(int u, int l, int r) { tr[u] = new Node(l, r); if (l == r) { return; } int mid = (l + r) &amp;gt;&amp;gt; 1; build(u &amp;lt;&amp;lt; 1, l, mid); build(u &amp;lt;&amp;lt; 1 | 1, mid + 1, r); } long query(int u, int l, int r) { if (tr[u].l &amp;gt;= l &amp;amp;&amp;amp; tr[u].r &amp;lt;= r) { return tr[u].s11; } int mid = (tr[u].l + tr[u].r) &amp;gt;&amp;gt; 1; long ans = 0; if (r &amp;lt;= mid) { ans = query(u &amp;lt;&amp;lt; 1, l, r); } if (l &amp;gt; mid) { ans = Math.max(ans, query(u &amp;lt;&amp;lt; 1 | 1, l, r)); } return ans; } void pushup(int u) { Node left = tr[u &amp;lt;&amp;lt; 1]; Node right = tr[u &amp;lt;&amp;lt; 1 | 1]; tr[u].s00 = Math.max(left.s00 + right.s10, left.s01 + right.s00); tr[u].s01 = Math.max(left.s00 + right.s11, left.s01 + right.s01); tr[u].s10 = Math.max(left.s10 + right.s10, left.s11 + right.s00); tr[u].s11 = Math.max(left.s10 + right.s11, left.s11 + right.s01); } void modify(int u, int x, int v) { if (tr[u].l == tr[u].r) { tr[u].s11 = Math.max(0, v); return; } int mid = (tr[u].l + tr[u].r) &amp;gt;&amp;gt; 1; if (x &amp;lt;= mid) { modify(u &amp;lt;&amp;lt; 1, x,..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2024-06-09T00:00:00-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2024-06-09-3165-Maximum-Sum-of-Subsequence-With-Non-adjacent-Elements/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-3165.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="3165 - Maximum Sum of Subsequence With Non-adjacent Elements" property="twitter:title"/>
   <meta content="Leetcode 3165. Maximum Sum of Subsequence With Non-adjacent Elements Description You are given an array nums consisting of integers. You are also given a 2D array queries, where queries[i] = [posi, xi]. For query i, we first set nums[posi] equal to xi, then we calculate the answer to query i which is the maximum sum of a subsequence of nums where no two adjacent elements are selected. Return the sum of the answers to all queries. Since the final answer may be very large, return it modulo 109 + 7. A subsequence is an array that can be derived from another array by deleting some or no elements without changing the order of the remaining elements. &amp;nbsp; Example 1: Input: nums = [3,5,9], queries = [[1,-2],[0,-3]] Output: 21 Explanation: After the 1st query, nums = [3,-2,9] and the maximum sum of a subsequence with non-adjacent elements is 3 + 9 = 12. After the 2nd query, nums = [-3,-2,9] and the maximum sum of a subsequence with non-adjacent elements is 9. Example 2: Input: nums = [0,-1], queries = [[0,-5]] Output: 0 Explanation: After the 1st query, nums = [-5,-1] and the maximum sum of a subsequence with non-adjacent elements is 0 (choosing an empty subsequence). &amp;nbsp; Constraints: 1 &amp;lt;= nums.length &amp;lt;= 5 * 104 -105 &amp;lt;= nums[i] &amp;lt;= 105 1 &amp;lt;= queries.length &amp;lt;= 5 * 104 queries[i] == [posi, xi] 0 &amp;lt;= posi &amp;lt;= nums.length - 1 -105 &amp;lt;= xi &amp;lt;= 105 Solutions Solution 1 Java C++ Python Go TypeScript class Node { int l, r; long s00, s01, s10, s11; Node(int l, int r) { this.l = l; this.r = r; this.s00 = this.s01 = this.s10 = this.s11 = 0; } } class SegmentTree { Node[] tr; SegmentTree(int n) { tr = new Node[n * 4]; build(1, 1, n); } void build(int u, int l, int r) { tr[u] = new Node(l, r); if (l == r) { return; } int mid = (l + r) &amp;gt;&amp;gt; 1; build(u &amp;lt;&amp;lt; 1, l, mid); build(u &amp;lt;&amp;lt; 1 | 1, mid + 1, r); } long query(int u, int l, int r) { if (tr[u].l &amp;gt;= l &amp;amp;&amp;amp; tr[u].r &amp;lt;= r) { return tr[u].s11; } int mid = (tr[u].l + tr[u].r) &amp;gt;&amp;gt; 1; long ans = 0; if (r &amp;lt;= mid) { ans = query(u &amp;lt;&amp;lt; 1, l, r); } if (l &amp;gt; mid) { ans = Math.max(ans, query(u &amp;lt;&amp;lt; 1 | 1, l, r)); } return ans; } void pushup(int u) { Node left = tr[u &amp;lt;&amp;lt; 1]; Node right = tr[u &amp;lt;&amp;lt; 1 | 1]; tr[u].s00 = Math.max(left.s00 + right.s10, left.s01 + right.s00); tr[u].s01 = Math.max(left.s00 + right.s11, left.s01 + right.s01); tr[u].s10 = Math.max(left.s10 + right.s10, left.s11 + right.s00); tr[u].s11 = Math.max(left.s10 + right.s11, left.s11 + right.s01); } void modify(int u, int x, int v) { if (tr[u].l == tr[u].r) { tr[u].s11 = Math.max(0, v); return; } int mid = (tr[u].l + tr[u].r) &amp;gt;&amp;gt; 1; if (x &amp;lt;= mid) { modify(u &amp;lt;&amp;lt; 1, x,..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    3165 - Maximum Sum of Subsequence With Non-adjacent Elements | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="3165 - Maximum Sum of Subsequence With Non-adjacent Elements" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-3165.html" rel="canonical">
          <meta content="https://leetcode.ca/2024-06-09-3165-Maximum-Sum-of-Subsequence-With-Non-adjacent-Elements/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2024-06-09T00:00:00-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"3165 - Maximum Sum of Subsequence With Non-adjacent Elements","dateModified":"2024-06-09T00:00:00-07:00","datePublished":"2024-06-09T00:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2024-06-09-3165-Maximum-Sum-of-Subsequence-With-Non-adjacent-Elements/"},"url":"https://leetcode.ca/2024-06-09-3165-Maximum-Sum-of-Subsequence-With-Non-adjacent-Elements/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <!-- problem:start -->
      <h1 id="3165-maximum-sum-of-subsequence-with-non-adjacent-elements">
       <a href="solution-3165.html">
        3165. Maximum Sum of Subsequence With Non-adjacent Elements
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <!-- description:start -->
      <p>
       You are given an array
       <code>
        nums
       </code>
       consisting of integers. You are also given a 2D array
       <code>
        queries
       </code>
       , where
       <code>
        queries[i] = [pos
        <sub>
         i
        </sub>
        , x
        <sub>
         i
        </sub>
        ]
       </code>
       .
      </p>
      <p>
       For query
       <code>
        i
       </code>
       , we first set
       <code>
        nums[pos
        <sub>
         i
        </sub>
        ]
       </code>
       equal to
       <code>
        x
        <sub>
         i
        </sub>
       </code>
       , then we calculate the answer to query
       <code>
        i
       </code>
       which is the
       <strong>
        maximum
       </strong>
       sum of a
       <span data-keyword="subsequence-array">
        subsequence
       </span>
       of
       <code>
        nums
       </code>
       where
       <strong>
        no two adjacent elements are selected
       </strong>
       .
      </p>
      <p>
       Return the
       <em>
        sum
       </em>
       of the answers to all queries.
      </p>
      <p>
       Since the final answer may be very large, return it
       <strong>
        modulo
       </strong>
       <code>
        10
        <sup>
         9
        </sup>
        + 7
       </code>
       .
      </p>
      <p>
       A
       <strong>
        subsequence
       </strong>
       is an array that can be derived from another array by deleting some or no elements without changing the order of the remaining elements.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <div class="example-block">
       <p>
        <strong>
         Input:
        </strong>
        <span class="example-io">
         nums = [3,5,9], queries = [[1,-2],[0,-3]]
        </span>
       </p>
       <p>
        <strong>
         Output:
        </strong>
        <span class="example-io">
         21
        </span>
       </p>
       <p>
        <strong>
         Explanation:
        </strong>
        <br/>
        After the 1
        <sup>
         st
        </sup>
        query,
        <code>
         nums = [3,-2,9]
        </code>
        and the maximum sum of a subsequence with non-adjacent elements is
        <code>
         3 + 9 = 12
        </code>
        .
        <br/>
        After the 2
        <sup>
         nd
        </sup>
        query,
        <code>
         nums = [-3,-2,9]
        </code>
        and the maximum sum of a subsequence with non-adjacent elements is 9.
       </p>
      </div>
      <p>
       <strong class="example">
        Example 2:
       </strong>
      </p>
      <div class="example-block">
       <p>
        <strong>
         Input:
        </strong>
        <span class="example-io">
         nums = [0,-1], queries = [[0,-5]]
        </span>
       </p>
       <p>
        <strong>
         Output:
        </strong>
        <span class="example-io">
         0
        </span>
       </p>
       <p>
        <strong>
         Explanation:
        </strong>
        <br/>
        After the 1
        <sup>
         st
        </sup>
        query,
        <code>
         nums = [-5,-1]
        </code>
        and the maximum sum of a subsequence with non-adjacent elements is 0 (choosing an empty subsequence).
       </p>
      </div>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         1 &lt;= nums.length &lt;= 5 * 10
         <sup>
          4
         </sup>
        </code>
       </li>
       <li>
        <code>
         -10
         <sup>
          5
         </sup>
         &lt;= nums[i] &lt;= 10
         <sup>
          5
         </sup>
        </code>
       </li>
       <li>
        <code>
         1 &lt;= queries.length &lt;= 5 * 10
         <sup>
          4
         </sup>
        </code>
       </li>
       <li>
        <code>
         queries[i] == [pos
         <sub>
          i
         </sub>
         , x
         <sub>
          i
         </sub>
         ]
        </code>
       </li>
       <li>
        <code>
         0 &lt;= pos
         <sub>
          i
         </sub>
         &lt;= nums.length - 1
        </code>
       </li>
       <li>
        <code>
         -10
         <sup>
          5
         </sup>
         &lt;= x
         <sub>
          i
         </sub>
         &lt;= 10
         <sup>
          5
         </sup>
        </code>
       </li>
      </ul>
      <!-- description:end -->
      <h2 id="solutions">
       Solutions
      </h2>
      <!-- solution:start -->
      <h3 id="solution-1">
       Solution 1
      </h3>
      <ul class="uk-tab" data-uk-switcher="{connect:'#ca8c27a3-e52c-44db-bf1b-823c1d9433ba'}">
       <li class="uk-active">
        <a href="solution-3165.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-3165.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-3165.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-3165.html">
         Go
        </a>
       </li>
       <li>
        <a href="solution-3165.html">
         TypeScript
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="ca8c27a3-e52c-44db-bf1b-823c1d9433ba">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">;</span>
    <span class="kt">long</span> <span class="n">s00</span><span class="o">,</span> <span class="n">s01</span><span class="o">,</span> <span class="n">s10</span><span class="o">,</span> <span class="n">s11</span><span class="o">;</span>

    <span class="nc">Node</span><span class="o">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">,</span> <span class="kt">int</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">s00</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">s01</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">s10</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">s11</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">SegmentTree</span> <span class="o">{</span>
    <span class="nc">Node</span><span class="o">[]</span> <span class="n">tr</span><span class="o">;</span>

    <span class="nc">SegmentTree</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">[</span><span class="n">n</span> <span class="o">*</span> <span class="mi">4</span><span class="o">];</span>
        <span class="n">build</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">build</span><span class="o">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">,</span> <span class="kt">int</span> <span class="n">l</span><span class="o">,</span> <span class="kt">int</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">(</span><span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="o">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="o">;</span>
        <span class="n">build</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">mid</span><span class="o">);</span>
        <span class="n">build</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">r</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kt">long</span> <span class="nf">query</span><span class="o">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">,</span> <span class="kt">int</span> <span class="n">l</span><span class="o">,</span> <span class="kt">int</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">r</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">s11</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="o">(</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">l</span> <span class="o">+</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">r</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="o">;</span>
        <span class="kt">long</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">query</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="n">mid</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">ans</span><span class="o">,</span> <span class="n">query</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">pushup</span><span class="o">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Node</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">];</span>
        <span class="nc">Node</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">];</span>
        <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">s00</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">left</span><span class="o">.</span><span class="na">s00</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="na">s10</span><span class="o">,</span> <span class="n">left</span><span class="o">.</span><span class="na">s01</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="na">s00</span><span class="o">);</span>
        <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">s01</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">left</span><span class="o">.</span><span class="na">s00</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="na">s11</span><span class="o">,</span> <span class="n">left</span><span class="o">.</span><span class="na">s01</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="na">s01</span><span class="o">);</span>
        <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">s10</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">left</span><span class="o">.</span><span class="na">s10</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="na">s10</span><span class="o">,</span> <span class="n">left</span><span class="o">.</span><span class="na">s11</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="na">s00</span><span class="o">);</span>
        <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">s11</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">left</span><span class="o">.</span><span class="na">s10</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="na">s11</span><span class="o">,</span> <span class="n">left</span><span class="o">.</span><span class="na">s11</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="na">s01</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">modify</span><span class="o">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">l</span> <span class="o">==</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">s11</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">v</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="o">(</span><span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">l</span> <span class="o">+</span> <span class="n">tr</span><span class="o">[</span><span class="n">u</span><span class="o">].</span><span class="na">r</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">modify</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">v</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">modify</span><span class="o">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">v</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">pushup</span><span class="o">(</span><span class="n">u</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">maximumSumSubsequence</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">nums</span><span class="o">,</span> <span class="kt">int</span><span class="o">[][]</span> <span class="n">queries</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">nums</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="nc">SegmentTree</span> <span class="n">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SegmentTree</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">tree</span><span class="o">.</span><span class="na">modify</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">nums</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
        <span class="o">}</span>
        <span class="kt">long</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">final</span> <span class="kt">int</span> <span class="n">mod</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="mi">1</span><span class="n">e9</span> <span class="o">+</span> <span class="mi">7</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">q</span> <span class="o">:</span> <span class="n">queries</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">tree</span><span class="o">.</span><span class="na">modify</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">q</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">q</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="o">(</span><span class="n">ans</span> <span class="o">+</span> <span class="n">tree</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">n</span><span class="o">))</span> <span class="o">%</span> <span class="n">mod</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">ans</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Node</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">s00</span><span class="p">,</span> <span class="n">s01</span><span class="p">,</span> <span class="n">s10</span><span class="p">,</span> <span class="n">s11</span><span class="p">;</span>

    <span class="n">Node</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">l</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">r</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">s00</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">s01</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">s10</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">s11</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">SegmentTree</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">*&gt;</span> <span class="n">tr</span><span class="p">;</span>

    <span class="n">SegmentTree</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">tr</span><span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">build</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
        <span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">long</span> <span class="kt">long</span> <span class="n">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">s11</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">l</span> <span class="o">+</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="n">mid</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">pushup</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Node</span><span class="o">*</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">];</span>
        <span class="n">Node</span><span class="o">*</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">];</span>
        <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">s00</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">s00</span> <span class="o">+</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">s10</span><span class="p">,</span> <span class="n">left</span><span class="o">-&gt;</span><span class="n">s01</span> <span class="o">+</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">s00</span><span class="p">);</span>
        <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">s01</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">s00</span> <span class="o">+</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">s11</span><span class="p">,</span> <span class="n">left</span><span class="o">-&gt;</span><span class="n">s01</span> <span class="o">+</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">s01</span><span class="p">);</span>
        <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">s10</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">s10</span> <span class="o">+</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">s10</span><span class="p">,</span> <span class="n">left</span><span class="o">-&gt;</span><span class="n">s11</span> <span class="o">+</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">s00</span><span class="p">);</span>
        <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">s11</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">s10</span> <span class="o">+</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">s11</span><span class="p">,</span> <span class="n">left</span><span class="o">-&gt;</span><span class="n">s11</span> <span class="o">+</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">s01</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">modify</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">l</span> <span class="o">==</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">s11</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="mi">0LL</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span> <span class="n">v</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">l</span> <span class="o">+</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">modify</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">modify</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">pushup</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="o">~</span><span class="n">SegmentTree</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">node</span> <span class="o">:</span> <span class="n">tr</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">delete</span> <span class="n">node</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">maximumSumSubsequence</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">nums</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span> <span class="n">queries</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">nums</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">SegmentTree</span> <span class="n">tree</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">tree</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">const</span> <span class="kt">int</span> <span class="n">mod</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">q</span> <span class="o">:</span> <span class="n">queries</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">tree</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="p">(</span><span class="n">ans</span> <span class="o">+</span> <span class="n">tree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span>


<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="s">"l"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="s">"s00"</span><span class="p">,</span> <span class="s">"s01"</span><span class="p">,</span> <span class="s">"s10"</span><span class="p">,</span> <span class="s">"s11"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">l</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">s00</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">s01</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">s10</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">s11</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">class</span> <span class="nc">SegmentTree</span><span class="p">:</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="s">"tr"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span> <span class="o">|</span> <span class="bp">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">s11</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">mid</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="nf">pushup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">s00</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">s00</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">s10</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">s01</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">s00</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">s01</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">s00</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">s11</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">s01</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">s01</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">s10</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">s10</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">s10</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">s11</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">s00</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">s11</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">s10</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">s11</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">s11</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">s01</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">modify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">s11</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pushup</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">maximumSumSubsequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">queries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">SegmentTree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tree</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">7</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
            <span class="n">tree</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="p">(</span><span class="n">ans</span> <span class="o">+</span> <span class="n">tree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">%</span> <span class="n">mod</span>
        <span class="k">return</span> <span class="n">ans</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">type</span> <span class="n">Node</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">l</span><span class="p">,</span> <span class="n">r</span>               <span class="kt">int</span>
	<span class="n">s00</span><span class="p">,</span> <span class="n">s01</span><span class="p">,</span> <span class="n">s10</span><span class="p">,</span> <span class="n">s11</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">NewNode</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="kt">int</span><span class="p">)</span> <span class="o">*</span><span class="n">Node</span> <span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">Node</span><span class="p">{</span><span class="n">l</span><span class="o">:</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="o">:</span> <span class="n">r</span><span class="p">,</span> <span class="n">s00</span><span class="o">:</span> <span class="m">0</span><span class="p">,</span> <span class="n">s01</span><span class="o">:</span> <span class="m">0</span><span class="p">,</span> <span class="n">s10</span><span class="o">:</span> <span class="m">0</span><span class="p">,</span> <span class="n">s11</span><span class="o">:</span> <span class="m">0</span><span class="p">}</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">SegmentTree</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">tr</span> <span class="p">[]</span><span class="o">*</span><span class="n">Node</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">NewSegmentTree</span><span class="p">(</span><span class="n">n</span> <span class="kt">int</span><span class="p">)</span> <span class="o">*</span><span class="n">SegmentTree</span> <span class="p">{</span>
	<span class="n">tr</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="o">*</span><span class="n">Node</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="m">4</span><span class="p">)</span>
	<span class="n">tree</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">SegmentTree</span><span class="p">{</span><span class="n">tr</span><span class="o">:</span> <span class="n">tr</span><span class="p">}</span>
	<span class="n">tree</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">tree</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">st</span> <span class="o">*</span><span class="n">SegmentTree</span><span class="p">)</span> <span class="n">build</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">NewNode</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">r</span> <span class="p">{</span>
		<span class="k">return</span>
	<span class="p">}</span>
	<span class="n">mid</span> <span class="o">:=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="m">1</span>
	<span class="n">st</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
	<span class="n">st</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="m">1</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">st</span> <span class="o">*</span><span class="n">SegmentTree</span><span class="p">)</span> <span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">s11</span>
	<span class="p">}</span>
	<span class="n">mid</span> <span class="o">:=</span> <span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">l</span> <span class="o">+</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="m">1</span>
	<span class="n">ans</span> <span class="o">:=</span> <span class="m">0</span>
	<span class="k">if</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">mid</span> <span class="p">{</span>
		<span class="n">ans</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">mid</span> <span class="p">{</span>
		<span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ans</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">st</span> <span class="o">*</span><span class="n">SegmentTree</span><span class="p">)</span> <span class="n">pushup</span><span class="p">(</span><span class="n">u</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">left</span> <span class="o">:=</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">]</span>
	<span class="n">right</span> <span class="o">:=</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">]</span>
	<span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">s00</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">s00</span><span class="o">+</span><span class="n">right</span><span class="o">.</span><span class="n">s10</span><span class="p">,</span> <span class="n">left</span><span class="o">.</span><span class="n">s01</span><span class="o">+</span><span class="n">right</span><span class="o">.</span><span class="n">s00</span><span class="p">)</span>
	<span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">s01</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">s00</span><span class="o">+</span><span class="n">right</span><span class="o">.</span><span class="n">s11</span><span class="p">,</span> <span class="n">left</span><span class="o">.</span><span class="n">s01</span><span class="o">+</span><span class="n">right</span><span class="o">.</span><span class="n">s01</span><span class="p">)</span>
	<span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">s10</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">s10</span><span class="o">+</span><span class="n">right</span><span class="o">.</span><span class="n">s10</span><span class="p">,</span> <span class="n">left</span><span class="o">.</span><span class="n">s11</span><span class="o">+</span><span class="n">right</span><span class="o">.</span><span class="n">s00</span><span class="p">)</span>
	<span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">s11</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">s10</span><span class="o">+</span><span class="n">right</span><span class="o">.</span><span class="n">s11</span><span class="p">,</span> <span class="n">left</span><span class="o">.</span><span class="n">s11</span><span class="o">+</span><span class="n">right</span><span class="o">.</span><span class="n">s01</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">st</span> <span class="o">*</span><span class="n">SegmentTree</span><span class="p">)</span> <span class="n">modify</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">l</span> <span class="o">==</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">r</span> <span class="p">{</span>
		<span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">s11</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="p">}</span>
	<span class="n">mid</span> <span class="o">:=</span> <span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">l</span> <span class="o">+</span> <span class="n">st</span><span class="o">.</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="m">1</span>
	<span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">mid</span> <span class="p">{</span>
		<span class="n">st</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">st</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="m">1</span><span class="o">|</span><span class="m">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="n">st</span><span class="o">.</span><span class="n">pushup</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">maximumSumSubsequence</span><span class="p">(</span><span class="n">nums</span> <span class="p">[]</span><span class="kt">int</span><span class="p">,</span> <span class="n">queries</span> <span class="p">[][]</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">ans</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">n</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
	<span class="n">tree</span> <span class="o">:=</span> <span class="n">NewSegmentTree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">nums</span> <span class="p">{</span>
		<span class="n">tree</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="m">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">const</span> <span class="n">mod</span> <span class="kt">int</span> <span class="o">=</span> <span class="m">1e9</span> <span class="o">+</span> <span class="m">7</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">q</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">queries</span> <span class="p">{</span>
		<span class="n">tree</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="o">+</span><span class="m">1</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="m">1</span><span class="p">])</span>
		<span class="n">ans</span> <span class="o">=</span> <span class="p">(</span><span class="n">ans</span> <span class="o">+</span> <span class="n">tree</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">%</span> <span class="n">mod</span>
	<span class="p">}</span>
	<span class="k">return</span>
<span class="p">}</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-ts highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nx">Node</span> <span class="p">{</span>
    <span class="nx">s00</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">s01</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">s10</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">s11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">constructor</span><span class="p">(</span>
        <span class="k">public</span> <span class="nx">l</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
        <span class="k">public</span> <span class="nx">r</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
    <span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">SegmentTree</span> <span class="p">{</span>
    <span class="nl">tr</span><span class="p">:</span> <span class="nx">Node</span><span class="p">[];</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="nx">n</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tr</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">n</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">build</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">build</span><span class="p">(</span><span class="nx">u</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">l</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">r</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Node</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span> <span class="nx">r</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">l</span> <span class="o">===</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">const</span> <span class="nx">mid</span> <span class="o">=</span> <span class="p">(</span><span class="nx">l</span> <span class="o">+</span> <span class="nx">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">build</span><span class="p">(</span><span class="nx">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">mid</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">build</span><span class="p">((</span><span class="nx">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">r</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">query</span><span class="p">(</span><span class="nx">u</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">l</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">r</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">l</span> <span class="o">&gt;=</span> <span class="nx">l</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">r</span> <span class="o">&lt;=</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">s11</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">const</span> <span class="nx">mid</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">l</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">r</span> <span class="o">&lt;=</span> <span class="nx">mid</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ans</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">r</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">l</span> <span class="o">&gt;</span> <span class="nx">mid</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ans</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">ans</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">query</span><span class="p">((</span><span class="nx">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">r</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">ans</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pushup</span><span class="p">(</span><span class="nx">u</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">left</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">];</span>
        <span class="kd">const</span> <span class="nx">right</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[(</span><span class="nx">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="mi">1</span><span class="p">];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">s00</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">left</span><span class="p">.</span><span class="nx">s00</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">s10</span><span class="p">,</span> <span class="nx">left</span><span class="p">.</span><span class="nx">s01</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">s00</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">s01</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">left</span><span class="p">.</span><span class="nx">s00</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">s11</span><span class="p">,</span> <span class="nx">left</span><span class="p">.</span><span class="nx">s01</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">s01</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">s10</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">left</span><span class="p">.</span><span class="nx">s10</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">s10</span><span class="p">,</span> <span class="nx">left</span><span class="p">.</span><span class="nx">s11</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">s00</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">s11</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">left</span><span class="p">.</span><span class="nx">s10</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">s11</span><span class="p">,</span> <span class="nx">left</span><span class="p">.</span><span class="nx">s11</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">s01</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">modify</span><span class="p">(</span><span class="nx">u</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">x</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">v</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">l</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">s11</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">v</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">const</span> <span class="nx">mid</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">l</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">tr</span><span class="p">[</span><span class="nx">u</span><span class="p">].</span><span class="nx">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&lt;=</span> <span class="nx">mid</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">modify</span><span class="p">(</span><span class="nx">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">v</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">modify</span><span class="p">((</span><span class="nx">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">v</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">pushup</span><span class="p">(</span><span class="nx">u</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">maximumSumSubsequence</span><span class="p">(</span><span class="nx">nums</span><span class="p">:</span> <span class="kr">number</span><span class="p">[],</span> <span class="nx">queries</span><span class="p">:</span> <span class="kr">number</span><span class="p">[][]):</span> <span class="kr">number</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">nums</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SegmentTree</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">tree</span><span class="p">.</span><span class="nx">modify</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">nums</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="nx">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">mod</span> <span class="o">=</span> <span class="mi">1</span><span class="nx">e9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">i</span><span class="p">,</span> <span class="nx">x</span><span class="p">]</span> <span class="k">of</span> <span class="nx">queries</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">tree</span><span class="p">.</span><span class="nx">modify</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
        <span class="nx">ans</span> <span class="o">=</span> <span class="p">(</span><span class="nx">ans</span> <span class="o">+</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">n</span><span class="p">))</span> <span class="o">%</span> <span class="nx">mod</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">ans</span><span class="p">;</span>
<span class="p">}</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-3165.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
