<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-3236.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-3236.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>3236 - CEO Subordinate Hierarchy</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 3236. CEO Subordinate Hierarchy ð Description Table: Employees ++ \| Column Name \| Type \| ++ \| employee_id \| int \| \| employee_name \| varchar \| \| manager_id \| int \| \| salary \| int \| ++ employee_id is the unique identifier for this table....">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-3236.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-3236.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-3236.html" rel="stylesheet"/>
   <link href="solution-3236.html" rel="stylesheet"/>
   <link href="solution-3236.html" rel="stylesheet"/>
   <link href="solution-3236.html" rel="stylesheet"/>
   <link href="solution-3236.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="3236 - CEO Subordinate Hierarchy" property="og:title"/>
   <meta content="Leetcode 3236. CEO Subordinate Hierarchy ð Description Table: Employees ++ \| Column Name \| Type \| ++ \| employee_id \| int \| \| employee_name \| varchar \| \| manager_id \| int \| \| salary \| int \| ++ employee_id is the unique identifier for this table. manager_id is the employee_id of the employee&amp;#39;s manager. The CEO has a NULL manager_id. Write a solution to find subordinates of the CEO (both direct and indirect), along with their level in the hierarchy and their salary difference from the CEO. The result should have the following columns: The query result format is in the following example. subordinate_id: The employee_id of the subordinate subordinate_name: The name of the subordinate hierarchy_level: The level of the subordinate in the hierarchy (1 for direct reports, 2 for their direct reports, and so on) salary_difference: The difference between the subordinate&amp;#39;s salary and the CEO&amp;#39;s salary Return the result table ordered by hierarchy_level ascending, and then by subordinate_id ascending. The query result format is in the following example. &amp;nbsp; Example: Input: Employees table: +-++ \| employee_id \| employee_name \| manager_id \| salary \| +-++ \| 1 \| Alice \| NULL \| 150000 \| \| 2 \| Bob \| 1 \| 120000 \| \| 3 \| Charlie \| 1 \| 110000 \| \| 4 \| David \| 2 \| 105000 \| \| 5 \| Eve \| 2 \| 100000 \| \| 6 \| Frank \| 3 \| 95000 \| \| 7 \| Grace \| 3 \| 98000 \| \| 8 \| Helen \| 5 \| 90000 \| +-++ Output: +-+++-+ \| 2 \| Bob \| 1 \| -30000 \| \| 3 \| Charlie \| 1 \| -40000 \| \| 4 \| David \| 2 \| -45000 \| \| 5 \| Eve \| 2 \| -50000 \| \| 6 \| Frank \| 2 \| -55000 \| \| 7 \| Grace \| 2 \| -52000 \| \| 8 \| Helen \| 3 \| -60000 \| +----+ Explanation: Bob and Charlie are direct subordinates of Alice (CEO) and thus have a hierarchy_level of 1. David and Eve report to Bob, while Frank and Grace report to Charlie, making them second-level subordinates (hierarchy_level 2). Helen reports to Eve, making Helen a third-level subordinate (hierarchy_level 3). Salary differences are calculated relative to Alice&amp;#39;s salary of 150000. The result is ordered by hierarchy_level ascending, and then by subordinate_id ascending. Note: The output is ordered first by hierarchy_level in ascending order, then by subordinate_id in ascending order. Solutions Solution 1: Recursive CTE + Join First, we use a recursive CTE to calculate the hierarchy level of each employee, where the CEOâs level is $0$. We save employee_id, employee_name, hierarchy_level, manager_id, and salary into a temporary table T. Then, we query the CEOâs salary and save it into a temporary table P. Finally, we join tables T and P to calculate the salary difference for each subordinate, and sort by hierarchy_level and subordinate_id. SQL # Write your MySQL query statement below WITH RECURSIVE T..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2024-08-14T00:00:00-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2024-08-14-3236-CEO-Subordinate-Hierarchy/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-3236.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="3236 - CEO Subordinate Hierarchy" property="twitter:title"/>
   <meta content="Leetcode 3236. CEO Subordinate Hierarchy ð Description Table: Employees ++ \| Column Name \| Type \| ++ \| employee_id \| int \| \| employee_name \| varchar \| \| manager_id \| int \| \| salary \| int \| ++ employee_id is the unique identifier for this table. manager_id is the employee_id of the employee&amp;#39;s manager. The CEO has a NULL manager_id. Write a solution to find subordinates of the CEO (both direct and indirect), along with their level in the hierarchy and their salary difference from the CEO. The result should have the following columns: The query result format is in the following example. subordinate_id: The employee_id of the subordinate subordinate_name: The name of the subordinate hierarchy_level: The level of the subordinate in the hierarchy (1 for direct reports, 2 for their direct reports, and so on) salary_difference: The difference between the subordinate&amp;#39;s salary and the CEO&amp;#39;s salary Return the result table ordered by hierarchy_level ascending, and then by subordinate_id ascending. The query result format is in the following example. &amp;nbsp; Example: Input: Employees table: +-++ \| employee_id \| employee_name \| manager_id \| salary \| +-++ \| 1 \| Alice \| NULL \| 150000 \| \| 2 \| Bob \| 1 \| 120000 \| \| 3 \| Charlie \| 1 \| 110000 \| \| 4 \| David \| 2 \| 105000 \| \| 5 \| Eve \| 2 \| 100000 \| \| 6 \| Frank \| 3 \| 95000 \| \| 7 \| Grace \| 3 \| 98000 \| \| 8 \| Helen \| 5 \| 90000 \| +-++ Output: +-+++-+ \| 2 \| Bob \| 1 \| -30000 \| \| 3 \| Charlie \| 1 \| -40000 \| \| 4 \| David \| 2 \| -45000 \| \| 5 \| Eve \| 2 \| -50000 \| \| 6 \| Frank \| 2 \| -55000 \| \| 7 \| Grace \| 2 \| -52000 \| \| 8 \| Helen \| 3 \| -60000 \| +----+ Explanation: Bob and Charlie are direct subordinates of Alice (CEO) and thus have a hierarchy_level of 1. David and Eve report to Bob, while Frank and Grace report to Charlie, making them second-level subordinates (hierarchy_level 2). Helen reports to Eve, making Helen a third-level subordinate (hierarchy_level 3). Salary differences are calculated relative to Alice&amp;#39;s salary of 150000. The result is ordered by hierarchy_level ascending, and then by subordinate_id ascending. Note: The output is ordered first by hierarchy_level in ascending order, then by subordinate_id in ascending order. Solutions Solution 1: Recursive CTE + Join First, we use a recursive CTE to calculate the hierarchy level of each employee, where the CEOâs level is $0$. We save employee_id, employee_name, hierarchy_level, manager_id, and salary into a temporary table T. Then, we query the CEOâs salary and save it into a temporary table P. Finally, we join tables T and P to calculate the salary difference for each subordinate, and sort by hierarchy_level and subordinate_id. SQL # Write your MySQL query statement below WITH RECURSIVE T..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    3236 - CEO Subordinate Hierarchy | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="3236 - CEO Subordinate Hierarchy" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-3236.html" rel="canonical">
          <meta content="https://leetcode.ca/2024-08-14-3236-CEO-Subordinate-Hierarchy/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2024-08-14T00:00:00-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"3236 - CEO Subordinate Hierarchy","dateModified":"2024-08-14T00:00:00-07:00","datePublished":"2024-08-14T00:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2024-08-14-3236-CEO-Subordinate-Hierarchy/"},"url":"https://leetcode.ca/2024-08-14-3236-CEO-Subordinate-Hierarchy/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <!-- problem:start -->
      <h1 id="3236-ceo-subordinate-hierarchy-">
       <a href="solution-3236.html">
        3236. CEO Subordinate Hierarchy ð
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <!-- description:start -->
      <p>
       Table:
       <code>
        Employees
       </code>
      </p>
      <pre>
++
\| Column Name   \| Type    \|
++
\| employee_id   \| int     \|
\| employee_name \| varchar \|
\| manager_id    \| int     \|
\| salary        \| int     \|
++
employee_id is the unique identifier for this table.
manager_id is the employee_id of the employee's manager. The CEO has a NULL manager_id.
</pre>
      <p>
       Write a solution to find subordinates of the CEO (both
       <strong>
        direct
       </strong>
       and
       <strong>
        indirect
       </strong>
       ), along with their
       <strong>
        level in the hierarchy
       </strong>
       and their
       <strong>
        salary difference
       </strong>
       from the CEO.
      </p>
      <p>
       The result should have the following columns:
      </p>
      <p>
       The query result format is in the following example.
      </p>
      <ul>
       <li>
        <code>
         subordinate_id
        </code>
        : The employee_id of the subordinate
       </li>
       <li>
        <code>
         subordinate_name
        </code>
        : The name of the subordinate
       </li>
       <li>
        <code>
         hierarchy_level
        </code>
        : The level of the subordinate in the hierarchy (
        <code>
         1
        </code>
        for
        <strong>
         direct
        </strong>
        reports,
        <code>
         2
        </code>
        for
        <strong>
         their direct
        </strong>
        reports, and
        <strong>
         so on
        </strong>
        )
       </li>
       <li>
        <code>
         salary_difference
        </code>
        : The difference between the subordinate's salary and the CEO's salary
       </li>
      </ul>
      <p>
       Return
       <em>
        the result table ordered by
       </em>
       <code>
        hierarchy_level
       </code>
       <em>
        <strong>
         ascending
        </strong>
       </em>
       ,
       <em>
        and then by
       </em>
       <code>
        subordinate_id
       </code>
       <em>
        <strong>
         ascending
        </strong>
       </em>
       .
      </p>
      <p>
       The query result format is in the following example.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example:
       </strong>
      </p>
      <div class="example-block">
       <p>
        <strong>
         Input:
        </strong>
       </p>
       <p>
        <code>
         Employees
        </code>
        table:
       </p>
       <pre class="example-io">
+-++
\| employee_id \| employee_name  \| manager_id \| salary  \|
+-++
\| 1           \| Alice          \| NULL       \| 150000  \|
\| 2           \| Bob            \| 1          \| 120000  \|
\| 3           \| Charlie        \| 1          \| 110000  \|
\| 4           \| David          \| 2          \| 105000  \|
\| 5           \| Eve            \| 2          \| 100000  \|
\| 6           \| Frank          \| 3          \| 95000   \|
\| 7           \| Grace          \| 3          \| 98000   \|
\| 8           \| Helen          \| 5          \| 90000   \|
+-++
</pre>
       <p>
        <strong>
         Output:
        </strong>
       </p>
       <pre class="example-io">
+-+++-+
\| 2              \| Bob              \| 1                \| -30000            \|
\| 3              \| Charlie          \| 1                \| -40000            \|
\| 4              \| David            \| 2                \| -45000            \|
\| 5              \| Eve              \| 2                \| -50000            \|
\| 6              \| Frank            \| 2                \| -55000            \|
\| 7              \| Grace            \| 2                \| -52000            \|
\| 8              \| Helen            \| 3                \| -60000            \|
+----+
</pre>
       <p>
        <strong>
         Explanation:
        </strong>
       </p>
       <ul>
        <li>
         Bob and Charlie are direct subordinates of Alice (CEO) and thus have a hierarchy_level of 1.
        </li>
        <li>
         David and Eve report to Bob, while Frank and Grace report to Charlie, making them second-level subordinates (hierarchy_level 2).
        </li>
        <li>
         Helen reports to Eve, making Helen a third-level subordinate (hierarchy_level 3).
        </li>
        <li>
         Salary differences are calculated relative to Alice's salary of 150000.
        </li>
        <li>
         The result is ordered by hierarchy_level ascending, and then by subordinate_id ascending.
        </li>
       </ul>
       <p>
        <strong>
         Note:
        </strong>
        The output is ordered first by hierarchy_level in ascending order, then by subordinate_id in ascending order.
       </p>
      </div>
      <!-- description:end -->
      <h2 id="solutions">
       Solutions
      </h2>
      <!-- solution:start -->
      <h3 id="solution-1-recursive-cte--join">
       Solution 1: Recursive CTE + Join
      </h3>
      <p>
       First, we use a recursive CTE to calculate the hierarchy level of each employee, where the CEOâs level is $0$. We save
       <code class="language-plaintext highlighter-rouge">
        employee_id
       </code>
       ,
       <code class="language-plaintext highlighter-rouge">
        employee_name
       </code>
       ,
       <code class="language-plaintext highlighter-rouge">
        hierarchy_level
       </code>
       ,
       <code class="language-plaintext highlighter-rouge">
        manager_id
       </code>
       , and
       <code class="language-plaintext highlighter-rouge">
        salary
       </code>
       into a temporary table
       <code class="language-plaintext highlighter-rouge">
        T
       </code>
       .
      </p>
      <p>
       Then, we query the CEOâs salary and save it into a temporary table
       <code class="language-plaintext highlighter-rouge">
        P
       </code>
       .
      </p>
      <p>
       Finally, we join tables
       <code class="language-plaintext highlighter-rouge">
        T
       </code>
       and
       <code class="language-plaintext highlighter-rouge">
        P
       </code>
       to calculate the salary difference for each subordinate, and sort by
       <code class="language-plaintext highlighter-rouge">
        hierarchy_level
       </code>
       and
       <code class="language-plaintext highlighter-rouge">
        subordinate_id
       </code>
       .
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#5168e05f-b1ca-4947-9f1b-3a5f13e613ed'}">
       <li class="uk-active">
        <a href="solution-3236.html">
         SQL
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="5168e05f-b1ca-4947-9f1b-3a5f13e613ed">
       <li>
        <div class="language-sql highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">WITH</span> <span class="k">RECURSIVE</span>
    <span class="n">T</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span>
            <span class="n">employee_id</span><span class="p">,</span>
            <span class="n">employee_name</span><span class="p">,</span>
            <span class="mi">0</span> <span class="k">AS</span> <span class="n">hierarchy_level</span><span class="p">,</span>
            <span class="n">manager_id</span><span class="p">,</span>
            <span class="n">salary</span>
        <span class="k">FROM</span> <span class="n">Employees</span>
        <span class="k">WHERE</span> <span class="n">manager_id</span> <span class="k">IS</span> <span class="k">NULL</span>
        <span class="k">UNION</span> <span class="k">ALL</span>
        <span class="k">SELECT</span>
            <span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="p">,</span>
            <span class="n">e</span><span class="p">.</span><span class="n">employee_name</span><span class="p">,</span>
            <span class="n">hierarchy_level</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">hierarchy_level</span><span class="p">,</span>
            <span class="n">e</span><span class="p">.</span><span class="n">manager_id</span><span class="p">,</span>
            <span class="n">e</span><span class="p">.</span><span class="n">salary</span>
        <span class="k">FROM</span>
            <span class="n">T</span> <span class="n">t</span>
            <span class="k">JOIN</span> <span class="n">Employees</span> <span class="n">e</span> <span class="k">ON</span> <span class="n">t</span><span class="p">.</span><span class="n">employee_id</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">manager_id</span>
    <span class="p">),</span>
    <span class="n">P</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">salary</span>
        <span class="k">FROM</span> <span class="n">Employees</span>
        <span class="k">WHERE</span> <span class="n">manager_id</span> <span class="k">IS</span> <span class="k">NULL</span>
    <span class="p">)</span>
<span class="k">SELECT</span>
    <span class="n">employee_id</span> <span class="n">subordinate_id</span><span class="p">,</span>
    <span class="n">employee_name</span> <span class="n">subordinate_name</span><span class="p">,</span>
    <span class="n">hierarchy_level</span><span class="p">,</span>
    <span class="n">t</span><span class="p">.</span><span class="n">salary</span> <span class="o">-</span> <span class="n">p</span><span class="p">.</span><span class="n">salary</span> <span class="n">salary_difference</span>
<span class="k">FROM</span>
    <span class="n">T</span> <span class="n">t</span>
    <span class="k">JOIN</span> <span class="n">P</span> <span class="n">p</span>
<span class="k">WHERE</span> <span class="n">hierarchy_level</span> <span class="o">!=</span> <span class="mi">0</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-3236.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
