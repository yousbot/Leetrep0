<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-1912.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-1912.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>1912 - Design Movie Rental System</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 1912. Design Movie Rental System Description You have a movie renting company consisting of n shops. You want to implement a renting system that supports searching for, booking, and returning movies. The system should also support generating a report of the currently rented movies. Each...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-1912.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-1912.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-1912.html" rel="stylesheet"/>
   <link href="solution-1912.html" rel="stylesheet"/>
   <link href="solution-1912.html" rel="stylesheet"/>
   <link href="solution-1912.html" rel="stylesheet"/>
   <link href="solution-1912.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="1912 - Design Movie Rental System" property="og:title"/>
   <meta content="Leetcode 1912. Design Movie Rental System Description You have a movie renting company consisting of n shops. You want to implement a renting system that supports searching for, booking, and returning movies. The system should also support generating a report of the currently rented movies. Each movie is given as a 2D integer array entries where entries[i] = [shopi, moviei, pricei] indicates that there is a copy of movie moviei at shop shopi with a rental price of pricei. Each shop carries at most one copy of a movie moviei. The system should support the following functions: Search: Finds the cheapest 5 shops that have an unrented copy of a given movie. The shops should be sorted by price in ascending order, and in case of a tie, the one with the smaller shopi should appear first. If there are less than 5 matching shops, then all of them should be returned. If no shop has an unrented copy, then an empty list should be returned. Rent: Rents an unrented copy of a given movie from a given shop. Drop: Drops off a previously rented copy of a given movie at a given shop. Report: Returns the cheapest 5 rented movies (possibly of the same movie ID) as a 2D list res where res[j] = [shopj, moviej] describes that the jth cheapest rented movie moviej was rented from the shop shopj. The movies in res should be sorted by price in ascending order, and in case of a tie, the one with the smaller shopj should appear first, and if there is still tie, the one with the smaller moviej should appear first. If there are fewer than 5 rented movies, then all of them should be returned. If no movies are currently being rented, then an empty list should be returned. Implement the MovieRentingSystem class: MovieRentingSystem(int n, int[][] entries) Initializes the MovieRentingSystem object with n shops and the movies in entries. List&amp;lt;Integer&amp;gt; search(int movie) Returns a list of shops that have an unrented copy of the given movie as described above. void rent(int shop, int movie) Rents the given movie from the given shop. void drop(int shop, int movie) Drops off a previously rented movie at the given shop. List&amp;lt;List&amp;lt;Integer&amp;gt;&amp;gt; report() Returns a list of cheapest rented movies as described above. Note: The test cases will be generated such that rent will only be called if the shop has an unrented copy of the movie, and drop will only be called if the shop had previously rented out the movie. &amp;nbsp; Example 1: Input [&amp;quot;MovieRentingSystem&amp;quot;, &amp;quot;search&amp;quot;, &amp;quot;rent&amp;quot;, &amp;quot;rent&amp;quot;, &amp;quot;report&amp;quot;, &amp;quot;drop&amp;quot;, &amp;quot;search&amp;quot;] [[3, [[0, 1, 5], [0, 2, 6], [0, 3, 7], [1, 1, 4], [1, 2, 7], [2, 1, 5]]], [1], [0, 1], [1, 2], [], [1, 2], [2]] Output [null, [1, 0, 2], null, null, [[0, 1], [1, 2]], null, [0, 1]] Explanation MovieRentingSystem movieRentingSystem = new MovieRentingSystem(3, [[0, 1, 5], [0, 2, 6], [0, 3, 7], [1, 1, 4], [1, 2, 7], [2,..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2021-02-23T00:00:00-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2021-02-23-1912-Design-Movie-Rental-System/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-1912.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="1912 - Design Movie Rental System" property="twitter:title"/>
   <meta content="Leetcode 1912. Design Movie Rental System Description You have a movie renting company consisting of n shops. You want to implement a renting system that supports searching for, booking, and returning movies. The system should also support generating a report of the currently rented movies. Each movie is given as a 2D integer array entries where entries[i] = [shopi, moviei, pricei] indicates that there is a copy of movie moviei at shop shopi with a rental price of pricei. Each shop carries at most one copy of a movie moviei. The system should support the following functions: Search: Finds the cheapest 5 shops that have an unrented copy of a given movie. The shops should be sorted by price in ascending order, and in case of a tie, the one with the smaller shopi should appear first. If there are less than 5 matching shops, then all of them should be returned. If no shop has an unrented copy, then an empty list should be returned. Rent: Rents an unrented copy of a given movie from a given shop. Drop: Drops off a previously rented copy of a given movie at a given shop. Report: Returns the cheapest 5 rented movies (possibly of the same movie ID) as a 2D list res where res[j] = [shopj, moviej] describes that the jth cheapest rented movie moviej was rented from the shop shopj. The movies in res should be sorted by price in ascending order, and in case of a tie, the one with the smaller shopj should appear first, and if there is still tie, the one with the smaller moviej should appear first. If there are fewer than 5 rented movies, then all of them should be returned. If no movies are currently being rented, then an empty list should be returned. Implement the MovieRentingSystem class: MovieRentingSystem(int n, int[][] entries) Initializes the MovieRentingSystem object with n shops and the movies in entries. List&amp;lt;Integer&amp;gt; search(int movie) Returns a list of shops that have an unrented copy of the given movie as described above. void rent(int shop, int movie) Rents the given movie from the given shop. void drop(int shop, int movie) Drops off a previously rented movie at the given shop. List&amp;lt;List&amp;lt;Integer&amp;gt;&amp;gt; report() Returns a list of cheapest rented movies as described above. Note: The test cases will be generated such that rent will only be called if the shop has an unrented copy of the movie, and drop will only be called if the shop had previously rented out the movie. &amp;nbsp; Example 1: Input [&amp;quot;MovieRentingSystem&amp;quot;, &amp;quot;search&amp;quot;, &amp;quot;rent&amp;quot;, &amp;quot;rent&amp;quot;, &amp;quot;report&amp;quot;, &amp;quot;drop&amp;quot;, &amp;quot;search&amp;quot;] [[3, [[0, 1, 5], [0, 2, 6], [0, 3, 7], [1, 1, 4], [1, 2, 7], [2, 1, 5]]], [1], [0, 1], [1, 2], [], [1, 2], [2]] Output [null, [1, 0, 2], null, null, [[0, 1], [1, 2]], null, [0, 1]] Explanation MovieRentingSystem movieRentingSystem = new MovieRentingSystem(3, [[0, 1, 5], [0, 2, 6], [0, 3, 7], [1, 1, 4], [1, 2, 7], [2,..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    1912 - Design Movie Rental System | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="1912 - Design Movie Rental System" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-1912.html" rel="canonical">
          <meta content="https://leetcode.ca/2021-02-23-1912-Design-Movie-Rental-System/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2021-02-23T00:00:00-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"1912 - Design Movie Rental System","dateModified":"2021-02-23T00:00:00-08:00","datePublished":"2021-02-23T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2021-02-23-1912-Design-Movie-Rental-System/"},"url":"https://leetcode.ca/2021-02-23-1912-Design-Movie-Rental-System/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="1912-design-movie-rental-system">
       <a href="solution-1912.html">
        1912. Design Movie Rental System
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       You have a movie renting company consisting of
       <code>
        n
       </code>
       shops. You want to implement a renting system that supports searching for, booking, and returning movies. The system should also support generating a report of the currently rented movies.
      </p>
      <p>
       Each movie is given as a 2D integer array
       <code>
        entries
       </code>
       where
       <code>
        entries[i] = [shop
        <sub>
         i
        </sub>
        , movie
        <sub>
         i
        </sub>
        , price
        <sub>
         i
        </sub>
        ]
       </code>
       indicates that there is a copy of movie
       <code>
        movie
        <sub>
         i
        </sub>
       </code>
       at shop
       <code>
        shop
        <sub>
         i
        </sub>
       </code>
       with a rental price of
       <code>
        price
        <sub>
         i
        </sub>
       </code>
       . Each shop carries
       <strong>
        at most one
       </strong>
       copy of a movie
       <code>
        movie
        <sub>
         i
        </sub>
       </code>
       .
      </p>
      <p>
       The system should support the following functions:
      </p>
      <ul>
       <li>
        <strong>
         Search
        </strong>
        : Finds the
        <strong>
         cheapest 5 shops
        </strong>
        that have an
        <strong>
         unrented copy
        </strong>
        of a given movie. The shops should be sorted by
        <strong>
         price
        </strong>
        in ascending order, and in case of a tie, the one with the
        <strong>
         smaller
        </strong>
        <code>
         shop
         <sub>
          i
         </sub>
        </code>
        should appear first. If there are less than 5 matching shops, then all of them should be returned. If no shop has an unrented copy, then an empty list should be returned.
       </li>
       <li>
        <strong>
         Rent
        </strong>
        : Rents an
        <strong>
         unrented copy
        </strong>
        of a given movie from a given shop.
       </li>
       <li>
        <strong>
         Drop
        </strong>
        : Drops off a
        <strong>
         previously rented copy
        </strong>
        of a given movie at a given shop.
       </li>
       <li>
        <strong>
         Report
        </strong>
        : Returns the
        <strong>
         cheapest 5 rented movies
        </strong>
        (possibly of the same movie ID) as a 2D list
        <code>
         res
        </code>
        where
        <code>
         res[j] = [shop
         <sub>
          j
         </sub>
         , movie
         <sub>
          j
         </sub>
         ]
        </code>
        describes that the
        <code>
         j
         <sup>
          th
         </sup>
        </code>
        cheapest rented movie
        <code>
         movie
         <sub>
          j
         </sub>
        </code>
        was rented from the shop
        <code>
         shop
         <sub>
          j
         </sub>
        </code>
        . The movies in
        <code>
         res
        </code>
        should be sorted by
        <strong>
         price
        </strong>
        in ascending order, and in case of a tie, the one with the
        <strong>
         smaller
        </strong>
        <code>
         shop
         <sub>
          j
         </sub>
        </code>
        should appear first, and if there is still tie, the one with the
        <strong>
         smaller
        </strong>
        <code>
         movie
         <sub>
          j
         </sub>
        </code>
        should appear first. If there are fewer than 5 rented movies, then all of them should be returned. If no movies are currently being rented, then an empty list should be returned.
       </li>
      </ul>
      <p>
       Implement the
       <code>
        MovieRentingSystem
       </code>
       class:
      </p>
      <ul>
       <li>
        <code>
         MovieRentingSystem(int n, int[][] entries)
        </code>
        Initializes the
        <code>
         MovieRentingSystem
        </code>
        object with
        <code>
         n
        </code>
        shops and the movies in
        <code>
         entries
        </code>
        .
       </li>
       <li>
        <code>
         List&lt;Integer&gt; search(int movie)
        </code>
        Returns a list of shops that have an
        <strong>
         unrented copy
        </strong>
        of the given
        <code>
         movie
        </code>
        as described above.
       </li>
       <li>
        <code>
         void rent(int shop, int movie)
        </code>
        Rents the given
        <code>
         movie
        </code>
        from the given
        <code>
         shop
        </code>
        .
       </li>
       <li>
        <code>
         void drop(int shop, int movie)
        </code>
        Drops off a previously rented
        <code>
         movie
        </code>
        at the given
        <code>
         shop
        </code>
        .
       </li>
       <li>
        <code>
         List&lt;List&lt;Integer&gt;&gt; report()
        </code>
        Returns a list of cheapest
        <strong>
         rented
        </strong>
        movies as described above.
       </li>
      </ul>
      <p>
       <strong>
        Note:
       </strong>
       The test cases will be generated such that
       <code>
        rent
       </code>
       will only be called if the shop has an
       <strong>
        unrented
       </strong>
       copy of the movie, and
       <code>
        drop
       </code>
       will only be called if the shop had
       <strong>
        previously rented
       </strong>
       out the movie.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input</strong>
["MovieRentingSystem", "search", "rent", "rent", "report", "drop", "search"]
[[3, [[0, 1, 5], [0, 2, 6], [0, 3, 7], [1, 1, 4], [1, 2, 7], [2, 1, 5]]], [1], [0, 1], [1, 2], [], [1, 2], [2]]
<strong>Output</strong>
[null, [1, 0, 2], null, null, [[0, 1], [1, 2]], null, [0, 1]]

<strong>Explanation</strong>
MovieRentingSystem movieRentingSystem = new MovieRentingSystem(3, [[0, 1, 5], [0, 2, 6], [0, 3, 7], [1, 1, 4], [1, 2, 7], [2, 1, 5]]);
movieRentingSystem.search(1);  // return [1, 0, 2], Movies of ID 1 are unrented at shops 1, 0, and 2. Shop 1 is cheapest; shop 0 and 2 are the same price, so order by shop number.
movieRentingSystem.rent(0, 1); // Rent movie 1 from shop 0. Unrented movies at shop 0 are now [2,3].
movieRentingSystem.rent(1, 2); // Rent movie 2 from shop 1. Unrented movies at shop 1 are now [1].
movieRentingSystem.report();   // return [[0, 1], [1, 2]]. Movie 1 from shop 0 is cheapest, followed by movie 2 from shop 1.
movieRentingSystem.drop(1, 2); // Drop off movie 2 at shop 1. Unrented movies at shop 1 are now [1,2].
movieRentingSystem.search(2);  // return [0, 1]. Movies of ID 2 are unrented at shops 0 and 1. Shop 0 is cheapest, followed by shop 1.
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         1 &lt;= n &lt;= 3 * 10
         <sup>
          5
         </sup>
        </code>
       </li>
       <li>
        <code>
         1 &lt;= entries.length &lt;= 10
         <sup>
          5
         </sup>
        </code>
       </li>
       <li>
        <code>
         0 &lt;= shop
         <sub>
          i
         </sub>
         &lt; n
        </code>
       </li>
       <li>
        <code>
         1 &lt;= movie
         <sub>
          i
         </sub>
         , price
         <sub>
          i
         </sub>
         &lt;= 10
         <sup>
          4
         </sup>
        </code>
       </li>
       <li>
        Each shop carries
        <strong>
         at most one
        </strong>
        copy of a movie
        <code>
         movie
         <sub>
          i
         </sub>
        </code>
        .
       </li>
       <li>
        At most
        <code>
         10
         <sup>
          5
         </sup>
        </code>
        calls
        <strong>
         in total
        </strong>
        will be made to
        <code>
         search
        </code>
        ,
        <code>
         rent
        </code>
        ,
        <code>
         drop
        </code>
        and
        <code>
         report
        </code>
        .
       </li>
      </ul>
      <h2 id="solutions">
       Solutions
      </h2>
      <p>
       <strong>
        Intuition
       </strong>
       : Since
       <code class="language-plaintext highlighter-rouge">
        search
       </code>
       is reporting
       <code class="language-plaintext highlighter-rouge">
        unrented
       </code>
       movies while
       <code class="language-plaintext highlighter-rouge">
        report
       </code>
       is reporting
       <code class="language-plaintext highlighter-rouge">
        rented
       </code>
       movies, we can use two data structures to store
       <code class="language-plaintext highlighter-rouge">
        unrented
       </code>
       and
       <code class="language-plaintext highlighter-rouge">
        rented
       </code>
       movies, and
       <code class="language-plaintext highlighter-rouge">
        rent
       </code>
       and
       <code class="language-plaintext highlighter-rouge">
        drop
       </code>
       just moves the entry between these two data structures.
      </p>
      <p>
       <strong>
        Algorithm
       </strong>
       :
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        search
       </code>
       : for a specific
       <code class="language-plaintext highlighter-rouge">
        movie
       </code>
       , we need the cheapest 5
       <code class="language-plaintext highlighter-rouge">
        {price, shop}
       </code>
       pairs. So we can use
       <code class="language-plaintext highlighter-rouge">
        unordered_map&lt;Movie, set&lt;pair&lt;Price, Shop&gt;&gt;&gt;
       </code>
       for
       <code class="language-plaintext highlighter-rouge">
        unrented
       </code>
       (
       <code class="language-plaintext highlighter-rouge">
        movie -&gt; set of {price, shop}
       </code>
       ) so that we can simply return the first 5 shops in the set of
       <code class="language-plaintext highlighter-rouge">
        unrented[movie]
       </code>
       .
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        report
       </code>
       : we need the cheapest 5
       <code class="language-plaintext highlighter-rouge">
        {price, shop, movie}
       </code>
       tuple. So we can use
       <code class="language-plaintext highlighter-rouge">
        set&lt;tuple&lt;Price, Shop, Movie&gt;&gt;
       </code>
       for
       <code class="language-plaintext highlighter-rouge">
        rented
       </code>
       so that we can simply return the first 5
       <code class="language-plaintext highlighter-rouge">
        {shop, movie}
       </code>
       pairs in the
       <code class="language-plaintext highlighter-rouge">
        rented
       </code>
       set.
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        rent
       </code>
       : Given
       <code class="language-plaintext highlighter-rouge">
        shop, movie
       </code>
       , we need to move this entry from
       <code class="language-plaintext highlighter-rouge">
        unrented
       </code>
       to
       <code class="language-plaintext highlighter-rouge">
        rented
       </code>
       . We need a separate map
       <code class="language-plaintext highlighter-rouge">
        map&lt;pair&lt;Shop, Movie&gt;, Price&gt; price
       </code>
       (
       <code class="language-plaintext highlighter-rouge">
        {shop, movie} -&gt; price
       </code>
       ) to query the price given pair
       <code class="language-plaintext highlighter-rouge">
        {shop, movie}
       </code>
       . Then we just need to
       <code class="language-plaintext highlighter-rouge">
        unrented[movie].erase({price, shop})
       </code>
       and
       <code class="language-plaintext highlighter-rouge">
        rented.emplace(price, shop, movie)
       </code>
       .
      </p>
      <p>
       <code class="language-plaintext highlighter-rouge">
        drop
       </code>
       : Similar to
       <code class="language-plaintext highlighter-rouge">
        rent
       </code>
       , we first get the corresponding
       <code class="language-plaintext highlighter-rouge">
        price
       </code>
       then move the entry from
       <code class="language-plaintext highlighter-rouge">
        rented
       </code>
       to
       <code class="language-plaintext highlighter-rouge">
        unrented
       </code>
       .
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#37cb3cb5-6502-44ea-87c6-a1bea66d78a1'}">
       <li class="uk-active">
        <a href="solution-1912.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-1912.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-1912.html">
         Python
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="37cb3cb5-6502-44ea-87c6-a1bea66d78a1">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MovieRentingSystem</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">[]&gt;&gt;</span> <span class="n">available</span><span class="o">;</span> <span class="c1">// Available movies and their rental price</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">rented</span><span class="o">;</span> <span class="c1">// Rented movies, customer ID and rental price</span>
    <span class="kd">private</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">[]&gt;</span> <span class="n">cheapest</span><span class="o">;</span> <span class="c1">// Cheapest k rented movies</span>

    <span class="kd">public</span> <span class="nf">MovieRentingSystem</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">,</span> <span class="kt">int</span><span class="o">[][]</span> <span class="n">entries</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">available</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">rented</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">cheapest</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;&gt;((</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">==</span> <span class="n">b</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">?</span> <span class="n">a</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">-</span> <span class="n">b</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">:</span> <span class="n">a</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">-</span> <span class="n">b</span><span class="o">[</span><span class="mi">2</span><span class="o">]);</span>
        
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">entries</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">movie</span> <span class="o">=</span> <span class="n">entry</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
            <span class="kt">int</span> <span class="n">shop</span> <span class="o">=</span> <span class="n">entry</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
            <span class="kt">int</span> <span class="n">price</span> <span class="o">=</span> <span class="n">entry</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
            
            <span class="n">available</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">movie</span><span class="o">,</span> <span class="n">k</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;()).</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="n">shop</span><span class="o">,</span> <span class="n">price</span><span class="o">});</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="kt">int</span> <span class="n">movie</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">available</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">movie</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">shopPrice</span> <span class="o">:</span> <span class="n">available</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">movie</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">res</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">shopPrice</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rent</span><span class="o">(</span><span class="kt">int</span> <span class="n">movie</span><span class="o">,</span> <span class="kt">int</span> <span class="n">shop</span><span class="o">,</span> <span class="kt">int</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">rent</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="n">movie</span><span class="o">,</span> <span class="n">shop</span><span class="o">,</span> <span class="n">available</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">movie</span><span class="o">).</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">sp</span> <span class="o">-&gt;</span> <span class="n">sp</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">==</span> <span class="n">shop</span><span class="o">).</span><span class="na">findFirst</span><span class="o">().</span><span class="na">get</span><span class="o">()[</span><span class="mi">1</span><span class="o">]};</span>
        <span class="n">cheapest</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">rent</span><span class="o">);</span>
        <span class="n">available</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">movie</span><span class="o">).</span><span class="na">remove</span><span class="o">(</span><span class="n">rent</span><span class="o">);</span>
        <span class="n">rented</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">userId</span> <span class="o">+</span> <span class="s">""</span><span class="o">,</span> <span class="n">k</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;()).</span><span class="na">put</span><span class="o">(</span><span class="n">movie</span><span class="o">,</span> <span class="n">rent</span><span class="o">[</span><span class="mi">2</span><span class="o">]);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">drop</span><span class="o">(</span><span class="kt">int</span> <span class="n">movie</span><span class="o">,</span> <span class="kt">int</span> <span class="n">shop</span><span class="o">,</span> <span class="kt">int</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">price</span> <span class="o">=</span> <span class="n">rented</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">userId</span> <span class="o">+</span> <span class="s">""</span><span class="o">).</span><span class="na">remove</span><span class="o">(</span><span class="n">movie</span><span class="o">);</span>
        <span class="n">available</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">movie</span><span class="o">,</span> <span class="n">k</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;()).</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="n">shop</span><span class="o">,</span> <span class="n">price</span><span class="o">});</span>
        <span class="n">cheapest</span><span class="o">.</span><span class="na">removeIf</span><span class="o">(</span><span class="n">rent</span> <span class="o">-&gt;</span> <span class="n">rent</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">==</span> <span class="n">movie</span> <span class="o">&amp;&amp;</span> <span class="n">rent</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">==</span> <span class="n">shop</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="nf">report</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">res</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">cheapest</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="kt">int</span><span class="o">[]</span> <span class="n">rent</span> <span class="o">=</span> <span class="n">cheapest</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">movie</span> <span class="o">=</span> <span class="n">rent</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">shop</span> <span class="o">=</span> <span class="n">rent</span><span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="n">price</span> <span class="o">=</span> <span class="n">rent</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
            <span class="n">res</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">movie</span><span class="o">,</span> <span class="n">shop</span><span class="o">));</span>
            <span class="n">rented</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">getCustomer</span><span class="o">(</span><span class="n">rent</span><span class="o">)).</span><span class="na">put</span><span class="o">(</span><span class="n">movie</span><span class="o">,</span> <span class="n">price</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="nc">String</span> <span class="nf">getCustomer</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">rent</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">movie</span> <span class="o">=</span> <span class="n">rent</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">shop</span> <span class="o">=</span> <span class="n">rent</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">rented</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">containsKey</span><span class="o">(</span><span class="n">movie</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">movie</span><span class="o">)</span> <span class="o">==</span> <span class="n">rent</span><span class="o">[</span><span class="mi">2</span><span class="o">])</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="c1">// OJ: https://leetcode.com/problems/design-movie-rental-system/</span>
<span class="c1">// Time:</span>
<span class="c1">//     MovieRentingSystem: O(ElogE)</span>
<span class="c1">//     search: O(1)</span>
<span class="c1">//     rent: O(logE)</span>
<span class="c1">//     drop: O(logE)</span>
<span class="c1">//     report: O(1)</span>
<span class="c1">// Space: O(E)</span>
<span class="k">class</span> <span class="nc">MovieRentingSystem</span> <span class="p">{</span>
    <span class="n">map</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">price</span><span class="p">;</span> <span class="c1">// {shop, movie} -&gt; price</span>
    <span class="n">unordered_map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">set</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;&gt;</span> <span class="n">unrented</span><span class="p">;</span> <span class="c1">// movie -&gt; set of {price, shop}</span>
    <span class="n">set</span><span class="o">&lt;</span><span class="n">tuple</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">rented</span><span class="p">;</span> <span class="c1">// set of {price, shop, movie}</span>
<span class="nl">public:</span>
    <span class="n">MovieRentingSystem</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span> <span class="n">entries</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">entries</span><span class="p">)</span> <span class="p">{</span><span class="c1">// shop, movie, price</span>
            <span class="kt">int</span> <span class="n">shop</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">movie</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
            <span class="n">price</span><span class="p">[{</span><span class="n">shop</span><span class="p">,</span> <span class="n">movie</span><span class="p">}]</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span> 
            <span class="n">unrented</span><span class="p">[</span><span class="n">movie</span><span class="p">].</span><span class="n">emplace</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">shop</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">search</span><span class="p">(</span><span class="kt">int</span> <span class="n">movie</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">auto</span> <span class="o">&amp;</span><span class="n">s</span> <span class="o">=</span> <span class="n">unrented</span><span class="p">[</span><span class="n">movie</span><span class="p">];</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span><span class="p">,</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ans</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">rent</span><span class="p">(</span><span class="kt">int</span> <span class="n">shop</span><span class="p">,</span> <span class="kt">int</span> <span class="n">movie</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">price</span><span class="p">[{</span><span class="n">shop</span><span class="p">,</span> <span class="n">movie</span><span class="p">}];</span>
        <span class="n">unrented</span><span class="p">[</span><span class="n">movie</span><span class="p">].</span><span class="n">erase</span><span class="p">({</span><span class="n">p</span><span class="p">,</span> <span class="n">shop</span><span class="p">});</span>
        <span class="n">rented</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">shop</span><span class="p">,</span> <span class="n">movie</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">drop</span><span class="p">(</span><span class="kt">int</span> <span class="n">shop</span><span class="p">,</span> <span class="kt">int</span> <span class="n">movie</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">price</span><span class="p">[{</span><span class="n">shop</span><span class="p">,</span> <span class="n">movie</span><span class="p">}];</span>
        <span class="n">rented</span><span class="p">.</span><span class="n">erase</span><span class="p">({</span><span class="n">p</span><span class="p">,</span> <span class="n">shop</span><span class="p">,</span> <span class="n">movie</span><span class="p">});</span>
        <span class="n">unrented</span><span class="p">[</span><span class="n">movie</span><span class="p">].</span><span class="n">emplace</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">shop</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">report</span><span class="p">()</span> <span class="p">{</span><span class="c1">// shop, movie</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">ans</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">rented</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">rented</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">,</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">auto</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">it</span><span class="p">;</span>
            <span class="n">ans</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">});</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-python highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="k">class</span> <span class="nc">MovieRentingSystem</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">movie_to_shop_price</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">shop_to_movie_price</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rented</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">shop</span><span class="p">,</span> <span class="n">movie</span><span class="p">,</span> <span class="n">price</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">movie_to_shop_price</span><span class="p">[</span><span class="n">movie</span><span class="p">].</span><span class="n">append</span><span class="p">((</span><span class="n">price</span><span class="p">,</span> <span class="n">shop</span><span class="p">))</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">shop_to_movie_price</span><span class="p">[</span><span class="n">shop</span><span class="p">][</span><span class="n">movie</span><span class="p">]</span> <span class="o">=</span> <span class="n">price</span>

    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">movie</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">shop</span> <span class="k">for</span> <span class="n">price</span><span class="p">,</span> <span class="n">shop</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">movie_to_shop_price</span><span class="p">[</span><span class="n">movie</span><span class="p">])[:</span><span class="mi">5</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">rent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shop</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">movie</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">price</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">shop_to_movie_price</span><span class="p">[</span><span class="n">shop</span><span class="p">][</span><span class="n">movie</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rented</span><span class="p">.</span><span class="n">add</span><span class="p">((</span><span class="n">movie</span><span class="p">,</span> <span class="n">shop</span><span class="p">,</span> <span class="n">price</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">movie_to_shop_price</span><span class="p">[</span><span class="n">movie</span><span class="p">].</span><span class="n">remove</span><span class="p">((</span><span class="n">price</span><span class="p">,</span> <span class="n">shop</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shop</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">movie</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">price</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">shop_to_movie_price</span><span class="p">[</span><span class="n">shop</span><span class="p">][</span><span class="n">movie</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rented</span><span class="p">.</span><span class="n">remove</span><span class="p">((</span><span class="n">movie</span><span class="p">,</span> <span class="n">shop</span><span class="p">,</span> <span class="n">price</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">movie_to_shop_price</span><span class="p">[</span><span class="n">movie</span><span class="p">].</span><span class="n">append</span><span class="p">((</span><span class="n">price</span><span class="p">,</span> <span class="n">shop</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="p">[[</span><span class="n">movie</span><span class="p">,</span> <span class="n">shop</span><span class="p">]</span> <span class="k">for</span> <span class="n">movie</span><span class="p">,</span> <span class="n">shop</span><span class="p">,</span> <span class="n">price</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rented</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[:</span><span class="mi">5</span><span class="p">]]</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-1912.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
