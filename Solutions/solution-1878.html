<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-1878.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-1878.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>1878 - Get Biggest Three Rhombus Sums in a Grid</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 1878. Get Biggest Three Rhombus Sums in a Grid Description You are given an m x n integer matrix gridâââ. A rhombus sum is the sum of the elements that form the border of a regular rhombus shape in gridâââ. The rhombus must have the...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-1878.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-1878.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-1878.html" rel="stylesheet"/>
   <link href="solution-1878.html" rel="stylesheet"/>
   <link href="solution-1878.html" rel="stylesheet"/>
   <link href="solution-1878.html" rel="stylesheet"/>
   <link href="solution-1878.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="1878 - Get Biggest Three Rhombus Sums in a Grid" property="og:title"/>
   <meta content="Leetcode 1878. Get Biggest Three Rhombus Sums in a Grid Description You are given an m x n integer matrix gridâââ. A rhombus sum is the sum of the elements that form the border of a regular rhombus shape in gridâââ. The rhombus must have the shape of a square rotated 45 degrees with each of the corners centered in a grid cell. Below is an image of four valid rhombus shapes with the corresponding colored cells that should be included in each rhombus sum: Note that the rhombus can have an area of 0, which is depicted by the purple rhombus in the bottom right corner. Return the biggest three distinct rhombus sums in the grid in descending order. If there are less than three distinct values, return all of them. &amp;nbsp; Example 1: Input: grid = [[3,4,5,1,3],[3,3,4,2,3],[20,30,200,40,10],[1,5,5,4,1],[4,3,2,2,5]] Output: [228,216,211] Explanation: The rhombus shapes for the three biggest distinct rhombus sums are depicted above. - Blue: 20 + 3 + 200 + 5 = 228 - Red: 200 + 2 + 10 + 4 = 216 - Green: 5 + 200 + 4 + 2 = 211 Example 2: Input: grid = [[1,2,3],[4,5,6],[7,8,9]] Output: [20,9,8] Explanation: The rhombus shapes for the three biggest distinct rhombus sums are depicted above. - Blue: 4 + 2 + 6 + 8 = 20 - Red: 9 (area 0 rhombus in the bottom right corner) - Green: 8 (area 0 rhombus in the bottom middle) Example 3: Input: grid = [[7,7,7]] Output: [7] Explanation: All three possible rhombus sums are the same, so return [7]. &amp;nbsp; Constraints: m == grid.length n == grid[i].length 1 &amp;lt;= m, n &amp;lt;= 50 1 &amp;lt;= grid[i][j] &amp;lt;= 105 Solutions Solution 1: Enumerate Diamond Center + Prefix Sum + Ordered Set We can preprocess to get two prefix sum arrays $s_1$ and $s_2$, where $s_1[i][j]$ represents the sum of the elements on the upper left diagonal ending at $(i, j)$, and $s_2[i][j]$ represents the sum of the elements on the upper right diagonal ending at $(i, j)$. Next, we enumerate each position $(i, j)$, first add $grid[i][j]$ to the ordered set $ss$, and then enumerate the length $k$ of the diamond. The sum of the diamond with $(i, j)$ as the center and a side length of $k$ is: \[\begin{aligned} &amp;amp;\quad s_1[i + k][j] - s_1[i][j - k] + s_1[i][j + k] - s_1[i - k][j] \\ &amp;amp;+ s_2[i][j - k] - s_2[i - k][j] + s_2[i + k][j] - s_2[i][j + k] \\ &amp;amp;- grid[i + k - 1][j - 1] + grid[i - k - 1][j - 1] \end{aligned}\] We add this value to the ordered set $ss$, while ensuring that the size of the ordered set $ss$ does not exceed $3$. Finally, we output the elements in the ordered set $ss$ in reverse order. The time complexity is $O(m \times n \times \min(m, n))$, and the space complexity is $O(m \times n)$. Here, $m$ and $n$ are the number of rows..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2021-01-20T00:00:00-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2021-01-20-1878-Get-Biggest-Three-Rhombus-Sums-in-a-Grid/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-1878.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="1878 - Get Biggest Three Rhombus Sums in a Grid" property="twitter:title"/>
   <meta content="Leetcode 1878. Get Biggest Three Rhombus Sums in a Grid Description You are given an m x n integer matrix gridâââ. A rhombus sum is the sum of the elements that form the border of a regular rhombus shape in gridâââ. The rhombus must have the shape of a square rotated 45 degrees with each of the corners centered in a grid cell. Below is an image of four valid rhombus shapes with the corresponding colored cells that should be included in each rhombus sum: Note that the rhombus can have an area of 0, which is depicted by the purple rhombus in the bottom right corner. Return the biggest three distinct rhombus sums in the grid in descending order. If there are less than three distinct values, return all of them. &amp;nbsp; Example 1: Input: grid = [[3,4,5,1,3],[3,3,4,2,3],[20,30,200,40,10],[1,5,5,4,1],[4,3,2,2,5]] Output: [228,216,211] Explanation: The rhombus shapes for the three biggest distinct rhombus sums are depicted above. - Blue: 20 + 3 + 200 + 5 = 228 - Red: 200 + 2 + 10 + 4 = 216 - Green: 5 + 200 + 4 + 2 = 211 Example 2: Input: grid = [[1,2,3],[4,5,6],[7,8,9]] Output: [20,9,8] Explanation: The rhombus shapes for the three biggest distinct rhombus sums are depicted above. - Blue: 4 + 2 + 6 + 8 = 20 - Red: 9 (area 0 rhombus in the bottom right corner) - Green: 8 (area 0 rhombus in the bottom middle) Example 3: Input: grid = [[7,7,7]] Output: [7] Explanation: All three possible rhombus sums are the same, so return [7]. &amp;nbsp; Constraints: m == grid.length n == grid[i].length 1 &amp;lt;= m, n &amp;lt;= 50 1 &amp;lt;= grid[i][j] &amp;lt;= 105 Solutions Solution 1: Enumerate Diamond Center + Prefix Sum + Ordered Set We can preprocess to get two prefix sum arrays $s_1$ and $s_2$, where $s_1[i][j]$ represents the sum of the elements on the upper left diagonal ending at $(i, j)$, and $s_2[i][j]$ represents the sum of the elements on the upper right diagonal ending at $(i, j)$. Next, we enumerate each position $(i, j)$, first add $grid[i][j]$ to the ordered set $ss$, and then enumerate the length $k$ of the diamond. The sum of the diamond with $(i, j)$ as the center and a side length of $k$ is: \[\begin{aligned} &amp;amp;\quad s_1[i + k][j] - s_1[i][j - k] + s_1[i][j + k] - s_1[i - k][j] \\ &amp;amp;+ s_2[i][j - k] - s_2[i - k][j] + s_2[i + k][j] - s_2[i][j + k] \\ &amp;amp;- grid[i + k - 1][j - 1] + grid[i - k - 1][j - 1] \end{aligned}\] We add this value to the ordered set $ss$, while ensuring that the size of the ordered set $ss$ does not exceed $3$. Finally, we output the elements in the ordered set $ss$ in reverse order. The time complexity is $O(m \times n \times \min(m, n))$, and the space complexity is $O(m \times n)$. Here, $m$ and $n$ are the number of rows..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    1878 - Get Biggest Three Rhombus Sums in a Grid | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="1878 - Get Biggest Three Rhombus Sums in a Grid" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-1878.html" rel="canonical">
          <meta content="https://leetcode.ca/2021-01-20-1878-Get-Biggest-Three-Rhombus-Sums-in-a-Grid/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2021-01-20T00:00:00-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"1878 - Get Biggest Three Rhombus Sums in a Grid","dateModified":"2021-01-20T00:00:00-08:00","datePublished":"2021-01-20T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2021-01-20-1878-Get-Biggest-Three-Rhombus-Sums-in-a-Grid/"},"url":"https://leetcode.ca/2021-01-20-1878-Get-Biggest-Three-Rhombus-Sums-in-a-Grid/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="1878-get-biggest-three-rhombus-sums-in-a-grid">
       <a href="solution-1878.html">
        1878. Get Biggest Three Rhombus Sums in a Grid
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       You are given an
       <code>
        m x n
       </code>
       integer matrix
       <code>
        grid
       </code>
       âââ.
      </p>
      <p>
       A
       <strong>
        rhombus sum
       </strong>
       is the sum of the elements that form
       <strong>
        the
       </strong>
       <strong>
        border
       </strong>
       of a regular rhombus shape in
       <code>
        grid
       </code>
       âââ. The rhombus must have the shape of a square rotated 45 degrees with each of the corners centered in a grid cell. Below is an image of four valid rhombus shapes with the corresponding colored cells that should be included in each
       <strong>
        rhombus sum
       </strong>
       :
      </p>
      <p>
       <img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1800-1899/1878.Get%20Biggest%20Three%20Rhombus%20Sums%20in%20a%20Grid/images/pc73-q4-desc-2.png" style="width: 385px; height: 385px;"/>
      </p>
      <p>
       Note that the rhombus can have an area of 0, which is depicted by the purple rhombus in the bottom right corner.
      </p>
      <p>
       Return
       <em>
        the biggest three
        <strong>
         distinct rhombus sums
        </strong>
        in the
       </em>
       <code>
        grid
       </code>
       <em>
        in
        <strong>
         descending order
        </strong>
       </em>
       <em>
        . If there are less than three distinct values, return all of them
       </em>
       .
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <p>
       <img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1800-1899/1878.Get%20Biggest%20Three%20Rhombus%20Sums%20in%20a%20Grid/images/pc73-q4-ex1.png" style="width: 360px; height: 361px;"/>
      </p>
      <pre>
<strong>Input:</strong> grid = [[3,4,5,1,3],[3,3,4,2,3],[20,30,200,40,10],[1,5,5,4,1],[4,3,2,2,5]]
<strong>Output:</strong> [228,216,211]
<strong>Explanation:</strong> The rhombus shapes for the three biggest distinct rhombus sums are depicted above.
- Blue: 20 + 3 + 200 + 5 = 228
- Red: 200 + 2 + 10 + 4 = 216
- Green: 5 + 200 + 4 + 2 = 211
</pre>
      <p>
       <strong class="example">
        Example 2:
       </strong>
      </p>
      <p>
       <img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1800-1899/1878.Get%20Biggest%20Three%20Rhombus%20Sums%20in%20a%20Grid/images/pc73-q4-ex2.png" style="width: 217px; height: 217px;"/>
      </p>
      <pre>
<strong>Input:</strong> grid = [[1,2,3],[4,5,6],[7,8,9]]
<strong>Output:</strong> [20,9,8]
<strong>Explanation:</strong> The rhombus shapes for the three biggest distinct rhombus sums are depicted above.
- Blue: 4 + 2 + 6 + 8 = 20
- Red: 9 (area 0 rhombus in the bottom right corner)
- Green: 8 (area 0 rhombus in the bottom middle)
</pre>
      <p>
       <strong class="example">
        Example 3:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> grid = [[7,7,7]]
<strong>Output:</strong> [7]
<strong>Explanation:</strong> All three possible rhombus sums are the same, so return [7].
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         m == grid.length
        </code>
       </li>
       <li>
        <code>
         n == grid[i].length
        </code>
       </li>
       <li>
        <code>
         1 &lt;= m, n &lt;= 50
        </code>
       </li>
       <li>
        <code>
         1 &lt;= grid[i][j] &lt;= 10
         <sup>
          5
         </sup>
        </code>
       </li>
      </ul>
      <h2 id="solutions">
       Solutions
      </h2>
      <p>
       <strong>
        Solution 1: Enumerate Diamond Center + Prefix Sum + Ordered Set
       </strong>
      </p>
      <p>
       We can preprocess to get two prefix sum arrays $s_1$ and $s_2$, where $s_1[i][j]$ represents the sum of the elements on the upper left diagonal ending at $(i, j)$, and $s_2[i][j]$ represents the sum of the elements on the upper right diagonal ending at $(i, j)$.
      </p>
      <p>
       Next, we enumerate each position $(i, j)$, first add $grid[i][j]$ to the ordered set $ss$, and then enumerate the length $k$ of the diamond. The sum of the diamond with $(i, j)$ as the center and a side length of $k$ is:
      </p>
      \[\begin{aligned}
&amp;\quad s_1[i + k][j] - s_1[i][j - k] + s_1[i][j + k] - s_1[i - k][j] \\
&amp;+ s_2[i][j - k] - s_2[i - k][j] + s_2[i + k][j] - s_2[i][j + k] \\
&amp;- grid[i + k - 1][j - 1] + grid[i - k - 1][j - 1]
\end{aligned}\]
      <p>
       We add this value to the ordered set $ss$, while ensuring that the size of the ordered set $ss$ does not exceed $3$. Finally, we output the elements in the ordered set $ss$ in reverse order.
      </p>
      <p>
       The time complexity is $O(m \times n \times \min(m, n))$, and the space complexity is $O(m \times n)$. Here, $m$ and $n$ are the number of rows and columns of the matrix, respectively.
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#f16485eb-4f42-44bb-bfd7-c76e47141e98'}">
       <li class="uk-active">
        <a href="solution-1878.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-1878.html">
         C++
        </a>
       </li>
       <li>
        <a href="solution-1878.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-1878.html">
         Go
        </a>
       </li>
       <li>
        <a href="solution-1878.html">
         TypeScript
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="f16485eb-4f42-44bb-bfd7-c76e47141e98">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">getBiggestThree</span><span class="o">(</span><span class="kt">int</span><span class="o">[][]</span> <span class="n">grid</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">grid</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">length</span><span class="o">;</span>
        <span class="kt">int</span><span class="o">[][]</span> <span class="n">s1</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="o">][</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="o">];</span>
        <span class="kt">int</span><span class="o">[][]</span> <span class="n">s2</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="o">][</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="o">++</span><span class="n">j</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">s1</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">s1</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">grid</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">];</span>
                <span class="n">s2</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">s2</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">grid</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">];</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">TreeSet</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">ss</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TreeSet</span><span class="o">&lt;&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="o">++</span><span class="n">j</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">m</span> <span class="o">-</span> <span class="n">i</span><span class="o">),</span> <span class="nc">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">j</span><span class="o">));</span>
                <span class="n">ss</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">grid</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]);</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="o">;</span> <span class="o">++</span><span class="n">k</span><span class="o">)</span> <span class="o">{</span>
                    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">s1</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">-</span> <span class="n">s1</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="o">];</span>
                    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">s1</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="o">]</span> <span class="o">-</span> <span class="n">s1</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="o">][</span><span class="n">j</span><span class="o">];</span>
                    <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">s2</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="o">]</span> <span class="o">-</span> <span class="n">s2</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="o">][</span><span class="n">j</span><span class="o">];</span>
                    <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">s2</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">-</span> <span class="n">s2</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="o">];</span>
                    <span class="n">ss</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span> <span class="o">-</span> <span class="n">grid</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">grid</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]);</span>
                <span class="o">}</span>
                <span class="k">while</span> <span class="o">(</span><span class="n">ss</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">ss</span><span class="o">.</span><span class="na">pollFirst</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">ans</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">ss</span><span class="o">.</span><span class="na">size</span><span class="o">()];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ans</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">ans</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="na">pollLast</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-cpp highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">getBiggestThree</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span> <span class="n">grid</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">n</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">size</span><span class="p">();</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">s1</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">));</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">s2</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">));</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
                <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ss</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="n">min</span><span class="p">({</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">j</span><span class="p">});</span>
                <span class="n">ss</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">];</span>
                    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
                    <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
                    <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">];</span>
                    <span class="n">ss</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span> <span class="o">-</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="k">while</span> <span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">ss</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">rbegin</span><span class="p">(),</span> <span class="n">ss</span><span class="p">.</span><span class="n">rend</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kn">from</span> <span class="nn">sortedcontainers</span> <span class="kn">import</span> <span class="n">SortedSet</span>


<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">getBiggestThree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span>
                <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="n">SortedSet</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">l</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">ss</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span>
                    <span class="n">ss</span><span class="p">.</span><span class="n">add</span><span class="p">(</span>
                        <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span> <span class="o">-</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">ss</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">ss</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">func</span> <span class="n">getBiggestThree</span><span class="p">(</span><span class="n">grid</span> <span class="p">[][]</span><span class="kt">int</span><span class="p">)</span> <span class="p">[]</span><span class="kt">int</span> <span class="p">{</span>
	<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
	<span class="n">s1</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([][]</span><span class="kt">int</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="m">1</span><span class="p">)</span>
	<span class="n">s2</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([][]</span><span class="kt">int</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="m">1</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">s1</span> <span class="p">{</span>
		<span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="m">2</span><span class="p">)</span>
		<span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="m">2</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="k">for</span> <span class="n">j</span> <span class="o">:=</span> <span class="m">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span> <span class="p">{</span>
			<span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="m">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="m">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="m">1</span><span class="p">]</span>
			<span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="m">1</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="m">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="m">1</span><span class="p">]</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">ss</span> <span class="o">:=</span> <span class="n">treemap</span><span class="o">.</span><span class="n">NewWithIntComparator</span><span class="p">()</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="k">for</span> <span class="n">j</span> <span class="o">:=</span> <span class="m">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span> <span class="p">{</span>
			<span class="n">l</span> <span class="o">:=</span> <span class="n">min</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="m">1</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="m">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="n">j</span><span class="p">)</span>
			<span class="n">ss</span><span class="o">.</span><span class="n">Put</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="m">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="m">1</span><span class="p">],</span> <span class="no">nil</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">k</span> <span class="o">:=</span> <span class="m">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span> <span class="p">{</span>
				<span class="n">a</span> <span class="o">:=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="p">]</span>
				<span class="n">b</span> <span class="o">:=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
				<span class="n">c</span> <span class="o">:=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
				<span class="n">d</span> <span class="o">:=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span>
				<span class="n">ss</span><span class="o">.</span><span class="n">Put</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">-</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="m">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="m">1</span><span class="p">]</span><span class="o">+</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="m">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="m">1</span><span class="p">],</span> <span class="no">nil</span><span class="p">)</span>
			<span class="p">}</span>
			<span class="k">for</span> <span class="n">ss</span><span class="o">.</span><span class="n">Size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="m">3</span> <span class="p">{</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">ss</span><span class="o">.</span><span class="n">Min</span><span class="p">()</span>
				<span class="n">ss</span><span class="o">.</span><span class="n">Remove</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="p">(</span><span class="kt">int</span><span class="p">))</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">ans</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">Size</span><span class="p">())</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">ss</span><span class="o">.</span><span class="n">Keys</span><span class="p">()</span> <span class="p">{</span>
		<span class="n">ans</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="m">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ans</span>
<span class="p">}</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-ts highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">function</span> <span class="nx">getBiggestThree</span><span class="p">(</span><span class="nx">grid</span><span class="p">:</span> <span class="kr">number</span><span class="p">[][]):</span> <span class="kr">number</span><span class="p">[]</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">grid</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">s1</span><span class="p">:</span> <span class="kr">number</span><span class="p">[][]</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">({</span> <span class="na">length</span><span class="p">:</span> <span class="nx">m</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">},</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">s2</span><span class="p">:</span> <span class="kr">number</span><span class="p">[][]</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">({</span> <span class="na">length</span><span class="p">:</span> <span class="nx">m</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">},</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">m</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="o">++</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">s1</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">s1</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
            <span class="nx">s2</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">s2</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">ss</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TreeSet</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">m</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="o">++</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">l</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">m</span> <span class="o">-</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">n</span> <span class="o">-</span> <span class="nx">j</span><span class="p">);</span>
            <span class="nx">ss</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;=</span> <span class="nx">l</span><span class="p">;</span> <span class="o">++</span><span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">s1</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">k</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">-</span> <span class="nx">s1</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span> <span class="o">-</span> <span class="nx">k</span><span class="p">];</span>
                <span class="kd">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">s1</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span> <span class="o">+</span> <span class="nx">k</span><span class="p">]</span> <span class="o">-</span> <span class="nx">s1</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="nx">k</span><span class="p">][</span><span class="nx">j</span><span class="p">];</span>
                <span class="kd">const</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">s2</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span> <span class="o">-</span> <span class="nx">k</span><span class="p">]</span> <span class="o">-</span> <span class="nx">s2</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="nx">k</span><span class="p">][</span><span class="nx">j</span><span class="p">];</span>
                <span class="kd">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">s2</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">k</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">-</span> <span class="nx">s2</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span> <span class="o">+</span> <span class="nx">k</span><span class="p">];</span>
                <span class="nx">ss</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">c</span> <span class="o">+</span> <span class="nx">d</span> <span class="o">-</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="nx">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">ss</span><span class="p">.</span><span class="nx">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ss</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">[...</span><span class="nx">ss</span><span class="p">].</span><span class="nx">reverse</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Compare</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lhs</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">rhs</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kr">number</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="kr">number</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">T</span><span class="p">;</span>
    <span class="nl">count</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">left</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nl">right</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nl">parent</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="na">data</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">sibling</span><span class="p">():</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// sibling null if no parent</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">isOnLeft</span><span class="p">()</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">right</span> <span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">isOnLeft</span><span class="p">():</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="o">!</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">hasRedChild</span><span class="p">():</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">Boolean</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">left</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span>
            <span class="nb">Boolean</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">right</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">RBTree</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="na">root</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nl">lt</span><span class="p">:</span> <span class="p">(</span><span class="na">l</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="na">r</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">boolean</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="na">compare</span><span class="p">:</span> <span class="nx">Compare</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span><span class="na">l</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="na">r</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">l</span> <span class="o">&lt;</span> <span class="nx">r</span> <span class="p">?</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="nx">l</span> <span class="o">&gt;</span> <span class="nx">r</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lt</span> <span class="o">=</span> <span class="p">(</span><span class="na">l</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="na">r</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">compare</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">rotateLeft</span><span class="p">(</span><span class="na">pt</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">right</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">right</span><span class="o">!</span><span class="p">;</span>
        <span class="nx">pt</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="nx">right</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">pt</span><span class="p">.</span><span class="nx">right</span><span class="p">)</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
        <span class="nx">right</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">right</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">pt</span> <span class="o">===</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">right</span><span class="p">;</span>
        <span class="k">else</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="nx">right</span><span class="p">;</span>

        <span class="nx">right</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
        <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">right</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">rotateRight</span><span class="p">(</span><span class="na">pt</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">left</span><span class="o">!</span><span class="p">;</span>
        <span class="nx">pt</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">left</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">pt</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
        <span class="nx">left</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">left</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">pt</span> <span class="o">===</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">left</span><span class="p">;</span>
        <span class="k">else</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="nx">left</span><span class="p">;</span>

        <span class="nx">left</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
        <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">left</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">swapColor</span><span class="p">(</span><span class="na">p1</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="na">p2</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">p1</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
        <span class="nx">p1</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">p2</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
        <span class="nx">p2</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">swapData</span><span class="p">(</span><span class="na">p1</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="na">p2</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">p1</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
        <span class="nx">p1</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">p2</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
        <span class="nx">p2</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">fixAfterInsert</span><span class="p">(</span><span class="na">pt</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">grandParent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="nx">pt</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">&amp;&amp;</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">color</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">?.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parent</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>
            <span class="nx">grandParent</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>

            <span class="cm">/*  Case : A
                Parent of pt is left child of Grand-parent of pt */</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">parent</span> <span class="o">===</span> <span class="nx">grandParent</span><span class="p">?.</span><span class="nx">left</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">uncle</span> <span class="o">=</span> <span class="nx">grandParent</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>

                <span class="cm">/* Case : 1
                   The uncle of pt is also red
                   Only Recoloring required */</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">uncle</span> <span class="o">&amp;&amp;</span> <span class="nx">uncle</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">grandParent</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="nx">uncle</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="nx">pt</span> <span class="o">=</span> <span class="nx">grandParent</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="cm">/* Case : 2
                       pt is right child of its parent
                       Left-rotation required */</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">pt</span> <span class="o">===</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">rotateLeft</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
                        <span class="nx">pt</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">;</span>
                        <span class="nx">parent</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>
                    <span class="p">}</span>

                    <span class="cm">/* Case : 3
                       pt is left child of its parent
                       Right-rotation required */</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">rotateRight</span><span class="p">(</span><span class="nx">grandParent</span><span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">swapColor</span><span class="p">(</span><span class="nx">parent</span><span class="o">!</span><span class="p">,</span> <span class="nx">grandParent</span><span class="p">);</span>
                    <span class="nx">pt</span> <span class="o">=</span> <span class="nx">parent</span><span class="o">!</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="cm">/* Case : B
               Parent of pt is right child of Grand-parent of pt */</span>
                <span class="kd">const</span> <span class="nx">uncle</span> <span class="o">=</span> <span class="nx">grandParent</span><span class="o">!</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>

                <span class="cm">/*  Case : 1
                    The uncle of pt is also red
                    Only Recoloring required */</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">uncle</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">uncle</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">grandParent</span><span class="o">!</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="nx">uncle</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="nx">pt</span> <span class="o">=</span> <span class="nx">grandParent</span><span class="o">!</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="cm">/* Case : 2
                       pt is left child of its parent
                       Right-rotation required */</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">pt</span> <span class="o">===</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">rotateRight</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
                        <span class="nx">pt</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">;</span>
                        <span class="nx">parent</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>
                    <span class="p">}</span>

                    <span class="cm">/* Case : 3
                       pt is right child of its parent
                       Left-rotation required */</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">rotateLeft</span><span class="p">(</span><span class="nx">grandParent</span><span class="o">!</span><span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">swapColor</span><span class="p">(</span><span class="nx">parent</span><span class="o">!</span><span class="p">,</span> <span class="nx">grandParent</span><span class="o">!</span><span class="p">);</span>
                    <span class="nx">pt</span> <span class="o">=</span> <span class="nx">parent</span><span class="o">!</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="o">!</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">delete</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">node</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">count</span><span class="o">--</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">node</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">deleteNode</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">deleteAll</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">node</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">deleteNode</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">deleteNode</span><span class="p">(</span><span class="na">v</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">u</span> <span class="o">=</span> <span class="nx">BSTreplace</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>

        <span class="c1">// True when u and v are both black</span>
        <span class="kd">const</span> <span class="nx">uvBlack</span> <span class="o">=</span> <span class="p">(</span><span class="nx">u</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">u</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">1</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">v</span><span class="p">.</span><span class="nx">parent</span><span class="o">!</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">u</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// u is null therefore v is leaf</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">v</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="c1">// v is root, making root null</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">uvBlack</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// u and v both black</span>
                    <span class="c1">// v is leaf, fix double black at v</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">fixDoubleBlack</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="c1">// u or v is red</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">sibling</span><span class="p">())</span> <span class="p">{</span>
                        <span class="c1">// sibling is not null, make it red"</span>
                        <span class="nx">v</span><span class="p">.</span><span class="nx">sibling</span><span class="p">()</span><span class="o">!</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="c1">// delete v from the tree</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">isOnLeft</span><span class="p">())</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="k">else</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">v</span><span class="p">.</span><span class="nx">left</span> <span class="o">||</span> <span class="o">!</span><span class="nx">v</span><span class="p">.</span><span class="nx">right</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// v has 1 child</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">v</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// v is root, assign the value of u to v, and delete u</span>
                <span class="nx">v</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">u</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
                <span class="nx">v</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">v</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Detach v from tree and move u up</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">isOnLeft</span><span class="p">())</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">u</span><span class="p">;</span>
                <span class="k">else</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="nx">u</span><span class="p">;</span>
                <span class="nx">u</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">uvBlack</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">fixDoubleBlack</span><span class="p">(</span><span class="nx">u</span><span class="p">);</span>
                <span class="c1">// u and v both black, fix double black at u</span>
                <span class="k">else</span> <span class="nx">u</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// u or v red, color u black</span>
            <span class="p">}</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// v has 2 children, swap data with successor and recurse</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">swapData</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nx">v</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">deleteNode</span><span class="p">(</span><span class="nx">u</span><span class="p">);</span>

        <span class="c1">// find node that replaces a deleted node in BST</span>
        <span class="kd">function</span> <span class="nx">BSTreplace</span><span class="p">(</span><span class="na">x</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
            <span class="c1">// when node have 2 children</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">left</span> <span class="o">&amp;&amp;</span> <span class="nx">x</span><span class="p">.</span><span class="nx">right</span><span class="p">)</span> <span class="k">return</span> <span class="nx">successor</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">right</span><span class="p">);</span>
            <span class="c1">// when leaf</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">x</span><span class="p">.</span><span class="nx">left</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">x</span><span class="p">.</span><span class="nx">right</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="c1">// when single child</span>
            <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">left</span> <span class="o">??</span> <span class="nx">x</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// find node that do not have a left child</span>
        <span class="c1">// in the subtree of the given node</span>
        <span class="kd">function</span> <span class="nx">successor</span><span class="p">(</span><span class="na">x</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">temp</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">temp</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span> <span class="nx">temp</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">temp</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">fixDoubleBlack</span><span class="p">(</span><span class="na">x</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span> <span class="c1">// Reached root</span>

        <span class="kd">const</span> <span class="nx">sibling</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">sibling</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">parent</span><span class="o">!</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sibling</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// No sibiling, double black pushed up</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fixDoubleBlack</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">sibling</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Sibling red</span>
                <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nx">sibling</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">sibling</span><span class="p">.</span><span class="nx">isOnLeft</span><span class="p">())</span> <span class="k">this</span><span class="p">.</span><span class="nx">rotateRight</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
                <span class="c1">// left case</span>
                <span class="k">else</span> <span class="k">this</span><span class="p">.</span><span class="nx">rotateLeft</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span> <span class="c1">// right case</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">fixDoubleBlack</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Sibling black</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">sibling</span><span class="p">.</span><span class="nx">hasRedChild</span><span class="p">())</span> <span class="p">{</span>
                    <span class="c1">// at least 1 red children</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">sibling</span><span class="p">.</span><span class="nx">left</span> <span class="o">&amp;&amp;</span> <span class="nx">sibling</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">sibling</span><span class="p">.</span><span class="nx">isOnLeft</span><span class="p">())</span> <span class="p">{</span>
                            <span class="c1">// left left</span>
                            <span class="nx">sibling</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">sibling</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
                            <span class="nx">sibling</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">rotateRight</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="c1">// right left</span>
                            <span class="nx">sibling</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">rotateRight</span><span class="p">(</span><span class="nx">sibling</span><span class="p">);</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">rotateLeft</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">sibling</span><span class="p">.</span><span class="nx">isOnLeft</span><span class="p">())</span> <span class="p">{</span>
                            <span class="c1">// left right</span>
                            <span class="nx">sibling</span><span class="p">.</span><span class="nx">right</span><span class="o">!</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">rotateLeft</span><span class="p">(</span><span class="nx">sibling</span><span class="p">);</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">rotateRight</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="c1">// right right</span>
                            <span class="nx">sibling</span><span class="p">.</span><span class="nx">right</span><span class="o">!</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">sibling</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
                            <span class="nx">sibling</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">rotateLeft</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="c1">// 2 black children</span>
                    <span class="nx">sibling</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">fixDoubleBlack</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
                    <span class="k">else</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">insert</span><span class="p">(</span><span class="na">data</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="c1">// search for a position to insert</span>
        <span class="kd">let</span> <span class="nx">parent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">data</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">parent</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">else</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">data</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">parent</span><span class="p">.</span><span class="nx">right</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">else</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// insert node into parent</span>
        <span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RBTreeNode</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">parent</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">data</span><span class="p">))</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">node</span><span class="p">.</span><span class="nx">data</span><span class="p">))</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">parent</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span><span class="p">;</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fixAfterInsert</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">find</span><span class="p">(</span><span class="na">data</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">data</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">p</span> <span class="o">??</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="o">*</span><span class="nx">inOrder</span><span class="p">(</span><span class="na">root</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="o">!</span><span class="p">):</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">root</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">v</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">inOrder</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">left</span><span class="o">!</span><span class="p">))</span> <span class="k">yield</span> <span class="nx">v</span><span class="p">;</span>
        <span class="k">yield</span> <span class="nx">root</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">v</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">inOrder</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">right</span><span class="o">!</span><span class="p">))</span> <span class="k">yield</span> <span class="nx">v</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="o">*</span><span class="nx">reverseInOrder</span><span class="p">(</span><span class="na">root</span><span class="p">:</span> <span class="nx">RBTreeNode</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="o">!</span><span class="p">):</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">root</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">v</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">reverseInOrder</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">right</span><span class="o">!</span><span class="p">))</span> <span class="k">yield</span> <span class="nx">v</span><span class="p">;</span>
        <span class="k">yield</span> <span class="nx">root</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">v</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">reverseInOrder</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">left</span><span class="o">!</span><span class="p">))</span> <span class="k">yield</span> <span class="nx">v</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">TreeSet</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="kr">number</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="na">_size</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">tree</span><span class="p">:</span> <span class="nx">RBTree</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nl">compare</span><span class="p">:</span> <span class="nx">Compare</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span>
        <span class="na">collection</span><span class="p">:</span> <span class="nx">T</span><span class="p">[]</span> <span class="o">|</span> <span class="nx">Compare</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="na">compare</span><span class="p">:</span> <span class="nx">Compare</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span><span class="na">l</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="na">r</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">l</span> <span class="o">&lt;</span> <span class="nx">r</span> <span class="p">?</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="nx">l</span> <span class="o">&gt;</span> <span class="nx">r</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">collection</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">compare</span> <span class="o">=</span> <span class="nx">collection</span><span class="p">;</span>
            <span class="nx">collection</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">compare</span> <span class="o">=</span> <span class="nx">compare</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RBTree</span><span class="p">(</span><span class="nx">compare</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="nx">collection</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">size</span><span class="p">():</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_size</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">has</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">!!</span><span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">add</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">successful</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_size</span> <span class="o">+=</span> <span class="nx">successful</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">successful</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">delete</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">deleted</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">deleteAll</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_size</span> <span class="o">-=</span> <span class="nx">deleted</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">deleted</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">ceil</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">higher</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">higher</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">higher</span><span class="p">?.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">floor</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">lower</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">lower</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">lower</span><span class="p">?.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">higher</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">higher</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">higher</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">higher</span><span class="p">?.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">lower</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">lower</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">lower</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">lower</span><span class="p">?.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">first</span><span class="p">():</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">inOrder</span><span class="p">().</span><span class="nx">next</span><span class="p">().</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">last</span><span class="p">():</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">reverseInOrder</span><span class="p">().</span><span class="nx">next</span><span class="p">().</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">shift</span><span class="p">():</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">first</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">first</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">first</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">first</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pop</span><span class="p">():</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">last</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">last</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">last</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">last</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">last</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="o">*</span><span class="p">[</span><span class="nb">Symbol</span><span class="p">.</span><span class="nx">iterator</span><span class="p">]():</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="k">void</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">())</span> <span class="k">yield</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="o">*</span><span class="nx">keys</span><span class="p">():</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="k">void</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">())</span> <span class="k">yield</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="o">*</span><span class="nx">values</span><span class="p">():</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">inOrder</span><span class="p">())</span> <span class="k">yield</span> <span class="nx">val</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/**
     * Return a generator for reverse order traversing the set
     */</span>
    <span class="o">*</span><span class="nx">rvalues</span><span class="p">():</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">reverseInOrder</span><span class="p">())</span> <span class="k">yield</span> <span class="nx">val</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">TreeMultiSet</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="kr">number</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="na">_size</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">tree</span><span class="p">:</span> <span class="nx">RBTree</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nl">compare</span><span class="p">:</span> <span class="nx">Compare</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span>
        <span class="na">collection</span><span class="p">:</span> <span class="nx">T</span><span class="p">[]</span> <span class="o">|</span> <span class="nx">Compare</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="na">compare</span><span class="p">:</span> <span class="nx">Compare</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span><span class="na">l</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="na">r</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">l</span> <span class="o">&lt;</span> <span class="nx">r</span> <span class="p">?</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="nx">l</span> <span class="o">&gt;</span> <span class="nx">r</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">collection</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">compare</span> <span class="o">=</span> <span class="nx">collection</span><span class="p">;</span>
            <span class="nx">collection</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">compare</span> <span class="o">=</span> <span class="nx">compare</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RBTree</span><span class="p">(</span><span class="nx">compare</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="nx">collection</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">size</span><span class="p">():</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_size</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">has</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">!!</span><span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">add</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">successful</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_size</span><span class="o">++</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">successful</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">delete</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">successful</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">successful</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_size</span><span class="o">--</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">count</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">node</span> <span class="p">?</span> <span class="nx">node</span><span class="p">.</span><span class="nx">count</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">ceil</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">higher</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">higher</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">higher</span><span class="p">?.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">floor</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">lower</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">lower</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">lower</span><span class="p">?.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">higher</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">higher</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">higher</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">higher</span><span class="p">?.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">lower</span><span class="p">(</span><span class="na">val</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">lower</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">lower</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">lower</span><span class="p">?.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">first</span><span class="p">():</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">inOrder</span><span class="p">().</span><span class="nx">next</span><span class="p">().</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">last</span><span class="p">():</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">reverseInOrder</span><span class="p">().</span><span class="nx">next</span><span class="p">().</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">shift</span><span class="p">():</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">first</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">first</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">first</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">first</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pop</span><span class="p">():</span> <span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">last</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">last</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">last</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">last</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">last</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="o">*</span><span class="p">[</span><span class="nb">Symbol</span><span class="p">.</span><span class="nx">iterator</span><span class="p">]():</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="k">void</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">yield</span><span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="o">*</span><span class="nx">keys</span><span class="p">():</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="k">void</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">())</span> <span class="k">yield</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="o">*</span><span class="nx">values</span><span class="p">():</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">inOrder</span><span class="p">())</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">count</span><span class="o">--</span><span class="p">)</span> <span class="k">yield</span> <span class="nx">val</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/**
     * Return a generator for reverse order traversing the multi-set
     */</span>
    <span class="o">*</span><span class="nx">rvalues</span><span class="p">():</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">tree</span><span class="p">.</span><span class="nx">reverseInOrder</span><span class="p">())</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">count</span><span class="o">--</span><span class="p">)</span> <span class="k">yield</span> <span class="nx">val</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-1878.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
