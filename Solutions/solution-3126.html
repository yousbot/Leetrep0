<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-3126.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-3126.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>3126 - Server Utilization Time</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 3126. Server Utilization Time ð Description Table: Servers +----------------+----------+ \| Column Name \| Type \| +----------------+----------+ \| server_id \| int \| \| status_time \| datetime \| \| session_status \| enum \| +----------------+----------+ (server_id, status_time, session_status) is the primary key (combination of columns with unique values)...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-3126.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-3126.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-3126.html" rel="stylesheet"/>
   <link href="solution-3126.html" rel="stylesheet"/>
   <link href="solution-3126.html" rel="stylesheet"/>
   <link href="solution-3126.html" rel="stylesheet"/>
   <link href="solution-3126.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="3126 - Server Utilization Time" property="og:title"/>
   <meta content="Leetcode 3126. Server Utilization Time ð Description Table: Servers +----------------+----------+ \| Column Name \| Type \| +----------------+----------+ \| server_id \| int \| \| status_time \| datetime \| \| session_status \| enum \| +----------------+----------+ (server_id, status_time, session_status) is the primary key (combination of columns with unique values) for this table. session_status is an ENUM (category) type of (&amp;#39;start&amp;#39;, &amp;#39;stop&amp;#39;). Each row of this table contains server_id, status_time, and session_status. Write a solution to find the total time when servers were running. The output should be rounded down to the nearest number of&amp;nbsp;full days. Return the result table in any&amp;nbsp;order. The result format is in the following example. &amp;nbsp; Example: Input: Servers table: +-----------+---------------------+----------------+ \| server_id \| status_time \| session_status \| +-----------+---------------------+----------------+ \| 3 \| 2023-11-04 16:29:47 \| start \| \| 3 \| 2023-11-05 01:49:47 \| stop \| \| 3 \| 2023-11-25 01:37:08 \| start \| \| 3 \| 2023-11-25 03:50:08 \| stop \| \| 1 \| 2023-11-13 03:05:31 \| start \| \| 1 \| 2023-11-13 11:10:31 \| stop \| \| 4 \| 2023-11-29 15:11:17 \| start \| \| 4 \| 2023-11-29 15:42:17 \| stop \| \| 4 \| 2023-11-20 00:31:44 \| start \| \| 4 \| 2023-11-20 07:03:44 \| stop \| \| 1 \| 2023-11-20 00:27:11 \| start \| \| 1 \| 2023-11-20 01:41:11 \| stop \| \| 3 \| 2023-11-04 23:16:48 \| start \| \| 3 \| 2023-11-05 01:15:48 \| stop \| \| 4 \| 2023-11-30 15:09:18 \| start \| \| 4 \| 2023-11-30 20:48:18 \| stop \| \| 4 \| 2023-11-25 21:09:06 \| start \| \| 4 \| 2023-11-26 04:58:06 \| stop \| \| 5 \| 2023-11-16 19:42:22 \| start \| \| 5 \| 2023-11-16 21:08:22 \| stop \| +-----------+---------------------+----------------+ Output: +-------------------+ \| total_uptime_days \| +-------------------+ \| 1 \| +-------------------+ Explanation: For server ID 3: From 2023-11-04 16:29:47 to 2023-11-05 01:49:47: ~9.3 hours From 2023-11-25 01:37:08 to 2023-11-25 03:50:08: ~2.2 hours From 2023-11-04 23:16:48 to 2023-11-05 01:15:48: ~1.98 hours Total for server 3: ~13.48 hours For server ID 1: From 2023-11-13 03:05:31 to 2023-11-13 11:10:31: ~8 hours From 2023-11-20 00:27:11 to 2023-11-20 01:41:11: ~1.23 hours Total for server 1: ~9.23 hours For server ID 4: From 2023-11-29 15:11:17 to 2023-11-29 15:42:17: ~0.52 hours From 2023-11-20 00:31:44 to 2023-11-20 07:03:44: ~6.53 hours From 2023-11-30 15:09:18 to 2023-11-30 20:48:18: ~5.65 hours From 2023-11-25 21:09:06 to 2023-11-26 04:58:06: ~7.82 hours Total for server 4: ~20.52 hours For server ID 5: From 2023-11-16 19:42:22 to 2023-11-16 21:08:22: ~1.43 hours Total for server 5: ~1.43 hours The accumulated runtime for all servers totals approximately 44.46 hours, equivalent to one full day plus some additional hours. However, since we consider only full days, the final output is rounded to 1 full day. Solutions Solution 1: Using Window Functions We can use the window function LEAD to get the time of the next status for each server. The time difference between two statuses is the running time of the server. Finally, we add up the running time of all servers, then divide..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2024-05-16T00:00:00-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2024-05-16-3126-Server-Utilization-Time/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-3126.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="3126 - Server Utilization Time" property="twitter:title"/>
   <meta content="Leetcode 3126. Server Utilization Time ð Description Table: Servers +----------------+----------+ \| Column Name \| Type \| +----------------+----------+ \| server_id \| int \| \| status_time \| datetime \| \| session_status \| enum \| +----------------+----------+ (server_id, status_time, session_status) is the primary key (combination of columns with unique values) for this table. session_status is an ENUM (category) type of (&amp;#39;start&amp;#39;, &amp;#39;stop&amp;#39;). Each row of this table contains server_id, status_time, and session_status. Write a solution to find the total time when servers were running. The output should be rounded down to the nearest number of&amp;nbsp;full days. Return the result table in any&amp;nbsp;order. The result format is in the following example. &amp;nbsp; Example: Input: Servers table: +-----------+---------------------+----------------+ \| server_id \| status_time \| session_status \| +-----------+---------------------+----------------+ \| 3 \| 2023-11-04 16:29:47 \| start \| \| 3 \| 2023-11-05 01:49:47 \| stop \| \| 3 \| 2023-11-25 01:37:08 \| start \| \| 3 \| 2023-11-25 03:50:08 \| stop \| \| 1 \| 2023-11-13 03:05:31 \| start \| \| 1 \| 2023-11-13 11:10:31 \| stop \| \| 4 \| 2023-11-29 15:11:17 \| start \| \| 4 \| 2023-11-29 15:42:17 \| stop \| \| 4 \| 2023-11-20 00:31:44 \| start \| \| 4 \| 2023-11-20 07:03:44 \| stop \| \| 1 \| 2023-11-20 00:27:11 \| start \| \| 1 \| 2023-11-20 01:41:11 \| stop \| \| 3 \| 2023-11-04 23:16:48 \| start \| \| 3 \| 2023-11-05 01:15:48 \| stop \| \| 4 \| 2023-11-30 15:09:18 \| start \| \| 4 \| 2023-11-30 20:48:18 \| stop \| \| 4 \| 2023-11-25 21:09:06 \| start \| \| 4 \| 2023-11-26 04:58:06 \| stop \| \| 5 \| 2023-11-16 19:42:22 \| start \| \| 5 \| 2023-11-16 21:08:22 \| stop \| +-----------+---------------------+----------------+ Output: +-------------------+ \| total_uptime_days \| +-------------------+ \| 1 \| +-------------------+ Explanation: For server ID 3: From 2023-11-04 16:29:47 to 2023-11-05 01:49:47: ~9.3 hours From 2023-11-25 01:37:08 to 2023-11-25 03:50:08: ~2.2 hours From 2023-11-04 23:16:48 to 2023-11-05 01:15:48: ~1.98 hours Total for server 3: ~13.48 hours For server ID 1: From 2023-11-13 03:05:31 to 2023-11-13 11:10:31: ~8 hours From 2023-11-20 00:27:11 to 2023-11-20 01:41:11: ~1.23 hours Total for server 1: ~9.23 hours For server ID 4: From 2023-11-29 15:11:17 to 2023-11-29 15:42:17: ~0.52 hours From 2023-11-20 00:31:44 to 2023-11-20 07:03:44: ~6.53 hours From 2023-11-30 15:09:18 to 2023-11-30 20:48:18: ~5.65 hours From 2023-11-25 21:09:06 to 2023-11-26 04:58:06: ~7.82 hours Total for server 4: ~20.52 hours For server ID 5: From 2023-11-16 19:42:22 to 2023-11-16 21:08:22: ~1.43 hours Total for server 5: ~1.43 hours The accumulated runtime for all servers totals approximately 44.46 hours, equivalent to one full day plus some additional hours. However, since we consider only full days, the final output is rounded to 1 full day. Solutions Solution 1: Using Window Functions We can use the window function LEAD to get the time of the next status for each server. The time difference between two statuses is the running time of the server. Finally, we add up the running time of all servers, then divide..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    3126 - Server Utilization Time | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="3126 - Server Utilization Time" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-3126.html" rel="canonical">
          <meta content="https://leetcode.ca/2024-05-16-3126-Server-Utilization-Time/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2024-05-16T00:00:00-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"3126 - Server Utilization Time","dateModified":"2024-05-16T00:00:00-07:00","datePublished":"2024-05-16T00:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2024-05-16-3126-Server-Utilization-Time/"},"url":"https://leetcode.ca/2024-05-16-3126-Server-Utilization-Time/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="3126-server-utilization-time-">
       <a href="solution-3126.html">
        3126. Server Utilization Time ð
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       Table:
       <code>
        Servers
       </code>
      </p>
      <pre>
+----------------+----------+
\| Column Name    \| Type     \|
+----------------+----------+
\| server_id      \| int      \|
\| status_time    \| datetime \|
\| session_status \| enum     \|
+----------------+----------+
(server_id, status_time, session_status) is the primary key (combination of columns with unique values) for this table.
session_status is an ENUM (category) type of ('start', 'stop').
Each row of this table contains server_id, status_time, and session_status.
</pre>
      <p>
       Write a solution to find the
       <strong>
        total time
       </strong>
       when servers were
       <strong>
        running
       </strong>
       . The output should be rounded down to the nearest number of
       <strong>
        full days
       </strong>
       .
      </p>
      <p>
       Return
       <em>
        the result table in
        <strong>
         any
        </strong>
       </em>
       <em>
        order.
       </em>
      </p>
      <p>
       The result format is in the following example.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example:
       </strong>
      </p>
      <div class="example-block">
       <p>
        <strong>
         Input:
        </strong>
       </p>
       <p>
        Servers table:
       </p>
       <pre class="example-io">
+-----------+---------------------+----------------+
\| server_id \| status_time         \| session_status \|
+-----------+---------------------+----------------+
\| 3         \| 2023-11-04 16:29:47 \| start          \|
\| 3         \| 2023-11-05 01:49:47 \| stop           \|
\| 3         \| 2023-11-25 01:37:08 \| start          \|
\| 3         \| 2023-11-25 03:50:08 \| stop           \|
\| 1         \| 2023-11-13 03:05:31 \| start          \|
\| 1         \| 2023-11-13 11:10:31 \| stop           \|
\| 4         \| 2023-11-29 15:11:17 \| start          \|
\| 4         \| 2023-11-29 15:42:17 \| stop           \|
\| 4         \| 2023-11-20 00:31:44 \| start          \|
\| 4         \| 2023-11-20 07:03:44 \| stop           \|
\| 1         \| 2023-11-20 00:27:11 \| start          \|
\| 1         \| 2023-11-20 01:41:11 \| stop           \|
\| 3         \| 2023-11-04 23:16:48 \| start          \|
\| 3         \| 2023-11-05 01:15:48 \| stop           \|
\| 4         \| 2023-11-30 15:09:18 \| start          \|
\| 4         \| 2023-11-30 20:48:18 \| stop           \|
\| 4         \| 2023-11-25 21:09:06 \| start          \|
\| 4         \| 2023-11-26 04:58:06 \| stop           \|
\| 5         \| 2023-11-16 19:42:22 \| start          \|
\| 5         \| 2023-11-16 21:08:22 \| stop           \|
+-----------+---------------------+----------------+
</pre>
       <p>
        <strong>
         Output:
        </strong>
       </p>
       <pre class="example-io">
+-------------------+
\| total_uptime_days \|
+-------------------+
\| 1                 \|
+-------------------+
</pre>
       <p>
        <strong>
         Explanation:
        </strong>
       </p>
       <ul>
        <li>
         For server ID 3:
         <ul>
          <li>
           From 2023-11-04 16:29:47 to 2023-11-05 01:49:47: ~9.3 hours
          </li>
          <li>
           From 2023-11-25 01:37:08 to 2023-11-25 03:50:08: ~2.2 hours
          </li>
          <li>
           From 2023-11-04 23:16:48 to 2023-11-05 01:15:48: ~1.98 hours
          </li>
         </ul>
         Total for server 3: ~13.48 hours
        </li>
        <li>
         For server ID 1:
         <ul>
          <li>
           From 2023-11-13 03:05:31 to 2023-11-13 11:10:31: ~8 hours
          </li>
          <li>
           From 2023-11-20 00:27:11 to 2023-11-20 01:41:11: ~1.23 hours
          </li>
         </ul>
         Total for server 1: ~9.23 hours
        </li>
        <li>
         For server ID 4:
         <ul>
          <li>
           From 2023-11-29 15:11:17 to 2023-11-29 15:42:17: ~0.52 hours
          </li>
          <li>
           From 2023-11-20 00:31:44 to 2023-11-20 07:03:44: ~6.53 hours
          </li>
          <li>
           From 2023-11-30 15:09:18 to 2023-11-30 20:48:18: ~5.65 hours
          </li>
          <li>
           From 2023-11-25 21:09:06 to 2023-11-26 04:58:06: ~7.82 hours
          </li>
         </ul>
         Total for server 4: ~20.52 hours
        </li>
        <li>
         For server ID 5:
         <ul>
          <li>
           From 2023-11-16 19:42:22 to 2023-11-16 21:08:22: ~1.43 hours
          </li>
         </ul>
         Total for server 5: ~1.43 hours
        </li>
       </ul>
       The accumulated runtime for all servers totals approximately 44.46 hours, equivalent to one full day plus some additional hours. However, since we consider only full days, the final output is rounded to 1 full day.
      </div>
      <h2 id="solutions">
       Solutions
      </h2>
      <h3 id="solution-1-using-window-functions">
       Solution 1: Using Window Functions
      </h3>
      <p>
       We can use the window function
       <code class="language-plaintext highlighter-rouge">
        LEAD
       </code>
       to get the time of the next status for each server. The time difference between two statuses is the running time of the server. Finally, we add up the running time of all servers, then divide by the number of seconds in a day to get the total running days of the servers.
      </p>
      <ul class="uk-tab" data-uk-switcher="{connect:'#bdd3ce63-1a80-48d6-85ad-a8e1276e3fc1'}">
       <li class="uk-active">
        <a href="solution-3126.html">
         SQL
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="bdd3ce63-1a80-48d6-85ad-a8e1276e3fc1">
       <li>
        <div class="language-sql highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">WITH</span>
    <span class="n">T</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span>
            <span class="n">session_status</span><span class="p">,</span>
            <span class="n">status_time</span><span class="p">,</span>
            <span class="n">LEAD</span><span class="p">(</span><span class="n">status_time</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span>
                <span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">server_id</span>
                <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">status_time</span>
            <span class="p">)</span> <span class="k">AS</span> <span class="n">next_status_time</span>
        <span class="k">FROM</span> <span class="n">Servers</span>
    <span class="p">)</span>
<span class="k">SELECT</span> <span class="n">FLOOR</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">TIMESTAMPDIFF</span><span class="p">(</span><span class="k">SECOND</span><span class="p">,</span> <span class="n">status_time</span><span class="p">,</span> <span class="n">next_status_time</span><span class="p">))</span> <span class="o">/</span> <span class="mi">86400</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_uptime_days</span>
<span class="k">FROM</span> <span class="n">T</span>
<span class="k">WHERE</span> <span class="n">session_status</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">;</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-3126.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
