<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-1204.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-1204.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>1204 - Last Person to Fit in the Elevator</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode Formatted question description: https://leetcode.ca/all/1204.html 1204. Last Person to Fit in the Elevator Level Medium Description Table: Queue +-------------+---------+ | Column Name | Type | +-------------+---------+ | person_id | int | | person_name | varchar | | weight | int | | turn | int |...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-1204.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-1204.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-1204.html" rel="stylesheet"/>
   <link href="solution-1204.html" rel="stylesheet"/>
   <link href="solution-1204.html" rel="stylesheet"/>
   <link href="solution-1204.html" rel="stylesheet"/>
   <link href="solution-1204.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="1204 - Last Person to Fit in the Elevator" property="og:title"/>
   <meta content="Leetcode




Formatted question description: https://leetcode.ca/all/1204.html
1204. Last Person to Fit in the Elevator
Level
Medium

Description
Table: Queue
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| person_id   | int     |
| person_name | varchar |
| weight      | int     |
| turn        | int     |
+-------------+---------+
person_id is the primary key column for this table.
This table has the information about all people waiting for an elevator.
The person_id and turn columns will contain all numbers from 1 to n, where n is the number of rows in the table.


The maximum weight the elevator can hold is 1000.

Write an SQL query to find the person_name of the last person who will fit in the elevator without exceeding the weight limit. It is guaranteed that the person who is first in the queue can fit in the elevator.

The query result format is in the following example:
Queue table
+-----------+-------------------+--------+------+
| person_id | person_name       | weight | turn |
+-----------+-------------------+--------+------+
| 5         | George Washington | 250    | 1    |
| 3         | John Adams        | 350    | 2    |
| 6         | Thomas Jefferson  | 400    | 3    |
| 2         | Will Johnliams    | 200    | 4    |
| 4         | Thomas Jefferson  | 175    | 5    |
| 1         | James Elephant    | 500    | 6    |
+-----------+-------------------+--------+------+

Result table
+-------------------+
| person_name       |
+-------------------+
| Thomas Jefferson  |
+-------------------+

Queue table is ordered by turn in the example for simplicity.
In the example George Washington(id 5), John Adams(id 3) and Thomas Jefferson(id 6) will enter the elevator as their weight sum is 250 + 350 + 400 = 1000.
Thomas Jefferson(id 6) is the last person to fit in the elevator because he has the last turn in these three people.


Solution
The object is to find the person with the maximum turn such that all the entries with turn less than or equal to this personâs turn have sum weight less than or equal to 1000. Suppose last_person is an entry of Queue such that all the entries before last_person and the entry last_person have sum weight less than or equal to 1000. Since the person with the maximum turn needs to be found, use order by turn desc limit 1 to find such an entry.
# Write your MySQL query statement below

select person_name from Queue last_person
    where (select sum(weight) from Queue where turn &amp;lt;= last_person.turn) &amp;lt;= 1000
    order by turn desc limit 1;


All Problems

All Solutions" property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2019-03-18T22:21:01-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2019-03-18-1204-Last-Person-to-Fit-in-the-Elevator/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-1204.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="1204 - Last Person to Fit in the Elevator" property="twitter:title"/>
   <meta content="Leetcode




Formatted question description: https://leetcode.ca/all/1204.html
1204. Last Person to Fit in the Elevator
Level
Medium

Description
Table: Queue
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| person_id   | int     |
| person_name | varchar |
| weight      | int     |
| turn        | int     |
+-------------+---------+
person_id is the primary key column for this table.
This table has the information about all people waiting for an elevator.
The person_id and turn columns will contain all numbers from 1 to n, where n is the number of rows in the table.


The maximum weight the elevator can hold is 1000.

Write an SQL query to find the person_name of the last person who will fit in the elevator without exceeding the weight limit. It is guaranteed that the person who is first in the queue can fit in the elevator.

The query result format is in the following example:
Queue table
+-----------+-------------------+--------+------+
| person_id | person_name       | weight | turn |
+-----------+-------------------+--------+------+
| 5         | George Washington | 250    | 1    |
| 3         | John Adams        | 350    | 2    |
| 6         | Thomas Jefferson  | 400    | 3    |
| 2         | Will Johnliams    | 200    | 4    |
| 4         | Thomas Jefferson  | 175    | 5    |
| 1         | James Elephant    | 500    | 6    |
+-----------+-------------------+--------+------+

Result table
+-------------------+
| person_name       |
+-------------------+
| Thomas Jefferson  |
+-------------------+

Queue table is ordered by turn in the example for simplicity.
In the example George Washington(id 5), John Adams(id 3) and Thomas Jefferson(id 6) will enter the elevator as their weight sum is 250 + 350 + 400 = 1000.
Thomas Jefferson(id 6) is the last person to fit in the elevator because he has the last turn in these three people.


Solution
The object is to find the person with the maximum turn such that all the entries with turn less than or equal to this personâs turn have sum weight less than or equal to 1000. Suppose last_person is an entry of Queue such that all the entries before last_person and the entry last_person have sum weight less than or equal to 1000. Since the person with the maximum turn needs to be found, use order by turn desc limit 1 to find such an entry.
# Write your MySQL query statement below

select person_name from Queue last_person
    where (select sum(weight) from Queue where turn &amp;lt;= last_person.turn) &amp;lt;= 1000
    order by turn desc limit 1;


All Problems

All Solutions" property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    1204 - Last Person to Fit in the Elevator | Leetcode
   </title>
   <meta content="Jekyll v3.9.4" name="generator">
    <meta content="1204 - Last Person to Fit in the Elevator" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-1204.html" rel="canonical">
          <meta content="https://leetcode.ca/2019-03-18-1204-Last-Person-to-Fit-in-the-Elevator/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2019-03-18T22:21:01-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"headline":"1204 - Last Person to Fit in the Elevator","dateModified":"2019-03-18T22:21:01-07:00","datePublished":"2019-03-18T22:21:01-07:00","description":"Leetcode","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2019-03-18-1204-Last-Person-to-Fit-in-the-Elevator/"},"url":"https://leetcode.ca/2019-03-18-1204-Last-Person-to-Fit-in-the-Elevator/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCDRuzBvLGzyVvgPyohrahrA" data-count="hidden" data-layout="full">
      </div>
      <p>
       Formatted question description:
       <a href="solution-1204.html">
        https://leetcode.ca/all/1204.html
       </a>
      </p>
      <h1 id="1204-last-person-to-fit-in-the-elevator">
       1204. Last Person to Fit in the Elevator
      </h1>
      <h2 id="level">
       Level
      </h2>
      <p>
       Medium
      </p>
      <h2 id="description">
       Description
      </h2>
      <p>
       Table:
       <code class="language-plaintext highlighter-rouge">
        Queue
       </code>
      </p>
      <div class="language-plaintext highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| person_id   | int     |
| person_name | varchar |
| weight      | int     |
| turn        | int     |
+-------------+---------+
person_id is the primary key column for this table.
This table has the information about all people waiting for an elevator.
The person_id and turn columns will contain all numbers from 1 to n, where n is the number of rows in the table.
</code></pre>
       </div>
      </div>
      <p>
       The maximum weight the elevator can hold is
       <strong>
        1000
       </strong>
       .
      </p>
      <p>
       Write an SQL query to find the
       <code class="language-plaintext highlighter-rouge">
        person_name
       </code>
       of the last person who will fit in the elevator without exceeding the weight limit. It is guaranteed that the person who is first in the queue can fit in the elevator.
      </p>
      <p>
       The query result format is in the following example:
      </p>
      <div class="language-plaintext highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code>Queue table
+-----------+-------------------+--------+------+
| person_id | person_name       | weight | turn |
+-----------+-------------------+--------+------+
| 5         | George Washington | 250    | 1    |
| 3         | John Adams        | 350    | 2    |
| 6         | Thomas Jefferson  | 400    | 3    |
| 2         | Will Johnliams    | 200    | 4    |
| 4         | Thomas Jefferson  | 175    | 5    |
| 1         | James Elephant    | 500    | 6    |
+-----------+-------------------+--------+------+

Result table
+-------------------+
| person_name       |
+-------------------+
| Thomas Jefferson  |
+-------------------+

Queue table is ordered by turn in the example for simplicity.
In the example George Washington(id 5), John Adams(id 3) and Thomas Jefferson(id 6) will enter the elevator as their weight sum is 250 + 350 + 400 = 1000.
Thomas Jefferson(id 6) is the last person to fit in the elevator because he has the last turn in these three people.
</code></pre>
       </div>
      </div>
      <h2 id="solution">
       Solution
      </h2>
      <p>
       The object is to find the person with the maximum
       <code class="language-plaintext highlighter-rouge">
        turn
       </code>
       such that all the entries with
       <code class="language-plaintext highlighter-rouge">
        turn
       </code>
       less than or equal to this personâs
       <code class="language-plaintext highlighter-rouge">
        turn
       </code>
       have sum
       <code class="language-plaintext highlighter-rouge">
        weight
       </code>
       less than or equal to 1000. Suppose
       <code class="language-plaintext highlighter-rouge">
        last_person
       </code>
       is an entry of
       <code class="language-plaintext highlighter-rouge">
        Queue
       </code>
       such that all the entries before
       <code class="language-plaintext highlighter-rouge">
        last_person
       </code>
       and the entry
       <code class="language-plaintext highlighter-rouge">
        last_person
       </code>
       have sum
       <code class="language-plaintext highlighter-rouge">
        weight
       </code>
       less than or equal to 1000. Since the person with the maximum
       <code class="language-plaintext highlighter-rouge">
        turn
       </code>
       needs to be found, use
       <code class="language-plaintext highlighter-rouge">
        order by turn desc limit 1
       </code>
       to find such an entry.
      </p>
      <div class="language-sql highlighter-rouge">
       <div class="highlight">
        <pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>

<span class="k">select</span> <span class="n">person_name</span> <span class="k">from</span> <span class="n">Queue</span> <span class="n">last_person</span>
    <span class="k">where</span> <span class="p">(</span><span class="k">select</span> <span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span> <span class="k">from</span> <span class="n">Queue</span> <span class="k">where</span> <span class="n">turn</span> <span class="o">&lt;=</span> <span class="n">last_person</span><span class="p">.</span><span class="n">turn</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1000</span>
    <span class="k">order</span> <span class="k">by</span> <span class="n">turn</span> <span class="k">desc</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">;</span>
</code></pre>
       </div>
      </div>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-1204.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
