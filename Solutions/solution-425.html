<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-425.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-425.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>425 - Word Squares</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 425. Word Squares Description Given an array of unique strings words, return all the word squares you can build from words. The same word from words can be used multiple times. You can return the answer in any order. A sequence of strings forms a...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-425.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-425.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-425.html" rel="stylesheet"/>
   <link href="solution-425.html" rel="stylesheet"/>
   <link href="solution-425.html" rel="stylesheet"/>
   <link href="solution-425.html" rel="stylesheet"/>
   <link href="solution-425.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="425 - Word Squares" property="og:title"/>
   <meta content="Leetcode 425. Word Squares Description Given an array of unique strings words, return all the word squares you can build from words. The same word from words can be used multiple times. You can return the answer in any order. A sequence of strings forms a valid word square if the kth row and column read the same string, where 0 &amp;lt;= k &amp;lt; max(numRows, numColumns). For example, the word sequence [&amp;quot;ball&amp;quot;,&amp;quot;area&amp;quot;,&amp;quot;lead&amp;quot;,&amp;quot;lady&amp;quot;] forms a word square because each word reads the same both horizontally and vertically. &amp;nbsp; Example 1: Input: words = [&amp;quot;area&amp;quot;,&amp;quot;lead&amp;quot;,&amp;quot;wall&amp;quot;,&amp;quot;lady&amp;quot;,&amp;quot;ball&amp;quot;] Output: [[&amp;quot;ball&amp;quot;,&amp;quot;area&amp;quot;,&amp;quot;lead&amp;quot;,&amp;quot;lady&amp;quot;],[&amp;quot;wall&amp;quot;,&amp;quot;area&amp;quot;,&amp;quot;lead&amp;quot;,&amp;quot;lady&amp;quot;]] Explanation: The output consists of two word squares. The order of output does not matter (just the order of words in each word square matters). Example 2: Input: words = [&amp;quot;abat&amp;quot;,&amp;quot;baba&amp;quot;,&amp;quot;atan&amp;quot;,&amp;quot;atal&amp;quot;] Output: [[&amp;quot;baba&amp;quot;,&amp;quot;abat&amp;quot;,&amp;quot;baba&amp;quot;,&amp;quot;atal&amp;quot;],[&amp;quot;baba&amp;quot;,&amp;quot;abat&amp;quot;,&amp;quot;baba&amp;quot;,&amp;quot;atan&amp;quot;]] Explanation: The output consists of two word squares. The order of output does not matter (just the order of words in each word square matters). &amp;nbsp; Constraints: 1 &amp;lt;= words.length &amp;lt;= 1000 1 &amp;lt;= words[i].length &amp;lt;= 4 All words[i] have the same length. words[i] consists of only lowercase English letters. All words[i] are unique. Solutions Java Python Go class Trie { Trie[] children = new Trie[26]; List&amp;lt;Integer&amp;gt; v = new ArrayList&amp;lt;&amp;gt;(); void insert(String word, int i) { Trie node = this; for (char c : word.toCharArray()) { c -= 'a'; if (node.children[c] == null) { node.children[c] = new Trie(); } node = node.children[c]; node.v.add(i); } } List&amp;lt;Integer&amp;gt; search(String pref) { Trie node = this; for (char c : pref.toCharArray()) { c -= 'a'; if (node.children[c] == null) { return Collections.emptyList(); } node = node.children[c]; } return node.v; } } class Solution { private Trie trie = new Trie(); private String[] words; private List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt; ans = new ArrayList&amp;lt;&amp;gt;(); public List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt; wordSquares(String[] words) { this.words = words; for (int i = 0; i &amp;lt; words.length; ++i) { trie.insert(words[i], i); } List&amp;lt;String&amp;gt; t = new ArrayList&amp;lt;&amp;gt;(); for (String w : words) { t.add(w); dfs(t); t.remove(t.size() - 1); } return ans; } private void dfs(List&amp;lt;String&amp;gt; t) { if (t.size() == words[0].length()) { ans.add(new ArrayList&amp;lt;&amp;gt;(t)); return; } int idx = t.size(); StringBuilder pref = new StringBuilder(); for (String x : t) { pref.append(x.charAt(idx)); } List&amp;lt;Integer&amp;gt; indexes = trie.search(pref.toString()); for (int i : indexes) { t.add(words[i]); dfs(t); t.remove(t.size() - 1); } } } class Trie: def __init__(self): self.children = [None] * 26 self.v = [] def insert(self, w, i): node = self for c in w: idx = ord(c) - ord('a') if node.children[idx] is None: node.children[idx] = Trie() node = node.children[idx] node.v.append(i) def search(self, w): node = self for c in w: idx = ord(c) - ord('a') if node.children[idx] is None: return [] node = node.children[idx] return node.v class Solution: def wordSquares(self, words: List[str]) -&amp;gt; List[List[str]]: def dfs(t): if len(t) == len(words[0]): ans.append(t[:]) return idx = len(t) pref = [v[idx] for v in t] indexes = trie.search(''.join(pref)) for i in indexes: t.append(words[i]) dfs(t) t.pop() trie = Trie() ans = [] for i, w in enumerate(words): trie.insert(w, i) for w in words: dfs([w]) return ans..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2017-01-28T00:00:00-08:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2017-01-28-425-Word-Squares/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-425.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="425 - Word Squares" property="twitter:title"/>
   <meta content="Leetcode 425. Word Squares Description Given an array of unique strings words, return all the word squares you can build from words. The same word from words can be used multiple times. You can return the answer in any order. A sequence of strings forms a valid word square if the kth row and column read the same string, where 0 &amp;lt;= k &amp;lt; max(numRows, numColumns). For example, the word sequence [&amp;quot;ball&amp;quot;,&amp;quot;area&amp;quot;,&amp;quot;lead&amp;quot;,&amp;quot;lady&amp;quot;] forms a word square because each word reads the same both horizontally and vertically. &amp;nbsp; Example 1: Input: words = [&amp;quot;area&amp;quot;,&amp;quot;lead&amp;quot;,&amp;quot;wall&amp;quot;,&amp;quot;lady&amp;quot;,&amp;quot;ball&amp;quot;] Output: [[&amp;quot;ball&amp;quot;,&amp;quot;area&amp;quot;,&amp;quot;lead&amp;quot;,&amp;quot;lady&amp;quot;],[&amp;quot;wall&amp;quot;,&amp;quot;area&amp;quot;,&amp;quot;lead&amp;quot;,&amp;quot;lady&amp;quot;]] Explanation: The output consists of two word squares. The order of output does not matter (just the order of words in each word square matters). Example 2: Input: words = [&amp;quot;abat&amp;quot;,&amp;quot;baba&amp;quot;,&amp;quot;atan&amp;quot;,&amp;quot;atal&amp;quot;] Output: [[&amp;quot;baba&amp;quot;,&amp;quot;abat&amp;quot;,&amp;quot;baba&amp;quot;,&amp;quot;atal&amp;quot;],[&amp;quot;baba&amp;quot;,&amp;quot;abat&amp;quot;,&amp;quot;baba&amp;quot;,&amp;quot;atan&amp;quot;]] Explanation: The output consists of two word squares. The order of output does not matter (just the order of words in each word square matters). &amp;nbsp; Constraints: 1 &amp;lt;= words.length &amp;lt;= 1000 1 &amp;lt;= words[i].length &amp;lt;= 4 All words[i] have the same length. words[i] consists of only lowercase English letters. All words[i] are unique. Solutions Java Python Go class Trie { Trie[] children = new Trie[26]; List&amp;lt;Integer&amp;gt; v = new ArrayList&amp;lt;&amp;gt;(); void insert(String word, int i) { Trie node = this; for (char c : word.toCharArray()) { c -= 'a'; if (node.children[c] == null) { node.children[c] = new Trie(); } node = node.children[c]; node.v.add(i); } } List&amp;lt;Integer&amp;gt; search(String pref) { Trie node = this; for (char c : pref.toCharArray()) { c -= 'a'; if (node.children[c] == null) { return Collections.emptyList(); } node = node.children[c]; } return node.v; } } class Solution { private Trie trie = new Trie(); private String[] words; private List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt; ans = new ArrayList&amp;lt;&amp;gt;(); public List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt; wordSquares(String[] words) { this.words = words; for (int i = 0; i &amp;lt; words.length; ++i) { trie.insert(words[i], i); } List&amp;lt;String&amp;gt; t = new ArrayList&amp;lt;&amp;gt;(); for (String w : words) { t.add(w); dfs(t); t.remove(t.size() - 1); } return ans; } private void dfs(List&amp;lt;String&amp;gt; t) { if (t.size() == words[0].length()) { ans.add(new ArrayList&amp;lt;&amp;gt;(t)); return; } int idx = t.size(); StringBuilder pref = new StringBuilder(); for (String x : t) { pref.append(x.charAt(idx)); } List&amp;lt;Integer&amp;gt; indexes = trie.search(pref.toString()); for (int i : indexes) { t.add(words[i]); dfs(t); t.remove(t.size() - 1); } } } class Trie: def __init__(self): self.children = [None] * 26 self.v = [] def insert(self, w, i): node = self for c in w: idx = ord(c) - ord('a') if node.children[idx] is None: node.children[idx] = Trie() node = node.children[idx] node.v.append(i) def search(self, w): node = self for c in w: idx = ord(c) - ord('a') if node.children[idx] is None: return [] node = node.children[idx] return node.v class Solution: def wordSquares(self, words: List[str]) -&amp;gt; List[List[str]]: def dfs(t): if len(t) == len(words[0]): ans.append(t[:]) return idx = len(t) pref = [v[idx] for v in t] indexes = trie.search(''.join(pref)) for i in indexes: t.append(words[i]) dfs(t) t.pop() trie = Trie() ans = [] for i, w in enumerate(words): trie.insert(w, i) for w in words: dfs([w]) return ans..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    425 - Word Squares | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="425 - Word Squares" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-425.html" rel="canonical">
          <meta content="https://leetcode.ca/2017-01-28-425-Word-Squares/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2017-01-28T00:00:00-08:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"425 - Word Squares","dateModified":"2017-01-28T00:00:00-08:00","datePublished":"2017-01-28T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2017-01-28-425-Word-Squares/"},"url":"https://leetcode.ca/2017-01-28-425-Word-Squares/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="425-word-squares">
       <a href="solution-425.html">
        425. Word Squares
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       Given an array of
       <strong>
        unique
       </strong>
       strings
       <code>
        words
       </code>
       , return
       <em>
        all the
       </em>
       <strong>
        <a href="solution-425.html" target="_blank">
         word squares
        </a>
       </strong>
       <em>
        you can build from
       </em>
       <code>
        words
       </code>
       . The same word from
       <code>
        words
       </code>
       can be used
       <strong>
        multiple times
       </strong>
       . You can return the answer in
       <strong>
        any order
       </strong>
       .
      </p>
      <p>
       A sequence of strings forms a valid
       <strong>
        word square
       </strong>
       if the
       <code>
        k
        <sup>
         th
        </sup>
       </code>
       row and column read the same string, where
       <code>
        0 &lt;= k &lt; max(numRows, numColumns)
       </code>
       .
      </p>
      <ul>
       <li>
        For example, the word sequence
        <code>
         ["ball","area","lead","lady"]
        </code>
        forms a word square because each word reads the same both horizontally and vertically.
       </li>
      </ul>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> words = ["area","lead","wall","lady","ball"]
<strong>Output:</strong> [["ball","area","lead","lady"],["wall","area","lead","lady"]]
<strong>Explanation:</strong>
The output consists of two word squares. The order of output does not matter (just the order of words in each word square matters).
</pre>
      <p>
       <strong class="example">
        Example 2:
       </strong>
      </p>
      <pre>
<strong>Input:</strong> words = ["abat","baba","atan","atal"]
<strong>Output:</strong> [["baba","abat","baba","atal"],["baba","abat","baba","atan"]]
<strong>Explanation:</strong>
The output consists of two word squares. The order of output does not matter (just the order of words in each word square matters).
</pre>
      <p>
      </p>
      <p>
       <strong>
        Constraints:
       </strong>
      </p>
      <ul>
       <li>
        <code>
         1 &lt;= words.length &lt;= 1000
        </code>
       </li>
       <li>
        <code>
         1 &lt;= words[i].length &lt;= 4
        </code>
       </li>
       <li>
        All
        <code>
         words[i]
        </code>
        have the same length.
       </li>
       <li>
        <code>
         words[i]
        </code>
        consists of only lowercase English letters.
       </li>
       <li>
        All
        <code>
         words[i]
        </code>
        are
        <strong>
         unique
        </strong>
        .
       </li>
      </ul>
      <h2 id="solutions">
       Solutions
      </h2>
      <ul class="uk-tab" data-uk-switcher="{connect:'#94214de9-7b0c-4f8d-97df-b9e34c87b35d'}">
       <li class="uk-active">
        <a href="solution-425.html">
         Java
        </a>
       </li>
       <li>
        <a href="solution-425.html">
         Python
        </a>
       </li>
       <li>
        <a href="solution-425.html">
         Go
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="94214de9-7b0c-4f8d-97df-b9e34c87b35d">
       <li>
        <div class="language-java highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="kd">class</span> <span class="nc">Trie</span> <span class="o">{</span>
    <span class="nc">Trie</span><span class="o">[]</span> <span class="n">children</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Trie</span><span class="o">[</span><span class="mi">26</span><span class="o">];</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kt">void</span> <span class="nf">insert</span><span class="o">(</span><span class="nc">String</span> <span class="n">word</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Trie</span> <span class="n">node</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span> <span class="o">:</span> <span class="n">word</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">c</span> <span class="o">-=</span> <span class="sc">'a'</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">c</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">node</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">c</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Trie</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">c</span><span class="o">];</span>
            <span class="n">node</span><span class="o">.</span><span class="na">v</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="nc">String</span> <span class="n">pref</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Trie</span> <span class="n">node</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span> <span class="o">:</span> <span class="n">pref</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">c</span> <span class="o">-=</span> <span class="sc">'a'</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">c</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">c</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="na">v</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Trie</span> <span class="n">trie</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Trie</span><span class="o">();</span>
    <span class="kd">private</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">words</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">ans</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="nf">wordSquares</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">words</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">words</span> <span class="o">=</span> <span class="n">words</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">words</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">trie</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">words</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">w</span> <span class="o">:</span> <span class="n">words</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">t</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">w</span><span class="o">);</span>
            <span class="n">dfs</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
            <span class="n">t</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">dfs</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="n">words</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">length</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">ans</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">t</span><span class="o">));</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
        <span class="nc">StringBuilder</span> <span class="n">pref</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">x</span> <span class="o">:</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">pref</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">idx</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">trie</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">pref</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">:</span> <span class="n">indexes</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">t</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">words</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
            <span class="n">dfs</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
            <span class="n">t</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-py highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">class</span> <span class="nc">Trie</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">26</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">w</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">Trie</span><span class="p">()</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">node</span><span class="p">.</span><span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">w</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">node</span><span class="p">.</span><span class="n">v</span>


<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">wordSquares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">ans</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[:])</span>
                <span class="k">return</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">pref</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
            <span class="n">indexes</span> <span class="o">=</span> <span class="n">trie</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">pref</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
                <span class="n">t</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="n">t</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="n">trie</span> <span class="o">=</span> <span class="n">Trie</span><span class="p">()</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
            <span class="n">trie</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="n">dfs</span><span class="p">([</span><span class="n">w</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ans</span>

</code></pre>
         </div>
        </div>
       </li>
       <li>
        <div class="language-go highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="k">type</span> <span class="n">Trie</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">children</span> <span class="p">[</span><span class="m">26</span><span class="p">]</span><span class="o">*</span><span class="n">Trie</span>
	<span class="n">v</span>        <span class="p">[]</span><span class="kt">int</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">newTrie</span><span class="p">()</span> <span class="o">*</span><span class="n">Trie</span> <span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">Trie</span><span class="p">{}</span>
<span class="p">}</span>
<span class="k">func</span> <span class="p">(</span><span class="n">this</span> <span class="o">*</span><span class="n">Trie</span><span class="p">)</span> <span class="n">insert</span><span class="p">(</span><span class="n">word</span> <span class="kt">string</span><span class="p">,</span> <span class="n">i</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">node</span> <span class="o">:=</span> <span class="n">this</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">word</span> <span class="p">{</span>
		<span class="n">c</span> <span class="o">-=</span> <span class="sc">'a'</span>
		<span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="no">nil</span> <span class="p">{</span>
			<span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">newTrie</span><span class="p">()</span>
		<span class="p">}</span>
		<span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
		<span class="n">node</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="k">func</span> <span class="p">(</span><span class="n">this</span> <span class="o">*</span><span class="n">Trie</span><span class="p">)</span> <span class="n">search</span><span class="p">(</span><span class="n">word</span> <span class="kt">string</span><span class="p">)</span> <span class="p">[]</span><span class="kt">int</span> <span class="p">{</span>
	<span class="n">node</span> <span class="o">:=</span> <span class="n">this</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">word</span> <span class="p">{</span>
		<span class="n">c</span> <span class="o">-=</span> <span class="sc">'a'</span>
		<span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="no">nil</span> <span class="p">{</span>
			<span class="k">return</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{}</span>
		<span class="p">}</span>
		<span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">v</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">wordSquares</span><span class="p">(</span><span class="n">words</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="p">[][]</span><span class="kt">string</span> <span class="p">{</span>
	<span class="n">trie</span> <span class="o">:=</span> <span class="n">newTrie</span><span class="p">()</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">w</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">words</span> <span class="p">{</span>
		<span class="n">trie</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="n">ans</span> <span class="o">:=</span> <span class="p">[][]</span><span class="kt">string</span><span class="p">{}</span>
	<span class="k">var</span> <span class="n">dfs</span> <span class="k">func</span><span class="p">([]</span><span class="kt">string</span><span class="p">)</span>
	<span class="n">dfs</span> <span class="o">=</span> <span class="k">func</span><span class="p">(</span><span class="n">t</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="m">0</span><span class="p">])</span> <span class="p">{</span>
			<span class="n">cp</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">string</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
			<span class="nb">copy</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
			<span class="n">ans</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="p">}</span>
		<span class="n">idx</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
		<span class="n">pref</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">{}</span>
		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">t</span> <span class="p">{</span>
			<span class="n">pref</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">pref</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
		<span class="p">}</span>
		<span class="n">indexes</span> <span class="o">:=</span> <span class="n">trie</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="kt">string</span><span class="p">(</span><span class="n">pref</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">indexes</span> <span class="p">{</span>
			<span class="n">t</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			<span class="n">dfs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
			<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="o">:</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="m">1</span><span class="p">]</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">w</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">words</span> <span class="p">{</span>
		<span class="n">dfs</span><span class="p">([]</span><span class="kt">string</span><span class="p">{</span><span class="n">w</span><span class="p">})</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ans</span>
<span class="p">}</span>
</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-425.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
