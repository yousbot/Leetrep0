<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <link href="solution-2010.html" rel="shortcut icon" type="image/png"/>
  <link href="solution-2010.html" rel="stylesheet">
   <script src="assets_js_uikit.min.js" type="text/javascript">
   </script>
   <script src="assets_js_uikit-icons.min.js" type="text/javascript">
   </script>
   <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: {'[+]': ['ams']}  // Include the 'ams' package
      },
      svg: {
        fontCache: 'global'
      }
    };
   </script>
   <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
   </script>
   <!-- below block is overlapping with SEO plugin generated title and description   -->
   <!-- 
  <title>2010 - The Number of Seniors and Juniors to Join the Company II</title>

  
  <meta name="author" content="Leetcode">
  

  
  <meta name="description" content="Leetcode 2010. The Number of Seniors and Juniors to Join the Company II Description Table: Candidates +-------------+------+ | Column Name | Type | +-------------+------+ | employee_id | int | | experience | enum | | salary | int | +-------------+------+ employee_id is the column with unique...">
   -->
   <meta content="LeetCode, Solution, Company Tag, Unlock Prime, Java, C++, Interview, Job, Algorithm, SQL, Canada" name="keywords"/>
   <link href="solution-2010.html" rel="alternate" title="Leetcode" type="application/rss+xml"/>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K108N8L891">
   </script>
   <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K108N8L891');
   </script>
   <!-- End Google Analytics -->
   <script async="" data-ad-client="ca-pub-6766885420008650" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
   </script>
   <link crossorigin="anonymous" href="solution-2010.html" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" rel="stylesheet"/>
   <link href="solution-2010.html" rel="stylesheet"/>
   <link href="solution-2010.html" rel="stylesheet"/>
   <link href="solution-2010.html" rel="stylesheet"/>
   <link href="solution-2010.html" rel="stylesheet"/>
   <link href="solution-2010.html" rel="stylesheet"/>
   <meta content="Leetcode" property="og:site_name"/>
   <meta content="2010 - The Number of Seniors and Juniors to Join the Company II" property="og:title"/>
   <meta content="Leetcode 2010. The Number of Seniors and Juniors to Join the Company II Description Table: Candidates +-------------+------+ | Column Name | Type | +-------------+------+ | employee_id | int | | experience | enum | | salary | int | +-------------+------+ employee_id is the column with unique values for this table. experience is an ENUM (category) of types (&amp;#39;Senior&amp;#39;, &amp;#39;Junior&amp;#39;). Each row of this table indicates the id of a candidate, their monthly salary, and their experience. The salary of each candidate is guaranteed to be unique. &amp;nbsp; A company wants to hire new employees. The budget of the company for the salaries is 70000. The company&amp;#39;s criteria for hiring are: Keep hiring the senior with the smallest salary until you cannot hire any more seniors. Use the remaining budget to hire the junior with the smallest salary. Keep hiring the junior with the smallest salary until you cannot hire any more juniors. Write a solution to find the ids of seniors and juniors hired under the mentioned criteria. Return the result table in any order. The&amp;nbsp;result format is in the following example. &amp;nbsp; Example 1: Input: Candidates table: +-------------+------------+--------+ | employee_id | experience | salary | +-------------+------------+--------+ | 1 | Junior | 10000 | | 9 | Junior | 15000 | | 2 | Senior | 20000 | | 11 | Senior | 16000 | | 13 | Senior | 50000 | | 4 | Junior | 40000 | +-------------+------------+--------+ Output: +-------------+ | employee_id | +-------------+ | 11 | | 2 | | 1 | | 9 | +-------------+ Explanation: We can hire 2 seniors with IDs (11, 2). Since the budget is $70000 and the sum of their salaries is $36000, we still have $34000 but they are not enough to hire the senior candidate with ID 13. We can hire 2 juniors with IDs (1, 9). Since the remaining budget is $34000 and the sum of their salaries is $25000, we still have $9000 but they are not enough to hire the junior candidate with ID 4. Example 2: Input: Candidates table: +-------------+------------+--------+ | employee_id | experience | salary | +-------------+------------+--------+ | 1 | Junior | 25000 | | 9 | Junior | 10000 | | 2 | Senior | 85000 | | 11 | Senior | 80000 | | 13 | Senior | 90000 | | 4 | Junior | 30000 | +-------------+------------+--------+ Output: +-------------+ | employee_id | +-------------+ | 9 | | 1 | | 4 | +-------------+ Explanation: We cannot hire any seniors with the current budget as we need at least $80000 to hire one senior. We can hire all three juniors with the remaining budget. Solutions SQL # Write your MySQL query statement below WITH s AS ( SELECT employee_id, SUM(salary) OVER (ORDER BY salary) AS cur FROM Candidates WHERE experience = 'Senior' ), j AS ( SELECT employee_id, IFNULL( SELECT MAX(cur) FROM s WHERE cur &amp;lt;= 70000, 0 ) + SUM(salary) OVER (ORDER BY salary) AS cur FROM..." property="og:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" property="og:image"/>
   <!-- remove canonical below to use SEO plugin -->
   <meta content="article" property="og:type"/>
   <meta content="Leetcode" property="og:article:author"/>
   <meta content="2021-06-01T00:00:00-07:00" property="og:article:published_time"/>
   <meta content="https://leetcode.ca/2021-06-01-2010-The-Number-of-Seniors-and-Juniors-to-Join-the-Company-II/" property="og:url"/>
   <!-- <link rel="canonical" href="solution-2010.html"> -->
   <meta content="summary" name="twitter:card"/>
   <meta content="@" name="twitter:site"/>
   <meta content="@" name="twitter:creator"/>
   <meta content="2010 - The Number of Seniors and Juniors to Join the Company II" property="twitter:title"/>
   <meta content="Leetcode 2010. The Number of Seniors and Juniors to Join the Company II Description Table: Candidates +-------------+------+ | Column Name | Type | +-------------+------+ | employee_id | int | | experience | enum | | salary | int | +-------------+------+ employee_id is the column with unique values for this table. experience is an ENUM (category) of types (&amp;#39;Senior&amp;#39;, &amp;#39;Junior&amp;#39;). Each row of this table indicates the id of a candidate, their monthly salary, and their experience. The salary of each candidate is guaranteed to be unique. &amp;nbsp; A company wants to hire new employees. The budget of the company for the salaries is 70000. The company&amp;#39;s criteria for hiring are: Keep hiring the senior with the smallest salary until you cannot hire any more seniors. Use the remaining budget to hire the junior with the smallest salary. Keep hiring the junior with the smallest salary until you cannot hire any more juniors. Write a solution to find the ids of seniors and juniors hired under the mentioned criteria. Return the result table in any order. The&amp;nbsp;result format is in the following example. &amp;nbsp; Example 1: Input: Candidates table: +-------------+------------+--------+ | employee_id | experience | salary | +-------------+------------+--------+ | 1 | Junior | 10000 | | 9 | Junior | 15000 | | 2 | Senior | 20000 | | 11 | Senior | 16000 | | 13 | Senior | 50000 | | 4 | Junior | 40000 | +-------------+------------+--------+ Output: +-------------+ | employee_id | +-------------+ | 11 | | 2 | | 1 | | 9 | +-------------+ Explanation: We can hire 2 seniors with IDs (11, 2). Since the budget is $70000 and the sum of their salaries is $36000, we still have $34000 but they are not enough to hire the senior candidate with ID 13. We can hire 2 juniors with IDs (1, 9). Since the remaining budget is $34000 and the sum of their salaries is $25000, we still have $9000 but they are not enough to hire the junior candidate with ID 4. Example 2: Input: Candidates table: +-------------+------------+--------+ | employee_id | experience | salary | +-------------+------------+--------+ | 1 | Junior | 25000 | | 9 | Junior | 10000 | | 2 | Senior | 85000 | | 11 | Senior | 80000 | | 13 | Senior | 90000 | | 4 | Junior | 30000 | +-------------+------------+--------+ Output: +-------------+ | employee_id | +-------------+ | 9 | | 1 | | 4 | +-------------+ Explanation: We cannot hire any seniors with the current budget as we need at least $80000 to hire one senior. We can hire all three juniors with the remaining budget. Solutions SQL # Write your MySQL query statement below WITH s AS ( SELECT employee_id, SUM(salary) OVER (ORDER BY salary) AS cur FROM Candidates WHERE experience = 'Senior' ), j AS ( SELECT employee_id, IFNULL( SELECT MAX(cur) FROM s WHERE cur &amp;lt;= 70000, 0 ) + SUM(salary) OVER (ORDER BY salary) AS cur FROM..." property="twitter:description"/>
   <meta content="https://leetcode.ca/assets/img/avatar-icon.jpg" name="twitter:image"/>
   <!-- Begin Jekyll SEO tag v2.6.1 -->
   <title>
    2010 - The Number of Seniors and Juniors to Join the Company II | Leetcode
   </title>
   <meta content="Jekyll v3.10.0" name="generator">
    <meta content="2010 - The Number of Seniors and Juniors to Join the Company II" property="og:title">
     <meta content="Leetcode" name="author">
      <meta content="en_US" property="og:locale">
       <meta content="Leetcode" name="description">
        <meta content="Leetcode" property="og:description">
         <link href="solution-2010.html" rel="canonical">
          <meta content="https://leetcode.ca/2021-06-01-2010-The-Number-of-Seniors-and-Juniors-to-Join-the-Company-II/" property="og:url">
           <meta content="Leetcode" property="og:site_name">
            <meta content="article" property="og:type">
             <meta content="2021-06-01T00:00:00-07:00" property="article:published_time">
              <script type="application/ld+json">
               {"description":"Leetcode","headline":"2010 - The Number of Seniors and Juniors to Join the Company II","dateModified":"2021-06-01T00:00:00-07:00","datePublished":"2021-06-01T00:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leetcode.ca/2021-06-01-2010-The-Number-of-Seniors-and-Juniors-to-Join-the-Company-II/"},"url":"https://leetcode.ca/2021-06-01-2010-The-Number-of-Seniors-and-Juniors-to-Join-the-Company-II/","author":{"@type":"Person","name":"Leetcode"},"@type":"BlogPosting","@context":"https://schema.org"}
              </script>
              <!-- End Jekyll SEO tag -->
             </meta>
            </meta>
           </meta>
          </meta>
         </link>
        </meta>
       </meta>
      </meta>
     </meta>
    </meta>
   </meta>
  </link>
 </head>
 <body>
  
  <!-- TODO this file has become a mess, refactor it -->
  
  <div class="container-md">
   <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
     <article class="blog-post" role="main">
      
      <script src="https://apis.google.com/js/platform.js">
      </script>
      <div class="g-ytsubscribe" data-channelid="UCslk3mmaMJy1enit3L9vWig" data-count="hidden" data-layout="full">
      </div>
      <h1 id="2010-the-number-of-seniors-and-juniors-to-join-the-company-ii">
       <a href="solution-2010.html">
        2010. The Number of Seniors and Juniors to Join the Company II
       </a>
      </h1>
      <h2 id="description">
       Description
      </h2>
      <p>
       Table:
       <code>
        Candidates
       </code>
      </p>
      <pre>
+-------------+------+
| Column Name | Type |
+-------------+------+
| employee_id | int  |
| experience  | enum |
| salary      | int  |
+-------------+------+
employee_id is the column with unique values for this table.
experience is an ENUM (category) of types ('Senior', 'Junior').
Each row of this table indicates the id of a candidate, their monthly salary, and their experience.
The salary of each candidate is guaranteed to be <strong>unique</strong>.</pre>
      <p>
      </p>
      <p>
       A company wants to hire new employees. The budget of the company for the salaries is
       <code>
        70000
       </code>
       . The company's criteria for hiring are:
      </p>
      <ol>
       <li>
        Keep hiring the senior with the smallest salary until you cannot hire any more seniors.
       </li>
       <li>
        Use the remaining budget to hire the junior with the smallest salary.
       </li>
       <li>
        Keep hiring the junior with the smallest salary until you cannot hire any more juniors.
       </li>
      </ol>
      <p>
       Write a solution to find the ids of seniors and juniors hired under the mentioned criteria.
      </p>
      <p>
       Return the result table in
       <strong>
        any order
       </strong>
       .
      </p>
      <p>
       The result format is in the following example.
      </p>
      <p>
      </p>
      <p>
       <strong class="example">
        Example 1:
       </strong>
      </p>
      <pre>
<strong>Input:</strong>
Candidates table:
+-------------+------------+--------+
| employee_id | experience | salary |
+-------------+------------+--------+
| 1           | Junior     | 10000  |
| 9           | Junior     | 15000  |
| 2           | Senior     | 20000  |
| 11          | Senior     | 16000  |
| 13          | Senior     | 50000  |
| 4           | Junior     | 40000  |
+-------------+------------+--------+
<strong>Output:</strong> 
+-------------+
| employee_id |
+-------------+
| 11          |
| 2           |
| 1           |
| 9           |
+-------------+
<strong>Explanation:</strong> 
We can hire 2 seniors with IDs (11, 2). Since the budget is $70000 and the sum of their salaries is $36000, we still have $34000 but they are not enough to hire the senior candidate with ID 13.
We can hire 2 juniors with IDs (1, 9). Since the remaining budget is $34000 and the sum of their salaries is $25000, we still have $9000 but they are not enough to hire the junior candidate with ID 4.
</pre>
      <p>
       <strong class="example">
        Example 2:
       </strong>
      </p>
      <pre>
<strong>Input:</strong>
Candidates table:
+-------------+------------+--------+
| employee_id | experience | salary |
+-------------+------------+--------+
| 1           | Junior     | 25000  |
| 9           | Junior     | 10000  |
| 2           | Senior     | 85000  |
| 11          | Senior     | 80000  |
| 13          | Senior     | 90000  |
| 4           | Junior     | 30000  |
+-------------+------------+--------+
<strong>Output:</strong> 
+-------------+
| employee_id |
+-------------+
| 9           |
| 1           |
| 4           |
+-------------+
<strong>Explanation:</strong> 
We cannot hire any seniors with the current budget as we need at least $80000 to hire one senior.
We can hire all three juniors with the remaining budget.
</pre>
      <h2 id="solutions">
       Solutions
      </h2>
      <ul class="uk-tab" data-uk-switcher="{connect:'#7598dad5-1c1a-48be-b3b6-6bcec556fb34'}">
       <li class="uk-active">
        <a href="solution-2010.html">
         SQL
        </a>
       </li>
      </ul>
      <ul class="uk-switcher uk-margin" id="7598dad5-1c1a-48be-b3b6-6bcec556fb34">
       <li>
        <div class="language-sql highlighter-rouge">
         <div class="highlight">
          <pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">WITH</span>
    <span class="n">s</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span>
            <span class="n">employee_id</span><span class="p">,</span>
            <span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">salary</span><span class="p">)</span> <span class="k">AS</span> <span class="n">cur</span>
        <span class="k">FROM</span> <span class="n">Candidates</span>
        <span class="k">WHERE</span> <span class="n">experience</span> <span class="o">=</span> <span class="s1">'Senior'</span>
    <span class="p">),</span>
    <span class="n">j</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span>
            <span class="n">employee_id</span><span class="p">,</span>
            <span class="n">IFNULL</span><span class="p">(</span>
                <span class="k">SELECT</span>
                    <span class="k">MAX</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
                <span class="k">FROM</span> <span class="n">s</span>
                <span class="k">WHERE</span> <span class="n">cur</span> <span class="o">&lt;=</span> <span class="mi">70000</span><span class="p">,</span>
                <span class="mi">0</span>
            <span class="p">)</span> <span class="o">+</span> <span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">salary</span><span class="p">)</span> <span class="k">AS</span> <span class="n">cur</span>
        <span class="k">FROM</span> <span class="n">Candidates</span>
        <span class="k">WHERE</span> <span class="n">experience</span> <span class="o">=</span> <span class="s1">'Junior'</span>
    <span class="p">)</span>
<span class="k">SELECT</span>
    <span class="n">employee_id</span>
<span class="k">FROM</span> <span class="n">s</span>
<span class="k">WHERE</span> <span class="n">cur</span> <span class="o">&lt;=</span> <span class="mi">70000</span>
<span class="k">UNION</span>
<span class="k">SELECT</span>
    <span class="n">employee_id</span>
<span class="k">FROM</span> <span class="n">j</span>
<span class="k">WHERE</span> <span class="n">cur</span> <span class="o">&lt;=</span> <span class="mi">70000</span><span class="p">;</span>

</code></pre>
         </div>
        </div>
       </li>
      </ul>
      
     </article>
     
     
     <div class="disqus-comments">
      <div class="comments">
       <div id="disqus_thread">
       </div>
       <script type="text/javascript">
        var disqus_shortname = 'leetcodeca';
	  /* ensure that pages with query string get the same discussion */
	  var url_parts = window.location.href.split("?");
	  var disqus_url = url_parts[0];
	  (function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
       </script>
       <noscript>
        Please enable JavaScript to view the
        <a href="solution-2010.html">
         comments powered by Disqus.
        </a>
       </noscript>
      </div>
     </div>
    </div>
   </div>
  </div>
  
  <script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
  </script>
  <script crossorigin="anonymous" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js">
  </script>
  <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
  <script src="assets_js_beautifuljekyll.js">
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <script src="assets_js_anchor-js-config.js">
  </script>
 </body>
</html>
